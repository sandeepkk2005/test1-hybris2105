{"code":"import { __decorate, __metadata, __param } from \"tslib\";\r\nimport './LandingPageComponent.scss';\r\nimport { Location } from '@angular/common';\r\nimport { Component, Inject } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { IAlertService, ICatalogService, IStorageService, LINKED_DROPDOWN, NG_ROUTE_PREFIX, SeDowngradeComponent, SystemEventService, YJQUERY_TOKEN } from 'smarteditcommons';\r\nimport { SiteService } from '../../../services';\r\nimport { SITES_ID } from './types';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"LandingPageComponent\", {\r\n    selector: 'se-landing-page',\r\n    template: \"<div class=\\\"se-toolbar-group\\\"><se-toolbar cssClass=\\\"se-toolbar--shell\\\" imageRoot=\\\"imageRoot\\\" toolbarName=\\\"smartEditHeaderToolbar\\\"></se-toolbar></div><div class=\\\"se-landing-page\\\"><div class=\\\"se-landing-page-actions\\\"><div class=\\\"se-landing-page-container\\\"><h1 class=\\\"se-landing-page-title\\\">{{ 'se.landingpage.title' | translate }}</h1><div class=\\\"se-landing-page-site-selection\\\" *ngIf=\\\"model\\\"><se-generic-editor-dropdown [field]=\\\"field\\\" [qualifier]=\\\"qualifier\\\" [model]=\\\"model\\\" [id]=\\\"sitesId\\\"></se-generic-editor-dropdown></div><p class=\\\"se-landing-page-label\\\">{{ 'se.landingpage.label' | translate }}</p></div></div><p class=\\\"se-landing-page-container se-landing-page-sub-header\\\">Content Catalogs</p><div class=\\\"se-landing-page-container se-landing-page-catalogs\\\"><div class=\\\"se-landing-page-catalog\\\" *ngFor=\\\"let catalog of catalogs; let isLast = last\\\"><se-catalog-details [catalog]=\\\"catalog\\\" [siteId]=\\\"model.site\\\" [isCatalogForCurrentSite]=\\\"isLast\\\"></se-catalog-details></div></div><img src=\\\"static-resources/images/best-run-sap-logo.svg\\\" class=\\\"se-landing-page-footer-logo\\\"/></div>\"\r\n});\r\nvar /* @ngInject */ LandingPageComponent = /** @class */ (function () {\r\n    function /* @ngInject */ LandingPageComponent(siteService, catalogService, systemEventService, storageService, alertService, route, location, yjQuery) {\r\n        this.siteService = siteService;\r\n        this.catalogService = catalogService;\r\n        this.systemEventService = systemEventService;\r\n        this.storageService = storageService;\r\n        this.alertService = alertService;\r\n        this.route = route;\r\n        this.location = location;\r\n        this.yjQuery = yjQuery;\r\n        this.sitesId = SITES_ID;\r\n        this.qualifier = 'site';\r\n        this.catalogs = [];\r\n        this.SELECTED_SITE_COOKIE_NAME = 'seselectedsite';\r\n    }\r\n    /* @ngInject */ LandingPageComponent.prototype.ngOnInit = function () {\r\n        var _this = this;\r\n        this.route.paramMap.subscribe(function (params) {\r\n            _this.getCurrentSiteId(params.get('siteId')).then(function (siteId) {\r\n                _this.setModel(siteId);\r\n            });\r\n        });\r\n        this.siteService.getAccessibleSites().then(function (sites) {\r\n            _this.field = {\r\n                idAttribute: 'uid',\r\n                labelAttributes: ['name'],\r\n                editable: true,\r\n                paged: false,\r\n                options: sites\r\n            };\r\n        });\r\n        this.removeStorefrontCssClass();\r\n        this.unregisterSitesDropdownEventHandler = this.systemEventService.subscribe(this.sitesId + LINKED_DROPDOWN, this.selectedSiteDropdownEventHandler.bind(this));\r\n    };\r\n    /* @ngInject */ LandingPageComponent.prototype.ngOnDestroy = function () {\r\n        this.unregisterSitesDropdownEventHandler();\r\n    };\r\n    /* @ngInject */ LandingPageComponent.prototype.getCurrentSiteId = function (siteIdFromUrl) {\r\n        var _this = this;\r\n        return this.storageService\r\n            .getValueFromLocalStorage(this.SELECTED_SITE_COOKIE_NAME, false)\r\n            .then(function (siteIdFromCookie) {\r\n            return _this.siteService.getAccessibleSites().then(function (sites) {\r\n                var isSiteAvailableFromUrl = sites.some(function (site) { return site.uid === siteIdFromUrl; });\r\n                if (isSiteAvailableFromUrl) {\r\n                    _this.setSelectedSite(siteIdFromUrl);\r\n                    _this.updateRouteToRemoveSite();\r\n                    return siteIdFromUrl;\r\n                }\r\n                else {\r\n                    if (siteIdFromUrl) {\r\n                        _this.alertService.showInfo('se.landingpage.site.url.error');\r\n                        _this.updateRouteToRemoveSite();\r\n                    }\r\n                    var isSelectedSiteAvailableFromCookie = sites.some(function (site) { return site.uid === siteIdFromCookie; });\r\n                    if (!isSelectedSiteAvailableFromCookie) {\r\n                        var firstSiteId = sites.length > 0 ? sites[0].uid : null;\r\n                        return firstSiteId;\r\n                    }\r\n                    else {\r\n                        return siteIdFromCookie;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ LandingPageComponent.prototype.updateRouteToRemoveSite = function () {\r\n        this.location.replaceState(NG_ROUTE_PREFIX);\r\n    };\r\n    /* @ngInject */ LandingPageComponent.prototype.removeStorefrontCssClass = function () {\r\n        var bodyTag = this.yjQuery(document.querySelector('body'));\r\n        if (bodyTag.hasClass('is-storefront')) {\r\n            bodyTag.removeClass('is-storefront');\r\n        }\r\n    };\r\n    /* @ngInject */ LandingPageComponent.prototype.selectedSiteDropdownEventHandler = function (_eventId, data) {\r\n        if (data.optionObject) {\r\n            var siteId = data.optionObject.id;\r\n            this.setSelectedSite(siteId);\r\n            this.loadCatalogsBySite(siteId);\r\n            this.setModel(siteId);\r\n        }\r\n        else {\r\n            this.catalogs = [];\r\n        }\r\n    };\r\n    /* @ngInject */ LandingPageComponent.prototype.setSelectedSite = function (siteId) {\r\n        this.storageService.setValueInLocalStorage(this.SELECTED_SITE_COOKIE_NAME, siteId, false);\r\n    };\r\n    /* @ngInject */ LandingPageComponent.prototype.loadCatalogsBySite = function (siteId) {\r\n        var _this = this;\r\n        this.catalogService\r\n            .getContentCatalogsForSite(siteId)\r\n            .then(function (catalogs) { return (_this.catalogs = catalogs); });\r\n    };\r\n    /* @ngInject */ LandingPageComponent.prototype.setModel = function (siteId) {\r\n        var _a;\r\n        if (this.model) {\r\n            this.model[this.qualifier] = siteId;\r\n        }\r\n        else {\r\n            this.model = (_a = {},\r\n                _a[this.qualifier] = siteId,\r\n                _a);\r\n        }\r\n    };\r\n    /* @ngInject */ LandingPageComponent = __decorate([\r\n        SeDowngradeComponent(),\r\n        Component({\r\n            selector: 'se-landing-page',\r\n            template: \"<div class=\\\"se-toolbar-group\\\"><se-toolbar cssClass=\\\"se-toolbar--shell\\\" imageRoot=\\\"imageRoot\\\" toolbarName=\\\"smartEditHeaderToolbar\\\"></se-toolbar></div><div class=\\\"se-landing-page\\\"><div class=\\\"se-landing-page-actions\\\"><div class=\\\"se-landing-page-container\\\"><h1 class=\\\"se-landing-page-title\\\">{{ 'se.landingpage.title' | translate }}</h1><div class=\\\"se-landing-page-site-selection\\\" *ngIf=\\\"model\\\"><se-generic-editor-dropdown [field]=\\\"field\\\" [qualifier]=\\\"qualifier\\\" [model]=\\\"model\\\" [id]=\\\"sitesId\\\"></se-generic-editor-dropdown></div><p class=\\\"se-landing-page-label\\\">{{ 'se.landingpage.label' | translate }}</p></div></div><p class=\\\"se-landing-page-container se-landing-page-sub-header\\\">Content Catalogs</p><div class=\\\"se-landing-page-container se-landing-page-catalogs\\\"><div class=\\\"se-landing-page-catalog\\\" *ngFor=\\\"let catalog of catalogs; let isLast = last\\\"><se-catalog-details [catalog]=\\\"catalog\\\" [siteId]=\\\"model.site\\\" [isCatalogForCurrentSite]=\\\"isLast\\\"></se-catalog-details></div></div><img src=\\\"static-resources/images/best-run-sap-logo.svg\\\" class=\\\"se-landing-page-footer-logo\\\"/></div>\"\r\n        }),\r\n        __param(7, Inject(YJQUERY_TOKEN)),\r\n        __metadata(\"design:paramtypes\", [SiteService,\r\n            ICatalogService,\r\n            SystemEventService,\r\n            IStorageService,\r\n            IAlertService,\r\n            ActivatedRoute,\r\n            Location, Function])\r\n    ], /* @ngInject */ LandingPageComponent);\r\n    return /* @ngInject */ LandingPageComponent;\r\n}());\r\nexport { /* @ngInject */ LandingPageComponent };\r\n//# sourceMappingURL=LandingPageComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/common@8.2.14_@angular+core@8.2.14+rxjs@6.5.4/node_modules/@angular/common/common.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/router@8.2.14_e9fbe5720e9434eb9ae0f6720f1ca3f4/node_modules/@angular/router/router.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-container/src/services/index.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-container/src/components/pages/landingPage/types.ts"],"map":"{\"version\":3,\"file\":\"LandingPageComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/components/pages/landingPage/LandingPageComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-container/components/pages/landingPage/LandingPageComponent.d.ts","writeByteOrderMark":false,"text":"/// <reference types=\"angular\" />\r\n/// <reference types=\"jquery\" />\r\nimport './LandingPageComponent.scss';\r\nimport { Location } from '@angular/common';\r\nimport { OnDestroy, OnInit } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { GenericEditorField, IAlertService, IBaseCatalog, ICatalogService, IStorageService, SystemEventService } from 'smarteditcommons';\r\nimport { SiteService } from '../../../services';\r\nexport declare class LandingPageComponent implements OnInit, OnDestroy {\r\n    private siteService;\r\n    private catalogService;\r\n    private systemEventService;\r\n    private storageService;\r\n    private alertService;\r\n    private route;\r\n    private location;\r\n    private yjQuery;\r\n    readonly sitesId = \"sites-id\";\r\n    readonly qualifier = \"site\";\r\n    catalogs: IBaseCatalog[];\r\n    field: Partial<GenericEditorField>;\r\n    model: {\r\n        site: string;\r\n    };\r\n    private unregisterSitesDropdownEventHandler;\r\n    private readonly SELECTED_SITE_COOKIE_NAME;\r\n    constructor(siteService: SiteService, catalogService: ICatalogService, systemEventService: SystemEventService, storageService: IStorageService, alertService: IAlertService, route: ActivatedRoute, location: Location, yjQuery: JQueryStatic);\r\n    ngOnInit(): void;\r\n    ngOnDestroy(): void;\r\n    private getCurrentSiteId;\r\n    private updateRouteToRemoveSite;\r\n    private removeStorefrontCssClass;\r\n    private selectedSiteDropdownEventHandler;\r\n    private setSelectedSite;\r\n    private loadCatalogsBySite;\r\n    private setModel;\r\n}\r\n"}}
