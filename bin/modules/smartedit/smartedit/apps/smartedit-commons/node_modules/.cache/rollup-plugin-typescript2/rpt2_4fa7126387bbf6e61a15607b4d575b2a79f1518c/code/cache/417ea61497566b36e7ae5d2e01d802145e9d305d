{"code":"/*\r\n * Copyright (c) 2021 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { camelCase } from 'lodash';\r\nimport * as $script from 'scriptjs';\r\n/**\r\n * A collection of utility methods for Nodes.\r\n */\r\nvar NodeUtils = /** @class */ (function () {\r\n    function NodeUtils() {\r\n    }\r\n    /**\r\n     * Retrieves all the attributes of an overlay Node (identified by its data-smartedit-element-uuid attribute) containing with data-smartedit- or smartedit-\r\n     * and package them as a map of key values.\r\n     * Keys are stripped of data- and are turned to camelcase\r\n     * @returns Map of key values.\r\n     */\r\n    NodeUtils.prototype.collectSmarteditAttributesByElementUuid = function (elementUuid) {\r\n        var element = document.querySelector(\".smartEditComponent[data-smartedit-element-uuid='\" + elementUuid + \"']\");\r\n        if (!element) {\r\n            throw new Error(\"could not find element with uuid \" + elementUuid);\r\n        }\r\n        return Array.from(element.attributes).reduce(function (attributes, node) {\r\n            var attrName = node.name;\r\n            if (attrName.indexOf('smartedit-') > -1) {\r\n                attrName = camelCase(attrName.replace('data-', ''));\r\n                attributes[attrName] = node.value;\r\n            }\r\n            return attributes;\r\n        }, {});\r\n    };\r\n    NodeUtils.prototype.hasLegacyAngularJSBootsrap = function () {\r\n        return !!document.querySelector('[ng-app], [data-ng-app], [custom-app]');\r\n    };\r\n    /**\r\n     * A function to sort an array containing DOM elements according to their position in the DOM\r\n     *\r\n     * @param key Optional key value to get the\r\n     *\r\n     * @returns The compare function to use with array.sort(compareFunction) to order DOM elements as they would appear in the DOM\r\n     */\r\n    NodeUtils.prototype.compareHTMLElementsPosition = function (key) {\r\n        return function (a, b) {\r\n            if (key) {\r\n                a = a[key];\r\n                b = b[key];\r\n            }\r\n            if (a === b) {\r\n                return 0;\r\n            }\r\n            if (!a.compareDocumentPosition) {\r\n                // support for IE8 and below\r\n                return a.sourceIndex - b.sourceIndex;\r\n            }\r\n            if (a.compareDocumentPosition(b) & 2) {\r\n                // Note: CompareDocumentPosition returns the compared value as a bitmask that can take several values.\r\n                // 2 represents DOCUMENT_POSITION_PRECEDING, which means that b comes before a.\r\n                return 1;\r\n            }\r\n            return -1;\r\n        };\r\n    };\r\n    /**\r\n     * Method will check if the given point is over the htmlElement.\r\n     *\r\n     * @returns True if the given point is over the htmlElement.\r\n     */\r\n    NodeUtils.prototype.isPointOverElement = function (point, htmlElement) {\r\n        var domRect = htmlElement.getBoundingClientRect();\r\n        return (point.x >= domRect.left &&\r\n            point.x <= domRect.right &&\r\n            point.y >= domRect.top &&\r\n            point.y <= domRect.bottom);\r\n    };\r\n    /**\r\n     * Determines whether 2 BoundingClientRect are intersecting even partially.\r\n     *\r\n     * @param boundingClientRect1 size of an element and its position relative to the viewport as per {@link https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect API}\r\n     * @param boundingClientRect2 size of an element and its position relative to the viewport as per {@link https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect API}\r\n     * @returns True if there is a partial or total intersection\r\n     */\r\n    NodeUtils.prototype.areIntersecting = function (boundingClientRect1, boundingClientRect2) {\r\n        return !(boundingClientRect2.left > boundingClientRect1.left + boundingClientRect1.width ||\r\n            boundingClientRect2.left + boundingClientRect2.width < boundingClientRect1.left ||\r\n            boundingClientRect2.top > boundingClientRect1.top + boundingClientRect1.height ||\r\n            boundingClientRect2.top + boundingClientRect2.height < boundingClientRect1.top);\r\n    };\r\n    NodeUtils.prototype.injectJS = function () {\r\n        function getInjector() {\r\n            return $script;\r\n        }\r\n        return {\r\n            getInjector: getInjector,\r\n            execute: function (conf) {\r\n                var _this = this;\r\n                var srcs = conf.srcs;\r\n                var index = conf.index;\r\n                var callback = conf.callback;\r\n                if (!srcs.length) {\r\n                    callback();\r\n                    return;\r\n                }\r\n                if (index === undefined) {\r\n                    index = 0;\r\n                }\r\n                if (srcs[index] !== undefined) {\r\n                    this.getInjector()(srcs[index], function () {\r\n                        if (index + 1 < srcs.length) {\r\n                            _this.execute({\r\n                                srcs: srcs,\r\n                                index: index + 1,\r\n                                callback: callback\r\n                            });\r\n                        }\r\n                        else if (typeof callback === 'function') {\r\n                            callback();\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        };\r\n    };\r\n    return NodeUtils;\r\n}());\r\nexport { NodeUtils };\r\nexport var nodeUtils = new NodeUtils();\r\n//# sourceMappingURL=NodeUtils.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@types/lodash@4.14.159/node_modules/@types/lodash/ts3.1/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@types/scriptjs@0.0.2/node_modules/@types/scriptjs/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/di/index.ts"],"map":"{\"version\":3,\"file\":\"NodeUtils.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/utils/NodeUtils.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/utils/NodeUtils.d.ts","writeByteOrderMark":false,"text":"import { ComponentAttributes, SeFactory } from '../di';\r\n/**\r\n * A collection of utility methods for Nodes.\r\n */\r\nexport declare class NodeUtils {\r\n    /**\r\n     * Retrieves all the attributes of an overlay Node (identified by its data-smartedit-element-uuid attribute) containing with data-smartedit- or smartedit-\r\n     * and package them as a map of key values.\r\n     * Keys are stripped of data- and are turned to camelcase\r\n     * @returns Map of key values.\r\n     */\r\n    collectSmarteditAttributesByElementUuid(elementUuid: string): ComponentAttributes;\r\n    hasLegacyAngularJSBootsrap(): boolean;\r\n    /**\r\n     * A function to sort an array containing DOM elements according to their position in the DOM\r\n     *\r\n     * @param key Optional key value to get the\r\n     *\r\n     * @returns The compare function to use with array.sort(compareFunction) to order DOM elements as they would appear in the DOM\r\n     */\r\n    compareHTMLElementsPosition(key?: string): (a: any, b: any) => number;\r\n    /**\r\n     * Method will check if the given point is over the htmlElement.\r\n     *\r\n     * @returns True if the given point is over the htmlElement.\r\n     */\r\n    isPointOverElement(point: {\r\n        x: number;\r\n        y: number;\r\n    }, htmlElement: HTMLElement): boolean;\r\n    /**\r\n     * Determines whether 2 BoundingClientRect are intersecting even partially.\r\n     *\r\n     * @param boundingClientRect1 size of an element and its position relative to the viewport as per {@link https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect API}\r\n     * @param boundingClientRect2 size of an element and its position relative to the viewport as per {@link https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect API}\r\n     * @returns True if there is a partial or total intersection\r\n     */\r\n    areIntersecting(boundingClientRect1: ClientRect, boundingClientRect2: ClientRect): boolean;\r\n    injectJS(): {\r\n        getInjector: () => any;\r\n        execute: (conf: {\r\n            srcs: string[];\r\n            callback: SeFactory;\r\n            index?: number;\r\n        }) => void;\r\n    };\r\n}\r\nexport declare const nodeUtils: NodeUtils;\r\n"}}
