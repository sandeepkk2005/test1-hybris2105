{"code":"import { __awaiter, __decorate, __extends, __generator, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2021 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { IContextAwareEditableItemService, IPageService } from 'cmscommons';\r\nimport { GatewayProxied, SeDowngradeService } from 'smarteditcommons';\r\nimport { WorkflowService } from '../../components/workflow/services/WorkflowService';\r\nvar /* @ngInject */ ContextAwareEditableItemService = /** @class */ (function (_super) {\r\n    __extends(/* @ngInject */ ContextAwareEditableItemService, _super);\r\n    function /* @ngInject */ ContextAwareEditableItemService(workflowService, pageService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.workflowService = workflowService;\r\n        _this.pageService = pageService;\r\n        return _this;\r\n    }\r\n    /* @ngInject */ ContextAwareEditableItemService.prototype.isItemEditable = function (itemUid) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var workflowEditableItems, item, editable;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.workflowService.getWorkflowEditableItems([\r\n                            itemUid\r\n                        ])];\r\n                    case 1:\r\n                        workflowEditableItems = _a.sent();\r\n                        item = workflowEditableItems.find(function (data) { return data.uid === itemUid; });\r\n                        if (!item.editableInWorkflow) return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, this.editableInCurrentPageContext(item.editableInWorkflow)];\r\n                    case 2:\r\n                        editable = _a.sent();\r\n                        return [2 /*return*/, item.editableByUser && editable];\r\n                    case 3: return [2 /*return*/, item.editableByUser];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Verifies whether the item's active workflow equals to the workflow of page currently in preview.\r\n     */\r\n    /* @ngInject */ ContextAwareEditableItemService.prototype.editableInCurrentPageContext = function (editableInWorkflow) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var pageInfo, activeWorkflow, _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _b.trys.push([0, 3, , 4]);\r\n                        return [4 /*yield*/, this.pageService.getCurrentPageInfo()];\r\n                    case 1:\r\n                        pageInfo = _b.sent();\r\n                        return [4 /*yield*/, this.workflowService.getActiveWorkflowForPageUuid(pageInfo.uid)];\r\n                    case 2:\r\n                        activeWorkflow = _b.sent();\r\n                        return [2 /*return*/, activeWorkflow !== null && activeWorkflow.workflowCode === editableInWorkflow];\r\n                    case 3:\r\n                        _a = _b.sent();\r\n                        return [2 /*return*/, true];\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ ContextAwareEditableItemService = __decorate([\r\n        SeDowngradeService(IContextAwareEditableItemService),\r\n        GatewayProxied(),\r\n        __metadata(\"design:paramtypes\", [WorkflowService, IPageService])\r\n    ], /* @ngInject */ ContextAwareEditableItemService);\r\n    return /* @ngInject */ ContextAwareEditableItemService;\r\n}(IContextAwareEditableItemService));\r\nexport { /* @ngInject */ ContextAwareEditableItemService };\r\n//# sourceMappingURL=ContextAwareEditableItemServiceOuter.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/workflow/services/WorkflowService.ts"],"map":"{\"version\":3,\"file\":\"ContextAwareEditableItemServiceOuter.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/services/contextAwareEditableItem/ContextAwareEditableItemServiceOuter.ts\"],\"names\":[],\"mappings\":\";AAAA;;GAEG;AACH,OAAO,EAAE,gCAAgC,EAAE,YAAY,EAAE,MAAM,YAAY,CAAC;AAC5E,OAAO,EAAE,cAAc,EAAE,kBAAkB,EAAE,MAAM,kBAAkB,CAAC;AACtE,OAAO,EAAE,eAAe,EAAE,MAAM,oDAAoD,CAAC;AAIrF;IAAqD,mEAAgC;IACjF,yDAAoB,eAAgC,EAAU,WAAyB;QAAvF,YACI,iBAAO,SACV;QAFmB,qBAAe,GAAf,eAAe,CAAiB;QAAU,iBAAW,GAAX,WAAW,CAAc;;IAEvF,CAAC;IAEY,wEAAc,GAA3B,UAA4B,OAAe;;;;;4BACT,qBAAM,IAAI,CAAC,eAAe,CAAC,wBAAwB,CAAC;4BAC9E,OAAO;yBACV,CAAC,EAAA;;wBAFI,qBAAqB,GAAG,SAE5B;wBACI,IAAI,GAAG,qBAAqB,CAAC,IAAI,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,GAAG,KAAK,OAAO,EAApB,CAAoB,CAAC,CAAC;6BAEpE,IAAI,CAAC,kBAAkB,EAAvB,wBAAuB;wBACN,qBAAM,IAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,kBAAkB,CAAC,EAAA;;wBAA3E,QAAQ,GAAG,SAAgE;wBACjF,sBAAO,IAAI,CAAC,cAAc,IAAI,QAAQ,EAAC;4BAG3C,sBAAO,IAAI,CAAC,cAAc,EAAC;;;;KAC9B;IAED;;OAEG;IACW,sFAA4B,GAA1C,UAA2C,kBAA0B;;;;;;;wBAE5C,qBAAM,IAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,EAAA;;wBAAtD,QAAQ,GAAG,SAA2C;wBACrC,qBAAM,IAAI,CAAC,eAAe,CAAC,4BAA4B,CAC1E,QAAQ,CAAC,GAAG,CACf,EAAA;;wBAFK,cAAc,GAAG,SAEtB;wBACD,sBAAO,cAAc,KAAK,IAAI,IAAI,cAAc,CAAC,YAAY,KAAK,kBAAkB,EAAC;;;wBAErF,sBAAO,IAAI,EAAC;;;;;KAEnB;IAhCL;QAFC,kBAAkB,CAAC,gCAAgC,CAAC;QACpD,cAAc,EAAE;yCAEwB,eAAe,EAAuB,YAAY;uDAgC1F;IAAD,sDAAC;CAAA,AAjCD,CAAqD,gCAAgC,GAiCpF\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/services/contextAwareEditableItem/ContextAwareEditableItemServiceOuter.d.ts","writeByteOrderMark":false,"text":"import { IContextAwareEditableItemService, IPageService } from 'cmscommons';\r\nimport { WorkflowService } from '../../components/workflow/services/WorkflowService';\r\nexport declare class ContextAwareEditableItemService extends IContextAwareEditableItemService {\r\n    private workflowService;\r\n    private pageService;\r\n    constructor(workflowService: WorkflowService, pageService: IPageService);\r\n    isItemEditable(itemUid: string): Promise<boolean>;\r\n    /**\r\n     * Verifies whether the item's active workflow equals to the workflow of page currently in preview.\r\n     */\r\n    private editableInCurrentPageContext;\r\n}\r\n"}}
