{"code":"import { __awaiter, __decorate, __generator, __metadata, __param } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\r\nimport { FILE_VALIDATION_CONFIG, FileValidationService, GENERIC_EDITOR_WIDGET_DATA, LogService } from 'smarteditcommons';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"MediaComponent\", {\r\n    selector: 'se-media',\r\n    template: \"<div class=\\\"se-media\\\"><se-media-selector *ngIf=\\\"!image\\\" [id]=\\\"mediaSelectorId\\\" [isDisabled]=\\\"isFieldDisabled\\\" [mediaId]=\\\"mediaIdByLang[lang]\\\" (mediaIdChange)=\\\"onMediaIdChange($event)\\\"></se-media-selector><se-media-file-selector *ngIf=\\\"canShowFileSelector()\\\" [labelI18nKey]=\\\"'se.upload.image.to.library'\\\" [acceptedFileTypes]=\\\"acceptedFileTypes\\\" [selectionMode]=\\\"'upload'\\\" [disabled]=\\\"isFieldDisabled\\\" (onFileSelect)=\\\"onFileSelect($event)\\\"></se-media-file-selector><se-media-upload-form *ngIf=\\\"image\\\" class=\\\"se-media-upload-form-wrapper\\\" [image]=\\\"image\\\" (onCancel)=\\\"resetImage()\\\" (onSelect)=\\\"onFileSelect($event)\\\" (onUploadSuccess)=\\\"onMediaUploaded($event)\\\"></se-media-upload-form><se-media-errors *ngIf=\\\"fileErrors.length > 0\\\" [errors]=\\\"fileErrors\\\"></se-media-errors></div>\",\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nvar MediaComponent = /** @class */ (function () {\r\n    function MediaComponent(cdr, fileValidationService, logService, data) {\r\n        this.cdr = cdr;\r\n        this.fileValidationService = fileValidationService;\r\n        this.logService = logService;\r\n        (this.field = data.field, this.mediaIdByLang = data.model, this.lang = data.qualifier);\r\n        this.acceptedFileTypes = FILE_VALIDATION_CONFIG.ACCEPTED_FILE_TYPES;\r\n        this.fileErrors = [];\r\n        this.image = null;\r\n        this.isFieldDisabled = data.isFieldDisabled();\r\n        this.mediaSelectorId = this.field.qualifier;\r\n    }\r\n    MediaComponent.prototype.onMediaIdChange = function (id) {\r\n        this.mediaIdByLang[this.lang] = id;\r\n    };\r\n    MediaComponent.prototype.onFileSelect = function (fileList) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var file, _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        this.resetImage();\r\n                        file = fileList[0];\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, this.fileValidationService.validate(file, this.fileErrors)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        this.image = file;\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        _a = _b.sent();\r\n                        this.logService.warn('Invalid file');\r\n                        return [3 /*break*/, 4];\r\n                    case 4:\r\n                        this.cdr.detectChanges();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    MediaComponent.prototype.onMediaUploaded = function (id) {\r\n        this.resetImage();\r\n        this.onMediaIdChange(id);\r\n        if (this.field.initiated) {\r\n            this.field.initiated.length = 0;\r\n        }\r\n    };\r\n    MediaComponent.prototype.resetImage = function () {\r\n        this.fileErrors = [];\r\n        this.image = null;\r\n    };\r\n    MediaComponent.prototype.canShowFileSelector = function () {\r\n        return this.mediaIdByLang && !this.mediaIdByLang[this.lang] && !this.image;\r\n    };\r\n    MediaComponent = __decorate([\r\n        Component({\r\n            selector: 'se-media',\r\n            template: \"<div class=\\\"se-media\\\"><se-media-selector *ngIf=\\\"!image\\\" [id]=\\\"mediaSelectorId\\\" [isDisabled]=\\\"isFieldDisabled\\\" [mediaId]=\\\"mediaIdByLang[lang]\\\" (mediaIdChange)=\\\"onMediaIdChange($event)\\\"></se-media-selector><se-media-file-selector *ngIf=\\\"canShowFileSelector()\\\" [labelI18nKey]=\\\"'se.upload.image.to.library'\\\" [acceptedFileTypes]=\\\"acceptedFileTypes\\\" [selectionMode]=\\\"'upload'\\\" [disabled]=\\\"isFieldDisabled\\\" (onFileSelect)=\\\"onFileSelect($event)\\\"></se-media-file-selector><se-media-upload-form *ngIf=\\\"image\\\" class=\\\"se-media-upload-form-wrapper\\\" [image]=\\\"image\\\" (onCancel)=\\\"resetImage()\\\" (onSelect)=\\\"onFileSelect($event)\\\" (onUploadSuccess)=\\\"onMediaUploaded($event)\\\"></se-media-upload-form><se-media-errors *ngIf=\\\"fileErrors.length > 0\\\" [errors]=\\\"fileErrors\\\"></se-media-errors></div>\",\r\n            changeDetection: ChangeDetectionStrategy.OnPush\r\n        }),\r\n        __param(3, Inject(GENERIC_EDITOR_WIDGET_DATA)),\r\n        __metadata(\"design:paramtypes\", [ChangeDetectorRef,\r\n            FileValidationService,\r\n            LogService, Object])\r\n    ], MediaComponent);\r\n    return MediaComponent;\r\n}());\r\nexport { MediaComponent };\r\n//# sourceMappingURL=MediaComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"MediaComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../../src/components/genericEditor/media/components/media/MediaComponent.ts\"],\"names\":[],\"mappings\":\";AACA,OAAO,EAAE,uBAAuB,EAAE,iBAAiB,EAAE,SAAS,EAAE,MAAM,EAAE,MAAM,eAAe,CAAC;AAC9F,OAAO,EAEH,sBAAsB,EACtB,qBAAqB,EAGrB,0BAA0B,EAC1B,UAAU,EAEb,MAAM,kBAAkB,CAAC;wEAGf;IACP,QAAQ,EAAE,UAAU;IACpB,QAAQ,EAAE,8yBAAswB;IAChxB,eAAe,EAAE,uBAAuB,CAAC,MAAM;CAClD;AACD;IAWI,wBACY,GAAsB,EACtB,qBAA4C,EAC5C,UAAsB,EAE9B,IAA+C;QAJvC,QAAG,GAAH,GAAG,CAAmB;QACtB,0BAAqB,GAArB,qBAAqB,CAAuB;QAC5C,eAAU,GAAV,UAAU,CAAY;QAI9B,CAAU,IAAI,CAAC,KAAK,GAAsD,IAAI,MAA1D,EAAS,IAAI,CAAC,aAAa,GAA2B,IAAI,MAA/B,EAAa,IAAI,CAAC,IAAI,GAAK,IAAI,UAAT,CAAU,CAAC;QAEhF,IAAI,CAAC,iBAAiB,GAAG,sBAAsB,CAAC,mBAAmB,CAAC;QACpE,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QACrB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;QAC9C,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;IAChD,CAAC;IAEM,wCAAe,GAAtB,UAAuB,EAAU;QAC7B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;IACvC,CAAC;IAEY,qCAAY,GAAzB,UAA0B,QAAkB;;;;;;wBACxC,IAAI,CAAC,UAAU,EAAE,CAAC;wBAEZ,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;;;;wBAErB,qBAAM,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,CAAC,EAAA;;wBAAhE,SAAgE,CAAC;wBACjE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;;;;wBAElB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;;;wBAEzC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;;;;;KAC5B;IAEM,wCAAe,GAAtB,UAAuB,EAAU;QAC7B,IAAI,CAAC,UAAU,EAAE,CAAC;QAElB,IAAI,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;QAEzB,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE;YACtB,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;SACnC;IACL,CAAC;IAEM,mCAAU,GAAjB;QACI,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QACrB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;IACtB,CAAC;IAGM,4CAAmB,GAA1B;QACI,OAAO,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;IAC/E,CAAC;IA9DQ,cAAc;QAL1B,SAAS,CAAC;YACP,QAAQ,EAAE,UAAU;YACpB,QAAQ,EAAE,8yBAAswB;YAChxB,eAAe,EAAE,uBAAuB,CAAC,MAAM;SAClD,CAAC;QAgBO,WAAA,MAAM,CAAC,0BAA0B,CAAC,CAAA;yCAHtB,iBAAiB;YACC,qBAAqB;YAChC,UAAU;OAdzB,cAAc,CA+D1B;IAAD,qBAAC;CAAA,AA/DD,IA+DC;SA/DY,cAAc\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/components/genericEditor/media/components/media/MediaComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef } from '@angular/core';\r\nimport { ErrorContext, FILE_VALIDATION_CONFIG, FileValidationService, GenericEditorWidgetData, LogService, TypedMap } from 'smarteditcommons';\r\nexport declare class MediaComponent {\r\n    private cdr;\r\n    private fileValidationService;\r\n    private logService;\r\n    acceptedFileTypes: typeof FILE_VALIDATION_CONFIG.ACCEPTED_FILE_TYPES;\r\n    fileErrors: ErrorContext[];\r\n    image: File | null;\r\n    isFieldDisabled: boolean;\r\n    mediaSelectorId: string;\r\n    private mediaIdByLang;\r\n    private lang;\r\n    private field;\r\n    constructor(cdr: ChangeDetectorRef, fileValidationService: FileValidationService, logService: LogService, data: GenericEditorWidgetData<TypedMap<string>>);\r\n    onMediaIdChange(id: string): void;\r\n    onFileSelect(fileList: FileList): Promise<void>;\r\n    onMediaUploaded(id: string): void;\r\n    resetImage(): void;\r\n    canShowFileSelector(): boolean;\r\n}\r\n"}}
