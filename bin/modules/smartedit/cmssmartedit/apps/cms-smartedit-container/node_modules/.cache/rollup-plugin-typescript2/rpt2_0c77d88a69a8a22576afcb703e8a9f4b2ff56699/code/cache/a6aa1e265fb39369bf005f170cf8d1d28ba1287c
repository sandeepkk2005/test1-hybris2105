{"code":"import { __awaiter, __decorate, __generator, __metadata } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Input } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { CmsitemsRestService } from 'cmscommons';\r\nimport { take } from 'rxjs/operators';\r\nimport { ICatalogService, ISharedDataService, L10nPipe, SeDowngradeComponent, EXPERIENCE_STORAGE_KEY } from 'smarteditcommons';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"PageSynchronizationHeaderComponent\", {\r\n    selector: 'se-page-synchronization-header',\r\n    template: \"<ng-container *ngIf=\\\"ready\\\"><div class=\\\"se-sync-panel-header\\\"><span class=\\\"se-sync-panel-header__sub-header\\\" [translate]=\\\"getSubHeaderText()\\\"></span></div><div *ngIf=\\\"isNewPage()\\\" class=\\\"se-sync-panel-new-page\\\"><div class=\\\"se-sync-panel-new-page__header\\\" translate=\\\"se.cms.synchronization.page.new.header\\\"></div><div class=\\\"se-sync-panel-new-page__message\\\">{{ headerText }}</div></div><div class=\\\"se-sync-panel-header__timestamp\\\" *ngIf=\\\"!isNewPage()\\\"><div translate=\\\"se.cms.synchronization.panel.lastsync.text\\\"></div><span class=\\\"se-sync-panel-header__timestamp-text\\\">{{ syncStatus.lastSyncStatus | date: 'M/d/yy h:mm a' }}</span></div></ng-container>\",\r\n    styles: [\".se-sync-panel-header{padding:0 20px 20px;border-bottom:1px solid #d9d9d9;min-width:400px}.se-sync-panel-header__sub-header{padding-top:4px;color:#51555a}.se-sync-panel-header__timestamp{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a;position:absolute;left:20px;bottom:23px;width:150px}.se-sync-panel-new-page{padding:20px}.se-sync-panel-new-page__header{font-weight:700;padding-bottom:4px}.se-sync-panel-new-page__message{white-space:normal}\"],\r\n    providers: [L10nPipe],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nvar /* @ngInject */ PageSynchronizationHeaderComponent = /** @class */ (function () {\r\n    function /* @ngInject */ PageSynchronizationHeaderComponent(sharedDataService, catalogService, cmsitemsRestService, translateService, l10nPipe, cdr) {\r\n        this.sharedDataService = sharedDataService;\r\n        this.catalogService = catalogService;\r\n        this.cmsitemsRestService = cmsitemsRestService;\r\n        this.translateService = translateService;\r\n        this.l10nPipe = l10nPipe;\r\n        this.cdr = cdr;\r\n        this.ready = false;\r\n    }\r\n    /* @ngInject */ PageSynchronizationHeaderComponent.prototype.ngOnChanges = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this.syncStatus) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        this.ready = false;\r\n                        return [4 /*yield*/, this.updateHeaderText()];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this.ready = true;\r\n                        this.cdr.detectChanges();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ PageSynchronizationHeaderComponent.prototype.getSubHeaderText = function () {\r\n        if (this.isDefaultSubHeader()) {\r\n            return 'se.cms.synchronization.page.header';\r\n        }\r\n        else if (this.isSyncOldHomeHeader()) {\r\n            return 'se.cms.synchronization.page.header.old.homepage';\r\n        }\r\n    };\r\n    /* @ngInject */ PageSynchronizationHeaderComponent.prototype.isNewPage = function () {\r\n        return this.pageSyncConditions.pageHasNoDepOrNoSyncStatus;\r\n    };\r\n    /* @ngInject */ PageSynchronizationHeaderComponent.prototype.isSyncOldHomeHeader = function () {\r\n        return (this.pageSyncConditions.pageHasSyncStatus && !this.pageSyncConditions.canSyncHomepage);\r\n    };\r\n    /* @ngInject */ PageSynchronizationHeaderComponent.prototype.isDefaultSubHeader = function () {\r\n        return !this.isSyncOldHomeHeader() && !this.isNewPage();\r\n    };\r\n    /* @ngInject */ PageSynchronizationHeaderComponent.prototype.updateHeaderText = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var experience, _a, catalogId, catalogName, catalogVersion, itemNames;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0: return [4 /*yield*/, this.sharedDataService.get(EXPERIENCE_STORAGE_KEY)];\r\n                    case 1:\r\n                        experience = (_b.sent());\r\n                        return [4 /*yield*/, this.getCurrentCatalogIdFromExperience(experience)];\r\n                    case 2:\r\n                        _a = _b.sent(), catalogId = _a.catalogId, catalogName = _a.catalogName;\r\n                        return [4 /*yield*/, this.catalogService.getActiveContentCatalogVersionByCatalogId(catalogId)];\r\n                    case 3:\r\n                        catalogVersion = _b.sent();\r\n                        return [4 /*yield*/, (this.pageSyncConditions.pageHasUnavailableDependencies\r\n                                ? this.fetchUnavailableDependencies()\r\n                                : null)];\r\n                    case 4:\r\n                        itemNames = _b.sent();\r\n                        this.headerText = this.pageSyncConditions.pageHasUnavailableDependencies\r\n                            ? this.translateService.instant('se.cms.synchronization.page.unavailable.items.description', {\r\n                                itemNames: itemNames,\r\n                                catalogName: catalogName,\r\n                                catalogVersion: catalogVersion\r\n                            })\r\n                            : this.translateService.instant('se.cms.synchronization.page.new.description', {\r\n                                catalogName: catalogName,\r\n                                catalogVersion: catalogVersion\r\n                            });\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ PageSynchronizationHeaderComponent.prototype.userIsInsidePage = function (pageContext) {\r\n        return !!pageContext;\r\n    };\r\n    /* @ngInject */ PageSynchronizationHeaderComponent.prototype.getCurrentCatalogIdFromExperience = function (_a) {\r\n        var pageContext = _a.pageContext, catalogDescriptor = _a.catalogDescriptor;\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var catalogId, catalogName, catalogNameTranslated;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        catalogId = this.userIsInsidePage(pageContext)\r\n                            ? pageContext.catalogId\r\n                            : catalogDescriptor.catalogId;\r\n                        catalogName = this.userIsInsidePage(pageContext)\r\n                            ? pageContext.catalogName\r\n                            : catalogDescriptor.name;\r\n                        return [4 /*yield*/, this.l10nPipe\r\n                                .transform(catalogName)\r\n                                .pipe(take(1))\r\n                                .toPromise()];\r\n                    case 1:\r\n                        catalogNameTranslated = _b.sent();\r\n                        return [2 /*return*/, {\r\n                                catalogId: catalogId,\r\n                                catalogName: catalogNameTranslated\r\n                            }];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ PageSynchronizationHeaderComponent.prototype.fetchUnavailableDependencies = function () {\r\n        var itemIds = this.syncStatus.unavailableDependencies.map(function (_a) {\r\n            var itemId = _a.itemId;\r\n            return itemId;\r\n        });\r\n        return this.cmsitemsRestService\r\n            .getByIds(itemIds)\r\n            .then(function (_a) {\r\n            var response = _a.response;\r\n            return response.map(function (_a) {\r\n                var name = _a.name;\r\n                return name;\r\n            }).join(', ');\r\n        });\r\n    };\r\n    __decorate([\r\n        Input(),\r\n        __metadata(\"design:type\", Object)\r\n    ], /* @ngInject */ PageSynchronizationHeaderComponent.prototype, \"syncStatus\", void 0);\r\n    __decorate([\r\n        Input(),\r\n        __metadata(\"design:type\", Object)\r\n    ], /* @ngInject */ PageSynchronizationHeaderComponent.prototype, \"pageSyncConditions\", void 0);\r\n    /* @ngInject */ PageSynchronizationHeaderComponent = __decorate([\r\n        SeDowngradeComponent(),\r\n        Component({\r\n            selector: 'se-page-synchronization-header',\r\n            template: \"<ng-container *ngIf=\\\"ready\\\"><div class=\\\"se-sync-panel-header\\\"><span class=\\\"se-sync-panel-header__sub-header\\\" [translate]=\\\"getSubHeaderText()\\\"></span></div><div *ngIf=\\\"isNewPage()\\\" class=\\\"se-sync-panel-new-page\\\"><div class=\\\"se-sync-panel-new-page__header\\\" translate=\\\"se.cms.synchronization.page.new.header\\\"></div><div class=\\\"se-sync-panel-new-page__message\\\">{{ headerText }}</div></div><div class=\\\"se-sync-panel-header__timestamp\\\" *ngIf=\\\"!isNewPage()\\\"><div translate=\\\"se.cms.synchronization.panel.lastsync.text\\\"></div><span class=\\\"se-sync-panel-header__timestamp-text\\\">{{ syncStatus.lastSyncStatus | date: 'M/d/yy h:mm a' }}</span></div></ng-container>\",\r\n            styles: [\".se-sync-panel-header{padding:0 20px 20px;border-bottom:1px solid #d9d9d9;min-width:400px}.se-sync-panel-header__sub-header{padding-top:4px;color:#51555a}.se-sync-panel-header__timestamp{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a;position:absolute;left:20px;bottom:23px;width:150px}.se-sync-panel-new-page{padding:20px}.se-sync-panel-new-page__header{font-weight:700;padding-bottom:4px}.se-sync-panel-new-page__message{white-space:normal}\"],\r\n            providers: [L10nPipe],\r\n            changeDetection: ChangeDetectionStrategy.OnPush\r\n        }),\r\n        __metadata(\"design:paramtypes\", [ISharedDataService,\r\n            ICatalogService,\r\n            CmsitemsRestService,\r\n            TranslateService,\r\n            L10nPipe,\r\n            ChangeDetectorRef])\r\n    ], /* @ngInject */ PageSynchronizationHeaderComponent);\r\n    return /* @ngInject */ PageSynchronizationHeaderComponent;\r\n}());\r\nexport { /* @ngInject */ PageSynchronizationHeaderComponent };\r\n//# sourceMappingURL=PageSynchronizationHeaderComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@ngx-translate/core@11.0.1_@angular+core@8.2.14+rxjs@6.5.4/node_modules/@ngx-translate/core/ngx-translate-core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/rxjs@6.5.4/node_modules/rxjs/operators/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/synchronize/types.ts"],"map":"{\"version\":3,\"file\":\"PageSynchronizationHeaderComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/synchronize/components/pageSynchronizationHeader/PageSynchronizationHeaderComponent.ts\"],\"names\":[],\"mappings\":\";AACA,OAAO,EACH,uBAAuB,EACvB,iBAAiB,EACjB,SAAS,EACT,KAAK,EAER,MAAM,eAAe,CAAC;AACvB,OAAO,EAAE,gBAAgB,EAAE,MAAM,qBAAqB,CAAC;AACvD,OAAO,EAAE,mBAAmB,EAAe,MAAM,YAAY,CAAC;AAC9D,OAAO,EAAE,IAAI,EAAE,MAAM,gBAAgB,CAAC;AACtC,OAAO,EACH,eAAe,EAGf,kBAAkB,EAClB,QAAQ,EACR,oBAAoB,EACpB,sBAAsB,EACzB,MAAM,kBAAkB,CAAC;4FAIf;IACP,QAAQ,EAAE,gCAAgC;IAC1C,QAAQ,EAAE,uqBAA6oB;IACvpB,MAAM,EAAE,CAAC,6dAA6d,CAAC;IACve,SAAS,EAAE,CAAC,QAAQ,CAAC;IACrB,eAAe,EAAE,uBAAuB,CAAC,MAAM;CAClD;AACD;IAOI,4DACY,iBAAqC,EACrC,cAA+B,EAC/B,mBAAwC,EACxC,gBAAkC,EAClC,QAAkB,EAClB,GAAsB;QALtB,sBAAiB,GAAjB,iBAAiB,CAAoB;QACrC,mBAAc,GAAd,cAAc,CAAiB;QAC/B,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,aAAQ,GAAR,QAAQ,CAAU;QAClB,QAAG,GAAH,GAAG,CAAmB;QAE9B,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACvB,CAAC;IAEK,wEAAW,GAAjB;;;;;wBACI,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;4BAClB,sBAAO;yBACV;wBACD,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;wBAEnB,qBAAM,IAAI,CAAC,gBAAgB,EAAE,EAAA;;wBAA7B,SAA6B,CAAC;wBAE9B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;wBAElB,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;;;;;KAC5B;IAEM,6EAAgB,GAAvB;QACI,IAAI,IAAI,CAAC,kBAAkB,EAAE,EAAE;YAE3B,OAAO,oCAAoC,CAAC;SAC/C;aAAM,IAAI,IAAI,CAAC,mBAAmB,EAAE,EAAE;YAEnC,OAAO,iDAAiD,CAAC;SAC5D;IACL,CAAC;IAEM,sEAAS,GAAhB;QACI,OAAO,IAAI,CAAC,kBAAkB,CAAC,0BAA0B,CAAC;IAC9D,CAAC;IAGM,gFAAmB,GAA1B;QACI,OAAO,CACH,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,eAAe,CACxF,CAAC;IACN,CAAC;IAEM,+EAAkB,GAAzB;QACI,OAAO,CAAC,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;IAC5D,CAAC;IAGa,6EAAgB,GAA9B;;;;;4BACwB,qBAAM,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAChD,sBAAsB,CACzB,EAAA;;wBAFK,UAAU,GAAG,CAAC,SAEnB,CAAgB;wBACkB,qBAAM,IAAI,CAAC,iCAAiC,CAAC,UAAU,CAAC,EAAA;;wBAArF,KAA6B,SAAwD,EAAnF,SAAS,eAAA,EAAE,WAAW,iBAAA;wBAEP,qBAAM,IAAI,CAAC,cAAc,CAAC,yCAAyC,CACtF,SAAS,CACZ,EAAA;;wBAFK,cAAc,GAAG,SAEtB;wBAEiB,qBAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,8BAA8B;gCAC3E,CAAC,CAAC,IAAI,CAAC,4BAA4B,EAAE;gCACrC,CAAC,CAAC,IAAI,CAAC,EAAA;;wBAFL,SAAS,GAAG,SAEP;wBAEX,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,8BAA8B;4BACpE,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,OAAO,CACzB,2DAA2D,EAC3D;gCACI,SAAS,WAAA;gCACT,WAAW,aAAA;gCACX,cAAc,gBAAA;6BACjB,CACJ;4BACH,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,6CAA6C,EAAE;gCACzE,WAAW,aAAA;gCACX,cAAc,gBAAA;6BACjB,CAAC,CAAC;;;;;KACZ;IAEO,6EAAgB,GAAxB,UAAyB,WAAmC;QACxD,OAAO,CAAC,CAAC,WAAW,CAAC;IACzB,CAAC;IAEa,8FAAiC,GAA/C,UAAgD,EAGlC;YAFV,WAAW,iBAAA,EACX,iBAAiB,uBAAA;;;;;;wBAEX,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC;4BAChD,CAAC,CAAC,WAAW,CAAC,SAAS;4BACvB,CAAC,CAAC,iBAAiB,CAAC,SAAS,CAAC;wBAC5B,WAAW,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC;4BAClD,CAAC,CAAC,WAAW,CAAC,WAAW;4BACzB,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC;wBACC,qBAAM,IAAI,CAAC,QAAQ;iCAC5C,SAAS,CAAC,WAAW,CAAC;iCACtB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;iCACb,SAAS,EAAE,EAAA;;wBAHV,qBAAqB,GAAG,SAGd;wBAEhB,sBAAO;gCACH,SAAS,WAAA;gCACT,WAAW,EAAE,qBAAqB;6BACrC,EAAC;;;;KACL;IAEO,yFAA4B,GAApC;QACI,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,uBAAuB,CAAC,GAAG,CACvD,UAAC,EAAuB;gBAArB,MAAM,YAAA;YAAoB,OAAA,MAAM;QAAN,CAAM,CACtC,CAAC;QACF,OAAO,IAAI,CAAC,mBAAmB;aAC1B,QAAQ,CAAC,OAAO,CAAC;aACjB,IAAI,CAAC,UAAC,EAAY;gBAAV,QAAQ,cAAA;YAAO,OAAA,QAAQ,CAAC,GAAG,CAAC,UAAC,EAAQ;oBAAN,IAAI,UAAA;gBAAO,OAAA,IAAI;YAAJ,CAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;QAA3C,CAA2C,CAAC,CAAC;IAC7E,CAAC;IArHQ;QAAR,KAAK,EAAE;;0FAAyB;IACxB;QAAR,KAAK,EAAE;;kGAAwC;IAFpD;QARC,oBAAoB,EAAE;QACtB,SAAS,CAAC;YACP,QAAQ,EAAE,gCAAgC;YAC1C,QAAQ,EAAE,uqBAA6oB;YACvpB,MAAM,EAAE,CAAC,6dAA6d,CAAC;YACve,SAAS,EAAE,CAAC,QAAQ,CAAC;YACrB,eAAe,EAAE,uBAAuB,CAAC,MAAM;SAClD,CAAC;yCASiC,kBAAkB;YACrB,eAAe;YACV,mBAAmB;YACtB,gBAAgB;YACxB,QAAQ;YACb,iBAAiB;0DA0GrC;IAAD,yDAAC;CAAA,AAvHD,IAuHC\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/components/synchronize/components/pageSynchronizationHeader/PageSynchronizationHeaderComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnChanges } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { CmsitemsRestService, ISyncStatus } from 'cmscommons';\r\nimport { ICatalogService, ISharedDataService, L10nPipe } from 'smarteditcommons';\r\nimport { PageSyncConditions } from '../../types';\r\nexport declare class PageSynchronizationHeaderComponent implements OnChanges {\r\n    private sharedDataService;\r\n    private catalogService;\r\n    private cmsitemsRestService;\r\n    private translateService;\r\n    private l10nPipe;\r\n    private cdr;\r\n    syncStatus: ISyncStatus;\r\n    pageSyncConditions: PageSyncConditions;\r\n    ready: boolean;\r\n    headerText: string;\r\n    constructor(sharedDataService: ISharedDataService, catalogService: ICatalogService, cmsitemsRestService: CmsitemsRestService, translateService: TranslateService, l10nPipe: L10nPipe, cdr: ChangeDetectorRef);\r\n    ngOnChanges(): Promise<void>;\r\n    getSubHeaderText(): string;\r\n    isNewPage(): boolean;\r\n    isSyncOldHomeHeader(): boolean;\r\n    isDefaultSubHeader(): boolean;\r\n    private updateHeaderText;\r\n    private userIsInsidePage;\r\n    private getCurrentCatalogIdFromExperience;\r\n    private fetchUnavailableDependencies;\r\n}\r\n"}}
