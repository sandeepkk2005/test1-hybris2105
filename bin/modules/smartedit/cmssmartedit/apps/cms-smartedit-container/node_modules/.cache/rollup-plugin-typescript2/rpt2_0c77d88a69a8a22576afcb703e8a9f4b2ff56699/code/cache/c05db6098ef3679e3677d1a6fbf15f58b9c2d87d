{"code":"import { __awaiter, __decorate, __generator, __metadata } from \"tslib\";\r\nimport { ChangeDetectorRef, ChangeDetectionStrategy, Component, Input } from '@angular/core';\r\nimport { IPermissionService, SeDowngradeComponent, SmarteditRoutingService, SystemEventService } from 'smarteditcommons';\r\nimport { WORKFLOW_ITEM_MENU_OPENED_EVENT } from '../../constants';\r\nimport { WorkflowFacade } from '../../services/WorkflowFacade';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"WorkflowItemMenuComponent\", {\r\n    selector: 'se-workflow-item-menu',\r\n    template: \"<se-popup-overlay class=\\\"popup-anchor\\\" [ngClass]=\\\"{ 'popup-anchor--open': isMenuOpen }\\\" [popupOverlay]=\\\"popupConfig\\\" [popupOverlayTrigger]=\\\"isMenuOpen\\\" (popupOverlayOnHide)=\\\"hideMenu()\\\"><span *ngIf=\\\"menuItems.length > 0\\\" (click)=\\\"toggleMenu()\\\" class=\\\"workflow-item-menu__toggle-btn sap-icon--overflow\\\"></span><div se-popup-overlay-body><div class=\\\"workflow-item-menu\\\"><div class=\\\"workflow-item-menu__item\\\" *ngFor=\\\"let dropdownItem of menuItems\\\"><ng-container class=\\\"container\\\" [ngSwitch]=\\\"dropdownItem.i18nKey\\\"><div *ngSwitchCase=\\\"'se.cms.actionitem.page.workflow.description'\\\" class=\\\"workflow-description\\\"><div class=\\\"se-dropdown-item--label\\\"><div class=\\\"workflow-description__label fd-has-type-1 fd-has-margin-bottom-tiny\\\"><div [translate]=\\\"dropdownItem.i18nKey\\\"></div><div *seHasOperationPermission=\\\"'se.edit.workflow.workflowMenu'\\\"><a title=\\\"Edit\\\" class=\\\"workflow-description__edit-btn sap-icon--edit fd-has-float-right\\\" (click)=\\\"editDescription()\\\"></a></div></div><div *ngIf=\\\"workflowInfo.description; else noDescription\\\" class=\\\"workflow-description__text\\\">{{ workflowInfo.description }}</div><ng-template #noDescription><div translate=\\\"se.cms.actionitem.page.workflow.no.description\\\"></div></ng-template></div></div><div *ngSwitchCase=\\\"'se.cms.actionitem.page.workflow.cancel'\\\" class=\\\"workflow-cancel-btn fd-has-color-status-3\\\" [translate]=\\\"dropdownItem.i18nKey\\\" (click)=\\\"cancelWorkflow()\\\"></div></ng-container></div></div></div></se-popup-overlay>\",\r\n    styles: [\".popup-anchor{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.1428571429rem;line-height:1.25;font-weight:400;padding-top:5px;width:32px;height:32px;border-radius:4px}.popup-anchor--open{background-color:#eeeeef}.workflow-item-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;left:initial!important;right:0;transform:translate(5px,8px);right:-11px;top:-8px}.workflow-item-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:\\\"\\\";position:absolute;top:-8px}.workflow-item-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:\\\"\\\";position:absolute;top:-7px}.workflow-item-menu::after,.workflow-item-menu::before{right:10px}.workflow-item-menu::after,.workflow-item-menu::before{display:none}.workflow-description{min-width:225px;padding:20px}.workflow-description__label{color:#32363a;display:flex;justify-content:space-between}.workflow-description__label .sap-icon--edit{cursor:pointer}.workflow-description__label .sap-icon--edit:hover{text-decoration:none}.workflow-description__description{color:#51555a}.workflow-cancel-btn{cursor:pointer;padding:12px 20px;border-top:1px solid #fafafa}\"],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nvar /* @ngInject */ WorkflowItemMenuComponent = /** @class */ (function () {\r\n    function /* @ngInject */ WorkflowItemMenuComponent(systemEventService, workflowFacade, routingService, permissionService, cdr) {\r\n        this.systemEventService = systemEventService;\r\n        this.workflowFacade = workflowFacade;\r\n        this.routingService = routingService;\r\n        this.permissionService = permissionService;\r\n        this.cdr = cdr;\r\n        this.isMenuOpen = false;\r\n        this.popupConfig = {\r\n            halign: 'left',\r\n            valign: 'bottom'\r\n        };\r\n        this.menuItems = [];\r\n    }\r\n    /* @ngInject */ WorkflowItemMenuComponent.prototype.ngOnInit = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            var _this = this;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        this.unRegWorkflowMenuOpenedEvent = this.systemEventService.subscribe(WORKFLOW_ITEM_MENU_OPENED_EVENT, function (_eventId, eventData) {\r\n                            return _this.onWorkflowItemMenuOpen(eventData);\r\n                        });\r\n                        _a = this;\r\n                        return [4 /*yield*/, this.getPermittedButtons([\r\n                                {\r\n                                    i18nKey: 'se.cms.actionitem.page.workflow.description',\r\n                                    permissions: ['se.view.page.workflowMenu']\r\n                                },\r\n                                {\r\n                                    i18nKey: 'se.cms.actionitem.page.workflow.cancel',\r\n                                    permissions: ['se.cancel.page.workflowMenu']\r\n                                }\r\n                            ])];\r\n                    case 1:\r\n                        _a.menuItems = _b.sent();\r\n                        this.cdr.detectChanges();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ WorkflowItemMenuComponent.prototype.ngOnDestroy = function () {\r\n        this.unRegWorkflowMenuOpenedEvent();\r\n    };\r\n    /* @ngInject */ WorkflowItemMenuComponent.prototype.toggleMenu = function () {\r\n        this.isMenuOpen = !this.isMenuOpen;\r\n        if (this.isMenuOpen && this.workflowInfo) {\r\n            this.systemEventService.publishAsync(WORKFLOW_ITEM_MENU_OPENED_EVENT, {\r\n                uid: this.workflowInfo.workflowCode\r\n            });\r\n        }\r\n    };\r\n    /* @ngInject */ WorkflowItemMenuComponent.prototype.hideMenu = function () {\r\n        this.isMenuOpen = false;\r\n    };\r\n    /* @ngInject */ WorkflowItemMenuComponent.prototype.editDescription = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var updatedWorkflow;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.hideMenu();\r\n                        return [4 /*yield*/, this.workflowFacade.editWorkflow(this.workflowInfo)];\r\n                    case 1:\r\n                        updatedWorkflow = _a.sent();\r\n                        this.workflowInfo.description = updatedWorkflow.description;\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ WorkflowItemMenuComponent.prototype.cancelWorkflow = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.hideMenu();\r\n                        return [4 /*yield*/, this.workflowFacade.cancelWorflow(this.workflowInfo)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this.routingService.reload();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ WorkflowItemMenuComponent.prototype.onWorkflowItemMenuOpen = function (eventData) {\r\n        if (this.workflowInfo.workflowCode !== eventData.uid) {\r\n            this.hideMenu();\r\n            this.cdr.detectChanges();\r\n        }\r\n    };\r\n    /* @ngInject */ WorkflowItemMenuComponent.prototype.getPermittedButtons = function (menuItemsConfig) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var buttonsPermissions, permissions;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        buttonsPermissions = menuItemsConfig.map(function (menuItem) {\r\n                            return Promise.resolve(_this.permissionService.isPermitted([\r\n                                {\r\n                                    names: menuItem.permissions\r\n                                }\r\n                            ]));\r\n                        });\r\n                        return [4 /*yield*/, Promise.all(buttonsPermissions)];\r\n                    case 1:\r\n                        permissions = _a.sent();\r\n                        return [2 /*return*/, menuItemsConfig.filter(function (_menuItem, index) { return permissions[index]; })];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    __decorate([\r\n        Input(),\r\n        __metadata(\"design:type\", Object)\r\n    ], /* @ngInject */ WorkflowItemMenuComponent.prototype, \"workflowInfo\", void 0);\r\n    /* @ngInject */ WorkflowItemMenuComponent = __decorate([\r\n        SeDowngradeComponent(),\r\n        Component({\r\n            selector: 'se-workflow-item-menu',\r\n            template: \"<se-popup-overlay class=\\\"popup-anchor\\\" [ngClass]=\\\"{ 'popup-anchor--open': isMenuOpen }\\\" [popupOverlay]=\\\"popupConfig\\\" [popupOverlayTrigger]=\\\"isMenuOpen\\\" (popupOverlayOnHide)=\\\"hideMenu()\\\"><span *ngIf=\\\"menuItems.length > 0\\\" (click)=\\\"toggleMenu()\\\" class=\\\"workflow-item-menu__toggle-btn sap-icon--overflow\\\"></span><div se-popup-overlay-body><div class=\\\"workflow-item-menu\\\"><div class=\\\"workflow-item-menu__item\\\" *ngFor=\\\"let dropdownItem of menuItems\\\"><ng-container class=\\\"container\\\" [ngSwitch]=\\\"dropdownItem.i18nKey\\\"><div *ngSwitchCase=\\\"'se.cms.actionitem.page.workflow.description'\\\" class=\\\"workflow-description\\\"><div class=\\\"se-dropdown-item--label\\\"><div class=\\\"workflow-description__label fd-has-type-1 fd-has-margin-bottom-tiny\\\"><div [translate]=\\\"dropdownItem.i18nKey\\\"></div><div *seHasOperationPermission=\\\"'se.edit.workflow.workflowMenu'\\\"><a title=\\\"Edit\\\" class=\\\"workflow-description__edit-btn sap-icon--edit fd-has-float-right\\\" (click)=\\\"editDescription()\\\"></a></div></div><div *ngIf=\\\"workflowInfo.description; else noDescription\\\" class=\\\"workflow-description__text\\\">{{ workflowInfo.description }}</div><ng-template #noDescription><div translate=\\\"se.cms.actionitem.page.workflow.no.description\\\"></div></ng-template></div></div><div *ngSwitchCase=\\\"'se.cms.actionitem.page.workflow.cancel'\\\" class=\\\"workflow-cancel-btn fd-has-color-status-3\\\" [translate]=\\\"dropdownItem.i18nKey\\\" (click)=\\\"cancelWorkflow()\\\"></div></ng-container></div></div></div></se-popup-overlay>\",\r\n            styles: [\".popup-anchor{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.1428571429rem;line-height:1.25;font-weight:400;padding-top:5px;width:32px;height:32px;border-radius:4px}.popup-anchor--open{background-color:#eeeeef}.workflow-item-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;left:initial!important;right:0;transform:translate(5px,8px);right:-11px;top:-8px}.workflow-item-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:\\\"\\\";position:absolute;top:-8px}.workflow-item-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:\\\"\\\";position:absolute;top:-7px}.workflow-item-menu::after,.workflow-item-menu::before{right:10px}.workflow-item-menu::after,.workflow-item-menu::before{display:none}.workflow-description{min-width:225px;padding:20px}.workflow-description__label{color:#32363a;display:flex;justify-content:space-between}.workflow-description__label .sap-icon--edit{cursor:pointer}.workflow-description__label .sap-icon--edit:hover{text-decoration:none}.workflow-description__description{color:#51555a}.workflow-cancel-btn{cursor:pointer;padding:12px 20px;border-top:1px solid #fafafa}\"],\r\n            changeDetection: ChangeDetectionStrategy.OnPush\r\n        }),\r\n        __metadata(\"design:paramtypes\", [SystemEventService,\r\n            WorkflowFacade,\r\n            SmarteditRoutingService,\r\n            IPermissionService,\r\n            ChangeDetectorRef])\r\n    ], /* @ngInject */ WorkflowItemMenuComponent);\r\n    return /* @ngInject */ WorkflowItemMenuComponent;\r\n}());\r\nexport { /* @ngInject */ WorkflowItemMenuComponent };\r\n//# sourceMappingURL=WorkflowItemMenuComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/workflow/constants.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/workflow/dtos/index.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/workflow/services/WorkflowFacade.ts"],"map":"{\"version\":3,\"file\":\"WorkflowItemMenuComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/workflow/components/workflowItemMenu/WorkflowItemMenuComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/components/workflow/components/workflowItemMenu/WorkflowItemMenuComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnDestroy, OnInit } from '@angular/core';\r\nimport { IPermissionService, PopupOverlayConfig, SmarteditRoutingService, SystemEventService } from 'smarteditcommons';\r\nimport { Workflow } from '../../dtos';\r\nimport { WorkflowFacade } from '../../services/WorkflowFacade';\r\ninterface ButtonConfig {\r\n    i18nKey: string;\r\n    permissions?: string[];\r\n}\r\nexport interface WorkflowItemMenuOpenedEventData {\r\n    uid?: string;\r\n    code?: string;\r\n}\r\nexport declare class WorkflowItemMenuComponent implements OnInit, OnDestroy {\r\n    private systemEventService;\r\n    private workflowFacade;\r\n    private routingService;\r\n    private permissionService;\r\n    private cdr;\r\n    workflowInfo: Workflow;\r\n    isMenuOpen: boolean;\r\n    popupConfig: PopupOverlayConfig;\r\n    menuItems: ButtonConfig[];\r\n    private unRegWorkflowMenuOpenedEvent;\r\n    constructor(systemEventService: SystemEventService, workflowFacade: WorkflowFacade, routingService: SmarteditRoutingService, permissionService: IPermissionService, cdr: ChangeDetectorRef);\r\n    ngOnInit(): Promise<void>;\r\n    ngOnDestroy(): void;\r\n    toggleMenu(): void;\r\n    hideMenu(): void;\r\n    editDescription(): Promise<void>;\r\n    cancelWorkflow(): Promise<void>;\r\n    private onWorkflowItemMenuOpen;\r\n    private getPermittedButtons;\r\n}\r\nexport {};\r\n"}}
