{"code":"import { __awaiter, __decorate, __generator, __metadata, __param } from \"tslib\";\r\n/*\r\n * Copyright (c) 2021 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { Inject } from '@angular/core';\r\nimport { DRAG_AND_DROP_EVENTS } from 'cmscommons';\r\nimport { DragAndDropService, GatewayFactory, ID_ATTRIBUTE, ISharedDataService, SeDowngradeService, SystemEventService, TYPE_ATTRIBUTE, UUID_ATTRIBUTE, YJQUERY_TOKEN } from 'smarteditcommons';\r\nexport var ENABLE_CLONE_ON_DROP = 'enableCloneComponentOnDrop';\r\nvar /* @ngInject */ CmsDragAndDropService = /** @class */ (function () {\r\n    function /* @ngInject */ CmsDragAndDropService(dragAndDropService, gatewayFactory, sharedDataService, systemEventService, yjQuery) {\r\n        this.dragAndDropService = dragAndDropService;\r\n        this.gatewayFactory = gatewayFactory;\r\n        this.sharedDataService = sharedDataService;\r\n        this.systemEventService = systemEventService;\r\n        this.yjQuery = yjQuery;\r\n        this.gateway = this.gatewayFactory.createGateway('cmsDragAndDrop');\r\n    }\r\n    /* @ngInject */ CmsDragAndDropService_1 = /* @ngInject */ CmsDragAndDropService;\r\n    /* @ngInject */ CmsDragAndDropService.prototype.register = function () {\r\n        var _this = this;\r\n        this.dragAndDropService.register({\r\n            id: /* @ngInject */ CmsDragAndDropService_1.CMS_DRAG_AND_DROP_ID,\r\n            sourceSelector: /* @ngInject */ CmsDragAndDropService_1.SOURCE_SELECTOR,\r\n            targetSelector: /* @ngInject */ CmsDragAndDropService_1.TARGET_SELECTOR,\r\n            startCallback: function (event) { return _this.onStart(event); },\r\n            stopCallback: function () { return _this.onStop(); },\r\n            enableScrolling: false\r\n        });\r\n    };\r\n    /* @ngInject */ CmsDragAndDropService.prototype.unregister = function () {\r\n        this.dragAndDropService.unregister([/* @ngInject */ CmsDragAndDropService_1.CMS_DRAG_AND_DROP_ID]);\r\n    };\r\n    /* @ngInject */ CmsDragAndDropService.prototype.apply = function () {\r\n        this.dragAndDropService.apply(null);\r\n    };\r\n    /* @ngInject */ CmsDragAndDropService.prototype.update = function () {\r\n        this.dragAndDropService.update(/* @ngInject */ CmsDragAndDropService_1.CMS_DRAG_AND_DROP_ID);\r\n    };\r\n    /* @ngInject */ CmsDragAndDropService.prototype.onStart = function (event) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var cloneOnDrop, component, dragInfo;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.sharedDataService.get(ENABLE_CLONE_ON_DROP)];\r\n                    case 1:\r\n                        cloneOnDrop = _a.sent();\r\n                        component = this.getSelector(event.target).closest(/* @ngInject */ CmsDragAndDropService_1.COMPONENT_SELECTOR);\r\n                        dragInfo = {\r\n                            componentId: component.attr(ID_ATTRIBUTE),\r\n                            componentUuid: component.attr(UUID_ATTRIBUTE),\r\n                            componentType: component.attr(TYPE_ATTRIBUTE),\r\n                            slotUuid: null,\r\n                            slotId: null,\r\n                            cloneOnDrop: cloneOnDrop\r\n                        };\r\n                        this.gateway.publish(DRAG_AND_DROP_EVENTS.DRAG_STARTED, dragInfo);\r\n                        this.systemEventService.publishAsync(DRAG_AND_DROP_EVENTS.DRAG_STARTED);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ CmsDragAndDropService.prototype.onStop = function () {\r\n        this.gateway.publish(DRAG_AND_DROP_EVENTS.DRAG_STOPPED, null);\r\n    };\r\n    /* @ngInject */ CmsDragAndDropService.prototype.getSelector = function (selector) {\r\n        return this.yjQuery(selector);\r\n    };\r\n    var /* @ngInject */ CmsDragAndDropService_1;\r\n    /* @ngInject */ CmsDragAndDropService.CMS_DRAG_AND_DROP_ID = 'se.cms.dragAndDrop';\r\n    /* @ngInject */ CmsDragAndDropService.TARGET_SELECTOR = '';\r\n    /* @ngInject */ CmsDragAndDropService.SOURCE_SELECTOR = \".smartEditComponent[data-smartedit-component-type!='ContentSlot']\";\r\n    /* @ngInject */ CmsDragAndDropService.COMPONENT_SELECTOR = '.smartEditComponent';\r\n    /* @ngInject */ CmsDragAndDropService = /* @ngInject */ CmsDragAndDropService_1 = __decorate([\r\n        SeDowngradeService(),\r\n        __param(4, Inject(YJQUERY_TOKEN)),\r\n        __metadata(\"design:paramtypes\", [DragAndDropService,\r\n            GatewayFactory,\r\n            ISharedDataService,\r\n            SystemEventService, Function])\r\n    ], /* @ngInject */ CmsDragAndDropService);\r\n    return /* @ngInject */ CmsDragAndDropService;\r\n}());\r\nexport { /* @ngInject */ CmsDragAndDropService };\r\n//# sourceMappingURL=CmsDragAndDropServiceOuter.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"CmsDragAndDropServiceOuter.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/services/CmsDragAndDropServiceOuter.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/services/CmsDragAndDropServiceOuter.d.ts","writeByteOrderMark":false,"text":"/// <reference types=\"angular\" />\r\n/// <reference types=\"jquery\" />\r\nimport { DragAndDropService, GatewayFactory, ISharedDataService, SystemEventService } from 'smarteditcommons';\r\nexport declare const ENABLE_CLONE_ON_DROP = \"enableCloneComponentOnDrop\";\r\nexport declare class CmsDragAndDropService {\r\n    private dragAndDropService;\r\n    private gatewayFactory;\r\n    private sharedDataService;\r\n    private systemEventService;\r\n    private yjQuery;\r\n    private static readonly CMS_DRAG_AND_DROP_ID;\r\n    private static readonly TARGET_SELECTOR;\r\n    private static readonly SOURCE_SELECTOR;\r\n    private static readonly COMPONENT_SELECTOR;\r\n    private gateway;\r\n    constructor(dragAndDropService: DragAndDropService, gatewayFactory: GatewayFactory, sharedDataService: ISharedDataService, systemEventService: SystemEventService, yjQuery: JQueryStatic);\r\n    register(): void;\r\n    unregister(): void;\r\n    apply(): void;\r\n    update(): void;\r\n    private onStart;\r\n    private onStop;\r\n    private getSelector;\r\n}\r\n"}}
