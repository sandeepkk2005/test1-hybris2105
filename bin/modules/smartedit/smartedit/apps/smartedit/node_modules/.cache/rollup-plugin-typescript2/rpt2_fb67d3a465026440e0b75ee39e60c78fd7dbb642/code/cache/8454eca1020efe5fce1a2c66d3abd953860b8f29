{"code":"import { __decorate, __extends, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2021 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { GatewayProxied, IExperienceService, IPreviewService, LogService, SeDowngradeService, SmarteditRoutingService } from 'smarteditcommons';\r\n/** @internal */\r\nvar /* @ngInject */ ExperienceService = /** @class */ (function (_super) {\r\n    __extends(/* @ngInject */ ExperienceService, _super);\r\n    function /* @ngInject */ ExperienceService(routingService, logService, previewService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.routingService = routingService;\r\n        _this.logService = logService;\r\n        _this.previewService = previewService;\r\n        return _this;\r\n    }\r\n    /* @ngInject */ ExperienceService.prototype.buildRefreshedPreviewUrl = function () {\r\n        var _this = this;\r\n        return this.getCurrentExperience().then(function (experience) {\r\n            if (!experience) {\r\n                throw new Error('ExperienceService.buildRefreshedPreviewUrl() - Invalid experience from ExperienceService.getCurrentExperience()');\r\n            }\r\n            var promise = _this.previewService.getResourcePathFromPreviewUrl(experience.siteDescriptor.previewUrl);\r\n            return promise.then(function (resourcePath) {\r\n                var previewData = _this._convertExperienceToPreviewData(experience, resourcePath);\r\n                return _this.previewService.updateUrlWithNewPreviewTicketId(_this.routingService.absUrl(), previewData);\r\n            }, function (err) {\r\n                _this.logService.error('ExperienceService.buildRefreshedPreviewUrl() - failed to retrieve resource path');\r\n                return Promise.reject(err);\r\n            });\r\n        }, function (err) {\r\n            _this.logService.error('ExperienceService.buildRefreshedPreviewUrl() - failed to retrieve current experience');\r\n            return Promise.reject(err);\r\n        });\r\n    };\r\n    /* @ngInject */ ExperienceService = __decorate([\r\n        SeDowngradeService(IExperienceService),\r\n        GatewayProxied('loadExperience', 'updateExperiencePageContext', 'getCurrentExperience', 'setCurrentExperience', 'hasCatalogVersionChanged', 'buildRefreshedPreviewUrl', 'compareWithCurrentExperience'),\r\n        __metadata(\"design:paramtypes\", [SmarteditRoutingService,\r\n            LogService,\r\n            IPreviewService])\r\n    ], /* @ngInject */ ExperienceService);\r\n    return /* @ngInject */ ExperienceService;\r\n}(IExperienceService));\r\nexport { /* @ngInject */ ExperienceService };\r\n//# sourceMappingURL=ExperienceServiceInner.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"ExperienceServiceInner.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/services/ExperienceServiceInner.ts\"],\"names\":[],\"mappings\":\";AAAA;;GAEG;AACH,OAAO,EACH,cAAc,EAEd,kBAAkB,EAElB,eAAe,EACf,UAAU,EACV,kBAAkB,EAClB,uBAAuB,EAC1B,MAAM,kBAAkB,CAAC;AAE1B,gBAAgB;AAWhB;IAAuC,qDAAkB;IACrD,2CACY,cAAuC,EACvC,UAAsB,EACtB,cAA+B;QAH3C,YAKI,iBAAO,SACV;QALW,oBAAc,GAAd,cAAc,CAAyB;QACvC,gBAAU,GAAV,UAAU,CAAY;QACtB,oBAAc,GAAd,cAAc,CAAiB;;IAG3C,CAAC;IAED,oEAAwB,GAAxB;QAAA,iBAwCC;QAvCG,OAAO,IAAI,CAAC,oBAAoB,EAAE,CAAC,IAAI,CACnC,UAAC,UAAuB;YACpB,IAAI,CAAC,UAAU,EAAE;gBACb,MAAM,IAAI,KAAK,CACX,iHAAiH,CACpH,CAAC;aACL;YAED,IAAM,OAAO,GAAG,KAAI,CAAC,cAAc,CAAC,6BAA6B,CAC7D,UAAU,CAAC,cAAc,CAAC,UAAU,CACvC,CAAC;YAEF,OAAO,OAAO,CAAC,IAAI,CACf,UAAC,YAAoB;gBACjB,IAAM,WAAW,GAAiB,KAAI,CAAC,+BAA+B,CAClE,UAAU,EACV,YAAY,CACf,CAAC;gBAEF,OAAO,KAAI,CAAC,cAAc,CAAC,+BAA+B,CACtD,KAAI,CAAC,cAAc,CAAC,MAAM,EAAE,EAC5B,WAAW,CACd,CAAC;YACN,CAAC,EACD,UAAC,GAAQ;gBACL,KAAI,CAAC,UAAU,CAAC,KAAK,CACjB,iFAAiF,CACpF,CAAC;gBACF,OAAO,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;YAC/B,CAAC,CACJ,CAAC;QACN,CAAC,EACD,UAAC,GAAQ;YACL,KAAI,CAAC,UAAU,CAAC,KAAK,CACjB,sFAAsF,CACzF,CAAC;YACF,OAAO,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QAC/B,CAAC,CACJ,CAAC;IACN,CAAC;IAjDL;QAVC,kBAAkB,CAAC,kBAAkB,CAAC;QACtC,cAAc,CACX,gBAAgB,EAChB,6BAA6B,EAC7B,sBAAsB,EACtB,sBAAsB,EACtB,0BAA0B,EAC1B,0BAA0B,EAC1B,8BAA8B,CACjC;yCAG+B,uBAAuB;YAC3B,UAAU;YACN,eAAe;yCA8C9C;IAAD,wCAAC;CAAA,AAlDD,CAAuC,kBAAkB,GAkDxD\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit/services/ExperienceServiceInner.d.ts","writeByteOrderMark":false,"text":"import { IExperienceService, IPreviewService, LogService, SmarteditRoutingService } from 'smarteditcommons';\r\n/** @internal */\r\nexport declare class ExperienceService extends IExperienceService {\r\n    private routingService;\r\n    private logService;\r\n    private previewService;\r\n    constructor(routingService: SmarteditRoutingService, logService: LogService, previewService: IPreviewService);\r\n    buildRefreshedPreviewUrl(): Promise<string>;\r\n}\r\n"}}
