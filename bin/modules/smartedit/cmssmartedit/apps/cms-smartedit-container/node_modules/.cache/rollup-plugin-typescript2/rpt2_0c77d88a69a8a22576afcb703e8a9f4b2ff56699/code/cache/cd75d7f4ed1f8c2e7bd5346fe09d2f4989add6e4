{"code":"import { __awaiter, __decorate, __generator, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2021 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { PAGES_LIST_RESOURCE_URI } from 'cmscommons';\r\nimport { ICatalogService, ISharedDataService, PRODUCT_LIST_RESOURCE_API, PRODUCT_RESOURCE_API, SeDowngradeService, EXPERIENCE_STORAGE_KEY } from 'smarteditcommons';\r\nimport { PRODUCT_CATEGORY_RESOURCE_BASE_URI, PRODUCT_CATEGORY_SEARCH_RESOURCE_URI } from './ProductCategoryService';\r\n/** Used to determine an URI for fetching the data for Dropdown Populators. */\r\nvar /* @ngInject */ ContextAwareCatalogService = /** @class */ (function () {\r\n    function /* @ngInject */ ContextAwareCatalogService(catalogService, sharedDataService) {\r\n        this.catalogService = catalogService;\r\n        this.sharedDataService = sharedDataService;\r\n    }\r\n    /* @ngInject */ ContextAwareCatalogService.prototype.getProductCategorySearchUri = function (productCatalogId) {\r\n        return this.getSearchUriByProductCatalogIdAndUriConstant(productCatalogId, PRODUCT_CATEGORY_SEARCH_RESOURCE_URI);\r\n    };\r\n    /* @ngInject */ ContextAwareCatalogService.prototype.getProductCategoryItemUri = function () {\r\n        return this.getItemUriByUriConstant(PRODUCT_CATEGORY_RESOURCE_BASE_URI);\r\n    };\r\n    /* @ngInject */ ContextAwareCatalogService.prototype.getProductSearchUri = function (productCatalogId) {\r\n        return this.getSearchUriByProductCatalogIdAndUriConstant(productCatalogId, PRODUCT_LIST_RESOURCE_API);\r\n    };\r\n    /* @ngInject */ ContextAwareCatalogService.prototype.getProductItemUri = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var uri;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.getItemUriByUriConstant(PRODUCT_RESOURCE_API)];\r\n                    case 1:\r\n                        uri = _a.sent();\r\n                        return [2 /*return*/, uri.replace('/:productUID', '')];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ ContextAwareCatalogService.prototype.getContentPageSearchUri = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var uri;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.getContentPageUri()];\r\n                    case 1:\r\n                        uri = _a.sent();\r\n                        return [2 /*return*/, uri + \"?typeCode=ContentPage\"];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ ContextAwareCatalogService.prototype.getContentPageItemUri = function () {\r\n        return this.getContentPageUri();\r\n    };\r\n    /* @ngInject */ ContextAwareCatalogService.prototype.getSearchUriByProductCatalogIdAndUriConstant = function (productCatalogId, uriConstant) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var catalogVersion;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.catalogService.getActiveProductCatalogVersionByCatalogId(productCatalogId)];\r\n                    case 1:\r\n                        catalogVersion = _a.sent();\r\n                        return [2 /*return*/, uriConstant\r\n                                .replace(/:catalogId/gi, productCatalogId)\r\n                                .replace(/:catalogVersion/gi, catalogVersion)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ ContextAwareCatalogService.prototype.getItemUriByUriConstant = function (uriConstant) {\r\n        return Promise.resolve(uriConstant.replace(/:siteUID/gi, 'CURRENT_CONTEXT_SITE_ID'));\r\n    };\r\n    /* @ngInject */ ContextAwareCatalogService.prototype.getContentPageUri = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var catalogId, catalogVersion;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.sharedDataService.get(EXPERIENCE_STORAGE_KEY)];\r\n                    case 1:\r\n                        catalogId = (_a.sent()).catalogDescriptor.catalogId;\r\n                        return [4 /*yield*/, this.catalogService.getActiveContentCatalogVersionByCatalogId(catalogId)];\r\n                    case 2:\r\n                        catalogVersion = _a.sent();\r\n                        return [2 /*return*/, PAGES_LIST_RESOURCE_URI.replace(/CURRENT_CONTEXT_CATALOG/gi, catalogId).replace(/CURRENT_CONTEXT_CATALOG_VERSION/gi, catalogVersion)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ ContextAwareCatalogService = __decorate([\r\n        SeDowngradeService(),\r\n        __metadata(\"design:paramtypes\", [ICatalogService,\r\n            ISharedDataService])\r\n    ], /* @ngInject */ ContextAwareCatalogService);\r\n    return /* @ngInject */ ContextAwareCatalogService;\r\n}());\r\nexport { /* @ngInject */ ContextAwareCatalogService };\r\n//# sourceMappingURL=ContextAwareCatalogService.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/ProductCategoryService.ts"],"map":"{\"version\":3,\"file\":\"ContextAwareCatalogService.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/services/ContextAwareCatalogService.ts\"],\"names\":[],\"mappings\":\";AAAA;;GAEG;AACH,OAAO,EAAE,uBAAuB,EAAE,MAAM,YAAY,CAAC;AACrD,OAAO,EACH,eAAe,EAEf,kBAAkB,EAClB,yBAAyB,EACzB,oBAAoB,EACpB,kBAAkB,EAClB,sBAAsB,EACzB,MAAM,kBAAkB,CAAC;AAC1B,OAAO,EACH,kCAAkC,EAClC,oCAAoC,EACvC,MAAM,0BAA0B,CAAC;AAElC,8EAA8E;AAE9E;IACI,oDACY,cAA+B,EAC/B,iBAAqC;QADrC,mBAAc,GAAd,cAAc,CAAiB;QAC/B,sBAAiB,GAAjB,iBAAiB,CAAoB;IAC9C,CAAC;IAEG,gFAA2B,GAAlC,UAAmC,gBAAwB;QACvD,OAAO,IAAI,CAAC,4CAA4C,CACpD,gBAAgB,EAChB,oCAAoC,CACvC,CAAC;IACN,CAAC;IAEM,8EAAyB,GAAhC;QACI,OAAO,IAAI,CAAC,uBAAuB,CAAC,kCAAkC,CAAC,CAAC;IAC5E,CAAC;IAEM,wEAAmB,GAA1B,UAA2B,gBAAwB;QAC/C,OAAO,IAAI,CAAC,4CAA4C,CACpD,gBAAgB,EAChB,yBAAyB,CAC5B,CAAC;IACN,CAAC;IAEY,sEAAiB,GAA9B;;;;;4BACgB,qBAAM,IAAI,CAAC,uBAAuB,CAAC,oBAAoB,CAAC,EAAA;;wBAA9D,GAAG,GAAG,SAAwD;wBAEpE,sBAAO,GAAG,CAAC,OAAO,CAAC,cAAc,EAAE,EAAE,CAAC,EAAC;;;;KAC1C;IAEY,4EAAuB,GAApC;;;;;4BACgB,qBAAM,IAAI,CAAC,iBAAiB,EAAE,EAAA;;wBAApC,GAAG,GAAG,SAA8B;wBAE1C,sBAAU,GAAG,0BAAuB,EAAC;;;;KACxC;IAEM,0EAAqB,GAA5B;QACI,OAAO,IAAI,CAAC,iBAAiB,EAAE,CAAC;IACpC,CAAC;IAEa,iGAA4C,GAA1D,UACI,gBAAwB,EACxB,WAAmB;;;;;4BAEI,qBAAM,IAAI,CAAC,cAAc,CAAC,yCAAyC,CACtF,gBAAgB,CACnB,EAAA;;wBAFK,cAAc,GAAG,SAEtB;wBAED,sBAAO,WAAW;iCACb,OAAO,CAAC,cAAc,EAAE,gBAAgB,CAAC;iCACzC,OAAO,CAAC,mBAAmB,EAAE,cAAc,CAAC,EAAC;;;;KACrD;IAEO,4EAAuB,GAA/B,UAAgC,WAAmB;QAC/C,OAAO,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,YAAY,EAAE,yBAAyB,CAAC,CAAC,CAAC;IACzF,CAAC;IAEa,sEAAiB,GAA/B;;;;;4BAGS,qBAAM,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,sBAAsB,CAAC,EAAA;;wBADpC,SAAS,GAC9B,CAAC,SAAwD,CAAgB,4BAD3C;wBAGX,qBAAM,IAAI,CAAC,cAAc,CAAC,yCAAyC,CACtF,SAAS,CACZ,EAAA;;wBAFK,cAAc,GAAG,SAEtB;wBAED,sBAAO,uBAAuB,CAAC,OAAO,CAAC,2BAA2B,EAAE,SAAS,CAAC,CAAC,OAAO,CAClF,mCAAmC,EACnC,cAAc,CACjB,EAAC;;;;KACL;IAtEL;QADC,kBAAkB,EAAE;yCAGW,eAAe;YACZ,kBAAkB;kDAoEpD;IAAD,iDAAC;CAAA,AAvED,IAuEC\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/services/ContextAwareCatalogService.d.ts","writeByteOrderMark":false,"text":"import { ICatalogService, ISharedDataService } from 'smarteditcommons';\r\n/** Used to determine an URI for fetching the data for Dropdown Populators. */\r\nexport declare class ContextAwareCatalogService {\r\n    private catalogService;\r\n    private sharedDataService;\r\n    constructor(catalogService: ICatalogService, sharedDataService: ISharedDataService);\r\n    getProductCategorySearchUri(productCatalogId: string): Promise<string>;\r\n    getProductCategoryItemUri(): Promise<string>;\r\n    getProductSearchUri(productCatalogId: string): Promise<string>;\r\n    getProductItemUri(): Promise<string>;\r\n    getContentPageSearchUri(): Promise<string>;\r\n    getContentPageItemUri(): Promise<string>;\r\n    private getSearchUriByProductCatalogIdAndUriConstant;\r\n    private getItemUriByUriConstant;\r\n    private getContentPageUri;\r\n}\r\n"}}
