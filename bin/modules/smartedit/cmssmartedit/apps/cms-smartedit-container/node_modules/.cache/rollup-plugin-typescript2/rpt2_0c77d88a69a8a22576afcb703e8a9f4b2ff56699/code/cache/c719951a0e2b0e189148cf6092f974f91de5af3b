{"code":"import { __awaiter, __decorate, __generator, __metadata, __param } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\r\nimport { WORKFLOW_CREATED_EVENT } from 'cmscommons';\r\nimport { SeDowngradeComponent, SystemEventService, TOOLBAR_ITEM } from 'smarteditcommons';\r\nimport { CMS_EVENT_OPEN_WORKFLOW_INBOX_DROPDOWN, WORKFLOW_TASKS_MENU_OPENED_EVENT } from '../../constants';\r\nimport { WorkflowFacade, WorkflowTasksPollingService } from '../../services';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"WorkflowInboxComponent\", {\r\n    selector: 'se-workflow-inbox',\r\n    template: \"<fd-popover class=\\\"toolbar-action se-workflow-inbox-container dropdown\\\" [class.open]=\\\"actionItem.isOpen\\\" [(isOpen)]=\\\"actionItem.isOpen\\\" (isOpenChange)=\\\"onDropdownToggle(isOpen)\\\" [closeOnOutsideClick]=\\\"true\\\" [triggers]=\\\"['click']\\\" [placement]=\\\"'bottom-' + actionItem.dropdownPosition\\\"><fd-popover-control class=\\\"se-workflow-inbox-toggle-control\\\"><button type=\\\"button\\\" class=\\\"se-workflow-inbox-toggle toolbar-action--button--compact\\\" [attr.aria-pressed]=\\\"actionItem.isOpen\\\"><span class=\\\"se-toolbar-actions__icon sap-icon--task\\\"></span><se-workflow-inbox-badge></se-workflow-inbox-badge></button></fd-popover-control><fd-popover-body><div [ngClass]=\\\"{\\n                'se-toolbar__dropdown--right': actionItem.dropdownPosition === 'right',\\n                'se-toolbar__dropdown--center': actionItem.dropdownPosition === 'center',\\n                'se-toolbar__dropdown--left': actionItem.dropdownPosition === 'left'\\n            }\\\" class=\\\"toolbar-action--include--compact\\\"><div *ngIf=\\\"actionItem.isOpen\\\" class=\\\"se-workflow-inbox\\\"><div class=\\\"se-workflow-inbox\\\"><div class=\\\"se-workflow-inbox-header\\\"><div class=\\\"se-workflow-inbox-header__title\\\" [translate]=\\\"'se.cms.workflow.toolbar.inbox'\\\"></div></div><div class=\\\"se-workflow-inbox-tasks se-cms-dev-workflow-inbox-tasks fd-panel__body\\\"><div *ngIf=\\\"!tasksNotReady && totalNumberOfTasks === 0\\\" class=\\\"se-workflow-inbox-tasks__no-tasks\\\"><img src=\\\"static-resources/images/Inbox.svg\\\" alt=\\\"empty-inbox\\\"/> <span class=\\\"se-workflow-inbox__empty-inbox-message\\\" [translate]=\\\"'se.cms.workflow.toolbar.inbox.emptyinbox.message'\\\"></span> <span class=\\\"se-workflow-inbox__empty-inbox-message-alt\\\" [translate]=\\\"'se.cms.workflow.toolbar.inbox.emptyinbox.message.alt'\\\"></span></div><se-infinite-scrolling class=\\\"se-version-panel__infinite-scroll se-infinite-scrolling--narrowed\\\" [pageSize]=\\\"pageSize\\\" [fetchPage]=\\\"fetchPageOfInboxTasks\\\" (itemsChange)=\\\"onInboxTasksLoaded($event)\\\"><div *ngFor=\\\"let task of workflowTasks; let i = index; let last = last; trackBy: trackByIndex\\\" class=\\\"se-workflow-inbox-task se-cms-dev-workflow-inbox-task\\\"><se-workflow-inbox-task id=\\\"workflow-inbox-task-{{i}}\\\" [class.se-workflow-inbox-task-last]=\\\"last\\\" [task]=\\\"task\\\"></se-workflow-inbox-task></div></se-infinite-scrolling></div></div></div></div></fd-popover-body></fd-popover>\",\r\n    styles: [\".se-workflow-inbox-toggle{outline:0}.se-workflow-inbox-header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px;padding-top:15px;height:48px;font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a;border-bottom:1px solid #d9d9d9;padding:10px 0 15px 20px;height:46px}.se-workflow-inbox-header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-workflow-inbox-tasks{padding:16px 0 8px;width:280px}.se-workflow-inbox-tasks__no-tasks{display:flex;flex-direction:column;align-items:center}.se-workflow-inbox__empty-inbox-message{color:#51555a;padding:8px 0 4px}.se-workflow-inbox__empty-inbox-message-alt{font-size:13px;color:#6a6d70;padding-bottom:30px}\"],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nvar /* @ngInject */ WorkflowInboxComponent = /** @class */ (function () {\r\n    function /* @ngInject */ WorkflowInboxComponent(workflowFacade, systemEventService, workflowTasksPollingService, actionItem, cdr) {\r\n        var _this = this;\r\n        this.workflowFacade = workflowFacade;\r\n        this.systemEventService = systemEventService;\r\n        this.workflowTasksPollingService = workflowTasksPollingService;\r\n        this.actionItem = actionItem;\r\n        this.cdr = cdr;\r\n        this.pageSize = 10;\r\n        this.workflowTasks = [];\r\n        this.fetchPageOfInboxTasks = function (search, pageSize, currentPage) { return _this.loadInboxTasks(search, pageSize, currentPage); };\r\n    }\r\n    /* @ngInject */ WorkflowInboxComponent.prototype.ngOnInit = function () {\r\n        var _this = this;\r\n        this.tasksNotReady = true;\r\n        this.unRegisterOpenDropdownEvent = this.systemEventService.subscribe(CMS_EVENT_OPEN_WORKFLOW_INBOX_DROPDOWN, function () { return _this.openDropdown(); });\r\n        this.unRegisterWorkflowCreatedEvent = this.systemEventService.subscribe(WORKFLOW_CREATED_EVENT, function () { return _this.loadInboxTasks('', _this.pageSize, 0); });\r\n        this.unRegWorkflowTasksMenuOpenedEvent = this.systemEventService.subscribe(WORKFLOW_TASKS_MENU_OPENED_EVENT, function () { return _this.hideDropdown(); });\r\n    };\r\n    /* @ngInject */ WorkflowInboxComponent.prototype.ngOnDestroy = function () {\r\n        this.workflowTasksPollingService.stopPolling();\r\n        this.unRegisterOpenDropdownEvent();\r\n        this.unRegisterWorkflowCreatedEvent();\r\n        this.unRegWorkflowTasksMenuOpenedEvent();\r\n    };\r\n    /* @ngInject */ WorkflowInboxComponent.prototype.loadInboxTasks = function (mask, pageSize, currentPage) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var page;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.workflowFacade.getWorkflowInboxTasks({\r\n                            currentPage: currentPage,\r\n                            mask: mask,\r\n                            pageSize: pageSize\r\n                        })];\r\n                    case 1:\r\n                        page = _a.sent();\r\n                        this.tasksNotReady = false;\r\n                        this.totalNumberOfTasks = page.pagination.totalCount;\r\n                        this.workflowFacade.updateWorkflowTasksCount(this.totalNumberOfTasks);\r\n                        this.cdr.detectChanges();\r\n                        return [2 /*return*/, page];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ WorkflowInboxComponent.prototype.onInboxTasksLoaded = function (workflowTasks) {\r\n        this.workflowTasks = workflowTasks;\r\n    };\r\n    /* @ngInject */ WorkflowInboxComponent.prototype.onDropdownToggle = function (isOpen) {\r\n        if (isOpen) {\r\n            this.workflowTasksPollingService.stopPolling();\r\n            return;\r\n        }\r\n        this.workflowTasksPollingService.startPolling();\r\n        this.tasksNotReady = true;\r\n    };\r\n    /* @ngInject */ WorkflowInboxComponent.prototype.trackByIndex = function (index) {\r\n        return index;\r\n    };\r\n    /* @ngInject */ WorkflowInboxComponent.prototype.openDropdown = function () {\r\n        this.actionItem.isOpen = true;\r\n        this.cdr.detectChanges();\r\n    };\r\n    /* @ngInject */ WorkflowInboxComponent.prototype.hideDropdown = function () {\r\n        this.actionItem.isOpen = false;\r\n        this.cdr.detectChanges();\r\n    };\r\n    /* @ngInject */ WorkflowInboxComponent = __decorate([\r\n        SeDowngradeComponent(),\r\n        Component({\r\n            selector: 'se-workflow-inbox',\r\n            template: \"<fd-popover class=\\\"toolbar-action se-workflow-inbox-container dropdown\\\" [class.open]=\\\"actionItem.isOpen\\\" [(isOpen)]=\\\"actionItem.isOpen\\\" (isOpenChange)=\\\"onDropdownToggle(isOpen)\\\" [closeOnOutsideClick]=\\\"true\\\" [triggers]=\\\"['click']\\\" [placement]=\\\"'bottom-' + actionItem.dropdownPosition\\\"><fd-popover-control class=\\\"se-workflow-inbox-toggle-control\\\"><button type=\\\"button\\\" class=\\\"se-workflow-inbox-toggle toolbar-action--button--compact\\\" [attr.aria-pressed]=\\\"actionItem.isOpen\\\"><span class=\\\"se-toolbar-actions__icon sap-icon--task\\\"></span><se-workflow-inbox-badge></se-workflow-inbox-badge></button></fd-popover-control><fd-popover-body><div [ngClass]=\\\"{\\n                'se-toolbar__dropdown--right': actionItem.dropdownPosition === 'right',\\n                'se-toolbar__dropdown--center': actionItem.dropdownPosition === 'center',\\n                'se-toolbar__dropdown--left': actionItem.dropdownPosition === 'left'\\n            }\\\" class=\\\"toolbar-action--include--compact\\\"><div *ngIf=\\\"actionItem.isOpen\\\" class=\\\"se-workflow-inbox\\\"><div class=\\\"se-workflow-inbox\\\"><div class=\\\"se-workflow-inbox-header\\\"><div class=\\\"se-workflow-inbox-header__title\\\" [translate]=\\\"'se.cms.workflow.toolbar.inbox'\\\"></div></div><div class=\\\"se-workflow-inbox-tasks se-cms-dev-workflow-inbox-tasks fd-panel__body\\\"><div *ngIf=\\\"!tasksNotReady && totalNumberOfTasks === 0\\\" class=\\\"se-workflow-inbox-tasks__no-tasks\\\"><img src=\\\"static-resources/images/Inbox.svg\\\" alt=\\\"empty-inbox\\\"/> <span class=\\\"se-workflow-inbox__empty-inbox-message\\\" [translate]=\\\"'se.cms.workflow.toolbar.inbox.emptyinbox.message'\\\"></span> <span class=\\\"se-workflow-inbox__empty-inbox-message-alt\\\" [translate]=\\\"'se.cms.workflow.toolbar.inbox.emptyinbox.message.alt'\\\"></span></div><se-infinite-scrolling class=\\\"se-version-panel__infinite-scroll se-infinite-scrolling--narrowed\\\" [pageSize]=\\\"pageSize\\\" [fetchPage]=\\\"fetchPageOfInboxTasks\\\" (itemsChange)=\\\"onInboxTasksLoaded($event)\\\"><div *ngFor=\\\"let task of workflowTasks; let i = index; let last = last; trackBy: trackByIndex\\\" class=\\\"se-workflow-inbox-task se-cms-dev-workflow-inbox-task\\\"><se-workflow-inbox-task id=\\\"workflow-inbox-task-{{i}}\\\" [class.se-workflow-inbox-task-last]=\\\"last\\\" [task]=\\\"task\\\"></se-workflow-inbox-task></div></se-infinite-scrolling></div></div></div></div></fd-popover-body></fd-popover>\",\r\n            styles: [\".se-workflow-inbox-toggle{outline:0}.se-workflow-inbox-header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px;padding-top:15px;height:48px;font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a;border-bottom:1px solid #d9d9d9;padding:10px 0 15px 20px;height:46px}.se-workflow-inbox-header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-workflow-inbox-tasks{padding:16px 0 8px;width:280px}.se-workflow-inbox-tasks__no-tasks{display:flex;flex-direction:column;align-items:center}.se-workflow-inbox__empty-inbox-message{color:#51555a;padding:8px 0 4px}.se-workflow-inbox__empty-inbox-message-alt{font-size:13px;color:#6a6d70;padding-bottom:30px}\"],\r\n            changeDetection: ChangeDetectionStrategy.OnPush\r\n        }),\r\n        __param(3, Inject(TOOLBAR_ITEM)),\r\n        __metadata(\"design:paramtypes\", [WorkflowFacade,\r\n            SystemEventService,\r\n            WorkflowTasksPollingService, Object, ChangeDetectorRef])\r\n    ], /* @ngInject */ WorkflowInboxComponent);\r\n    return /* @ngInject */ WorkflowInboxComponent;\r\n}());\r\nexport { /* @ngInject */ WorkflowInboxComponent };\r\n//# sourceMappingURL=WorkflowInboxComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/workflow/constants.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/workflow/dtos/index.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/workflow/services/index.ts"],"map":"{\"version\":3,\"file\":\"WorkflowInboxComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/workflow/components/workflowInbox/WorkflowInboxComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/components/workflow/components/workflowInbox/WorkflowInboxComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnDestroy, OnInit } from '@angular/core';\r\nimport { FetchPageStrategy, Page, SystemEventService, ToolbarItemInternal } from 'smarteditcommons';\r\nimport { WorkflowTask } from '../../dtos';\r\nimport { WorkflowFacade, WorkflowTasksPollingService } from '../../services';\r\nexport declare class WorkflowInboxComponent implements OnInit, OnDestroy {\r\n    private workflowFacade;\r\n    private systemEventService;\r\n    private workflowTasksPollingService;\r\n    actionItem: ToolbarItemInternal;\r\n    private cdr;\r\n    pageSize: number;\r\n    tasksNotReady: boolean;\r\n    totalNumberOfTasks: number;\r\n    workflowTasks: WorkflowTask[];\r\n    private unRegisterOpenDropdownEvent;\r\n    private unRegisterWorkflowCreatedEvent;\r\n    private unRegWorkflowTasksMenuOpenedEvent;\r\n    constructor(workflowFacade: WorkflowFacade, systemEventService: SystemEventService, workflowTasksPollingService: WorkflowTasksPollingService, actionItem: ToolbarItemInternal, cdr: ChangeDetectorRef);\r\n    ngOnInit(): void;\r\n    ngOnDestroy(): void;\r\n    fetchPageOfInboxTasks: FetchPageStrategy<WorkflowTask>;\r\n    loadInboxTasks(mask: string, pageSize: number, currentPage: number): Promise<Page<WorkflowTask>>;\r\n    onInboxTasksLoaded(workflowTasks: WorkflowTask[]): void;\r\n    onDropdownToggle(isOpen: boolean): void;\r\n    trackByIndex(index: number): number;\r\n    private openDropdown;\r\n    private hideDropdown;\r\n}\r\n"}}
