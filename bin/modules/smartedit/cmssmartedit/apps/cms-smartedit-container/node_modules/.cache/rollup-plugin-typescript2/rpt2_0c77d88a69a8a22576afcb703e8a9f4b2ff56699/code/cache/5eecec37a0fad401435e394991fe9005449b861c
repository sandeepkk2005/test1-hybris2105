{"code":"import { __awaiter, __decorate, __generator, __metadata, __param } from \"tslib\";\r\nimport { Component, Inject } from '@angular/core';\r\nimport { CmsitemsRestService, CMSPageStatus, EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV } from 'cmscommons';\r\nimport { ManagePageService } from 'cmssmarteditcontainer/services/pages/ManagePageService';\r\nimport { CrossFrameEventService, DROPDOWN_MENU_ITEM_DATA, ICatalogService, SeDowngradeComponent } from 'smarteditcommons';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"PermanentlyDeletePageItemComponent\", {\r\n    selector: 'se-permanently-delete-page-item',\r\n    template: \"<div *seHasOperationPermission=\\\"permanentlyDeletePagePermission\\\"><div class=\\\"se-dropdown-item__delete-wrapper\\\"><div class=\\\"se-dropdown-item__delete-link-wrapper\\\" [ngClass]=\\\"{'se-dropdown-item__delete-link-wrapper--disabled': isDeleteButtonDisabled()}\\\"><a class=\\\"se-dropdown-item se-dropdown-item__delete fd-menu__item\\\" [ngClass]=\\\"{'se-dropdown-item--disabled': isDeleteButtonDisabled()}\\\" (click)=\\\"permanentlyDelete()\\\"><span [translate]=\\\"'se.cms.actionitem.page.permanently.delete'\\\"></span></a></div><se-tooltip class=\\\"se-dropdown-item__delete-page-popover\\\" *ngIf=\\\"isDeleteButtonDisabled()\\\" [placement]=\\\"'left'\\\" [triggers]=\\\"['mouseenter', 'mouseleave']\\\" [isChevronVisible]=\\\"true\\\" [appendTo]=\\\"'body'\\\"><span se-tooltip-trigger class=\\\"sap-icon--message-error\\\"></span> <span se-tooltip-body [translate]=\\\"'se.cms.actionitem.page.permanently.delete.blocked'\\\"></span></se-tooltip></div></div>\",\r\n    styles: [\".se-dropdown-item__delete-wrapper{display:flex;flex-direction:row;align-items:center;width:100%}.se-dropdown-item__delete-page-popover{margin-right:16px}.se-dropdown-item__delete-page-popover .sap-icon--message-error{color:#0a6ed1}.se-dropdown-item__delete-link-wrapper{width:100%}.se-dropdown-item__delete-link-wrapper--disabled{cursor:not-allowed}\"]\r\n});\r\nvar /* @ngInject */ PermanentlyDeletePageItemComponent = /** @class */ (function () {\r\n    function /* @ngInject */ PermanentlyDeletePageItemComponent(managePageService, cmsitemsRestService, catalogService, crossFrameEventService, dropdownMenuData) {\r\n        this.managePageService = managePageService;\r\n        this.cmsitemsRestService = cmsitemsRestService;\r\n        this.catalogService = catalogService;\r\n        this.crossFrameEventService = crossFrameEventService;\r\n        this.dropdownMenuData = dropdownMenuData;\r\n        this.isDeletable = false;\r\n    }\r\n    /* @ngInject */ PermanentlyDeletePageItemComponent.prototype.ngOnInit = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.pageInfo = this.dropdownMenuData.selectedItem;\r\n                        this.permanentlyDeletePagePermission = [\r\n                            {\r\n                                names: ['se.permanently.delete.page.type'],\r\n                                context: {\r\n                                    typeCode: this.pageInfo.typeCode\r\n                                }\r\n                            }\r\n                        ];\r\n                        this.unregPageSyncStatusUpdate = this.crossFrameEventService.subscribe(EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV, this.fetchPageDeletableConditions.bind(this));\r\n                        return [4 /*yield*/, this.fetchPageDeletableConditions()];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ PermanentlyDeletePageItemComponent.prototype.ngOnDestroy = function () {\r\n        this.unregPageSyncStatusUpdate();\r\n    };\r\n    /* @ngInject */ PermanentlyDeletePageItemComponent.prototype.permanentlyDelete = function () {\r\n        if (this.isDeletable) {\r\n            this.managePageService.hardDeletePage(this.pageInfo);\r\n        }\r\n    };\r\n    /* @ngInject */ PermanentlyDeletePageItemComponent.prototype.isDeleteButtonDisabled = function () {\r\n        return !this.isDeletable;\r\n    };\r\n    /* @ngInject */ PermanentlyDeletePageItemComponent.prototype.fetchPageDeletableConditions = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var uriContext, activeVersion, cmsItemResult;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.catalogService.retrieveUriContext()];\r\n                    case 1:\r\n                        uriContext = _a.sent();\r\n                        return [4 /*yield*/, this.catalogService.getContentCatalogActiveVersion(uriContext)];\r\n                    case 2:\r\n                        activeVersion = _a.sent();\r\n                        return [4 /*yield*/, this.cmsitemsRestService.get({\r\n                                pageSize: 1,\r\n                                currentPage: 0,\r\n                                typeCode: 'AbstractPage',\r\n                                fields: 'BASIC',\r\n                                itemSearchParams: \"uid:\" + this.pageInfo.uid,\r\n                                catalogId: uriContext.CURRENT_CONTEXT_CATALOG,\r\n                                catalogVersion: activeVersion\r\n                            })];\r\n                    case 3:\r\n                        cmsItemResult = _a.sent();\r\n                        this.isDeletable =\r\n                            cmsItemResult.pagination.totalCount === 0 ||\r\n                                cmsItemResult.response[0].pageStatus === CMSPageStatus.DELETED;\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ PermanentlyDeletePageItemComponent = __decorate([\r\n        SeDowngradeComponent(),\r\n        Component({\r\n            selector: 'se-permanently-delete-page-item',\r\n            template: \"<div *seHasOperationPermission=\\\"permanentlyDeletePagePermission\\\"><div class=\\\"se-dropdown-item__delete-wrapper\\\"><div class=\\\"se-dropdown-item__delete-link-wrapper\\\" [ngClass]=\\\"{'se-dropdown-item__delete-link-wrapper--disabled': isDeleteButtonDisabled()}\\\"><a class=\\\"se-dropdown-item se-dropdown-item__delete fd-menu__item\\\" [ngClass]=\\\"{'se-dropdown-item--disabled': isDeleteButtonDisabled()}\\\" (click)=\\\"permanentlyDelete()\\\"><span [translate]=\\\"'se.cms.actionitem.page.permanently.delete'\\\"></span></a></div><se-tooltip class=\\\"se-dropdown-item__delete-page-popover\\\" *ngIf=\\\"isDeleteButtonDisabled()\\\" [placement]=\\\"'left'\\\" [triggers]=\\\"['mouseenter', 'mouseleave']\\\" [isChevronVisible]=\\\"true\\\" [appendTo]=\\\"'body'\\\"><span se-tooltip-trigger class=\\\"sap-icon--message-error\\\"></span> <span se-tooltip-body [translate]=\\\"'se.cms.actionitem.page.permanently.delete.blocked'\\\"></span></se-tooltip></div></div>\",\r\n            styles: [\".se-dropdown-item__delete-wrapper{display:flex;flex-direction:row;align-items:center;width:100%}.se-dropdown-item__delete-page-popover{margin-right:16px}.se-dropdown-item__delete-page-popover .sap-icon--message-error{color:#0a6ed1}.se-dropdown-item__delete-link-wrapper{width:100%}.se-dropdown-item__delete-link-wrapper--disabled{cursor:not-allowed}\"]\r\n        }),\r\n        __param(4, Inject(DROPDOWN_MENU_ITEM_DATA)),\r\n        __metadata(\"design:paramtypes\", [ManagePageService,\r\n            CmsitemsRestService,\r\n            ICatalogService,\r\n            CrossFrameEventService, Object])\r\n    ], /* @ngInject */ PermanentlyDeletePageItemComponent);\r\n    return /* @ngInject */ PermanentlyDeletePageItemComponent;\r\n}());\r\nexport { /* @ngInject */ PermanentlyDeletePageItemComponent };\r\n//# sourceMappingURL=PermanentlyDeletePageItemComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/pages/ManagePageService.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"PermanentlyDeletePageItemComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/pages/pageItems/permanentlyDeletePageItem/PermanentlyDeletePageItemComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/components/pages/pageItems/permanentlyDeletePageItem/PermanentlyDeletePageItemComponent.d.ts","writeByteOrderMark":false,"text":"import { OnDestroy, OnInit } from '@angular/core';\r\nimport { CmsitemsRestService, ICMSPage } from 'cmscommons';\r\nimport { ManagePageService } from 'cmssmarteditcontainer/services/pages/ManagePageService';\r\nimport { CrossFrameEventService, ICatalogService, IDropdownMenuItemData, MultiNamePermissionContext } from 'smarteditcommons';\r\nexport declare class PermanentlyDeletePageItemComponent implements OnInit, OnDestroy {\r\n    private managePageService;\r\n    private cmsitemsRestService;\r\n    private catalogService;\r\n    private crossFrameEventService;\r\n    private dropdownMenuData;\r\n    pageInfo: ICMSPage;\r\n    permanentlyDeletePagePermission: MultiNamePermissionContext[];\r\n    private unregPageSyncStatusUpdate;\r\n    private isDeletable;\r\n    constructor(managePageService: ManagePageService, cmsitemsRestService: CmsitemsRestService, catalogService: ICatalogService, crossFrameEventService: CrossFrameEventService, dropdownMenuData: IDropdownMenuItemData);\r\n    ngOnInit(): Promise<void>;\r\n    ngOnDestroy(): void;\r\n    permanentlyDelete(): void;\r\n    isDeleteButtonDisabled(): boolean;\r\n    private fetchPageDeletableConditions;\r\n}\r\n"}}
