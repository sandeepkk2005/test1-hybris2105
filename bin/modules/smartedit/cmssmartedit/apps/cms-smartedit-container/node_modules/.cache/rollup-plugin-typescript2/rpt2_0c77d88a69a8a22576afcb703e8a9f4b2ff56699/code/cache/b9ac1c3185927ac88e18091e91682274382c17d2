{"code":"import { __awaiter, __decorate, __extends, __generator, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2021 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport * as lodash from 'lodash';\r\nimport { DropdownPopulatorInterface, GenericEditorStackService, LanguageService, SeDowngradeService, UriDropdownPopulator } from 'smarteditcommons';\r\n/**\r\n * Implementation of Dropdown Populator for \"CMSItemDropdown\" Structure Type.\r\n * Methods of this service will be used to populate the dropdown rendered by GenericEditorDropdownComponent.\r\n */\r\nvar /* @ngInject */ CMSItemDropdownDropdownPopulator = /** @class */ (function (_super) {\r\n    __extends(/* @ngInject */ CMSItemDropdownDropdownPopulator, _super);\r\n    function /* @ngInject */ CMSItemDropdownDropdownPopulator(genericEditorStackService, languageService, translateService, uriDropdownPopulator) {\r\n        var _this = _super.call(this, lodash, languageService, translateService) || this;\r\n        _this.genericEditorStackService = genericEditorStackService;\r\n        _this.uriDropdownPopulator = uriDropdownPopulator;\r\n        _this.CMS_ITEMS_URI = '/cmswebservices/v1/sites/CURRENT_CONTEXT_SITE_ID/cmsitems';\r\n        return _this;\r\n    }\r\n    /* @ngInject */ CMSItemDropdownDropdownPopulator.prototype.fetchAll = function (payload) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var items;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.preparePayload(payload);\r\n                        return [4 /*yield*/, this.uriDropdownPopulator.fetchAll(payload)];\r\n                    case 1:\r\n                        items = _a.sent();\r\n                        return [2 /*return*/, this.getNonNestedComponents(payload.field.editorStackId, items)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ CMSItemDropdownDropdownPopulator.prototype.fetchPage = function (payload) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var page;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.preparePayload(payload);\r\n                        return [4 /*yield*/, this.uriDropdownPopulator.fetchPage(payload)];\r\n                    case 1:\r\n                        page = _a.sent();\r\n                        page.response = this.getNonNestedComponents(payload.field.editorStackId, page.response);\r\n                        return [2 /*return*/, page];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ CMSItemDropdownDropdownPopulator.prototype.getItem = function (payload) {\r\n        this.preparePayload(payload);\r\n        return this.uriDropdownPopulator.getItem(payload);\r\n    };\r\n    /* @ngInject */ CMSItemDropdownDropdownPopulator.prototype.preparePayload = function (payload) {\r\n        payload.field.uri = this.CMS_ITEMS_URI;\r\n    };\r\n    /* @ngInject */ CMSItemDropdownDropdownPopulator.prototype.getNonNestedComponents = function (editorStackId, components) {\r\n        // Get the IDs of the components that are already opened in the editor's stack.\r\n        var componentsInStack = this.genericEditorStackService\r\n            .getEditorsStack(editorStackId)\r\n            .filter(function (componentInStack) { return componentInStack.component.uuid; })\r\n            .map(function (componentInStack) { return componentInStack.component.uuid; });\r\n        components = components.filter(function (componentInList) {\r\n            return !componentInList.uuid || !componentsInStack.includes(componentInList.uuid);\r\n        });\r\n        return components;\r\n    };\r\n    /* @ngInject */ CMSItemDropdownDropdownPopulator = __decorate([\r\n        SeDowngradeService(),\r\n        __metadata(\"design:paramtypes\", [GenericEditorStackService,\r\n            LanguageService,\r\n            TranslateService,\r\n            UriDropdownPopulator])\r\n    ], /* @ngInject */ CMSItemDropdownDropdownPopulator);\r\n    return /* @ngInject */ CMSItemDropdownDropdownPopulator;\r\n}(DropdownPopulatorInterface));\r\nexport { /* @ngInject */ CMSItemDropdownDropdownPopulator };\r\n//# sourceMappingURL=CMSItemDropdownDropdownPopulator.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@ngx-translate/core@11.0.1_@angular+core@8.2.14+rxjs@6.5.4/node_modules/@ngx-translate/core/ngx-translate-core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@types/lodash@4.14.159/node_modules/@types/lodash/ts3.1/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"CMSItemDropdownDropdownPopulator.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/cmsComponents/cmsItemDropdown/services/CMSItemDropdownDropdownPopulator.ts\"],\"names\":[],\"mappings\":\";AAAA;;GAEG;AACH,OAAO,EAAE,gBAAgB,EAAE,MAAM,qBAAqB,CAAC;AACvD,OAAO,KAAK,MAAM,MAAM,QAAQ,CAAC;AACjC,OAAO,EAEH,0BAA0B,EAK1B,yBAAyB,EACzB,eAAe,EACf,kBAAkB,EAClB,oBAAoB,EACvB,MAAM,kBAAkB,CAAC;AAE1B;;;GAGG;AAEH;IAAsD,oEAA0B;IAG5E,0DACY,yBAAoD,EAC5D,eAAgC,EAChC,gBAAkC,EAC1B,oBAA0C;QAJtD,YAMI,kBAAM,MAAM,EAAE,eAAe,EAAE,gBAAgB,CAAC,SACnD;QANW,+BAAyB,GAAzB,yBAAyB,CAA2B;QAGpD,0BAAoB,GAApB,oBAAoB,CAAsB;QAN9C,mBAAa,GAAG,2DAA2D,CAAC;;IASpF,CAAC;IAEY,mEAAQ,GAArB,UAAsB,OAAiC;;;;;;wBACnD,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;wBACf,qBAAM,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAA;;wBAAzD,KAAK,GAAG,SAAiD;wBAE/D,sBAAO,IAAI,CAAC,sBAAsB,CAAC,OAAO,CAAC,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,EAAC;;;;KAC1E;IAEY,oEAAS,GAAtB,UACI,OAAqC;;;;;;wBAErC,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;wBAChB,qBAAM,IAAI,CAAC,oBAAoB,CAAC,SAAS,CAAC,OAAO,CAAC,EAAA;;wBAAzD,IAAI,GAAG,SAAkD;wBAC/D,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,sBAAsB,CAAC,OAAO,CAAC,KAAK,CAAC,aAAa,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;wBAExF,sBAAO,IAAI,EAAC;;;;KACf;IAEM,kEAAO,GAAd,UAAe,OAAqC;QAChD,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;QAE7B,OAAO,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;IACtD,CAAC;IAEO,yEAAc,GAAtB,UAAuB,OAAqC;QACxD,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC;IAC3C,CAAC;IAEO,iFAAsB,GAA9B,UACI,aAAqB,EACrB,UAAiC;QAEjC,+EAA+E;QAC/E,IAAM,iBAAiB,GAAG,IAAI,CAAC,yBAAyB;aACnD,eAAe,CAAC,aAAa,CAAC;aAC9B,MAAM,CAAC,UAAC,gBAAgB,IAAK,OAAA,gBAAgB,CAAC,SAAS,CAAC,IAAI,EAA/B,CAA+B,CAAC;aAC7D,GAAG,CAAC,UAAC,gBAAgB,IAAK,OAAA,gBAAgB,CAAC,SAAS,CAAC,IAAI,EAA/B,CAA+B,CAAC,CAAC;QAEhE,UAAU,GAAG,UAAU,CAAC,MAAM,CAC1B,UAAC,eAAe;YACZ,OAAA,CAAC,eAAe,CAAC,IAAI,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC;QAA1E,CAA0E,CACjF,CAAC;QAEF,OAAO,UAAU,CAAC;IACtB,CAAC;IAvDL;QADC,kBAAkB,EAAE;yCAKsB,yBAAyB;YAC3C,eAAe;YACd,gBAAgB;YACJ,oBAAoB;wDAiDzD;IAAD,uDAAC;CAAA,AAxDD,CAAsD,0BAA0B,GAwD/E\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/components/cmsComponents/cmsItemDropdown/services/CMSItemDropdownDropdownPopulator.d.ts","writeByteOrderMark":false,"text":"import { TranslateService } from '@ngx-translate/core';\r\nimport { DropdownPopulatorFetchPageResponse, DropdownPopulatorInterface, DropdownPopulatorItemPayload, DropdownPopulatorPagePayload, DropdownPopulatorPayload, GenericEditorOption, GenericEditorStackService, LanguageService, UriDropdownPopulator } from 'smarteditcommons';\r\n/**\r\n * Implementation of Dropdown Populator for \"CMSItemDropdown\" Structure Type.\r\n * Methods of this service will be used to populate the dropdown rendered by GenericEditorDropdownComponent.\r\n */\r\nexport declare class CMSItemDropdownDropdownPopulator extends DropdownPopulatorInterface {\r\n    private genericEditorStackService;\r\n    private uriDropdownPopulator;\r\n    private CMS_ITEMS_URI;\r\n    constructor(genericEditorStackService: GenericEditorStackService, languageService: LanguageService, translateService: TranslateService, uriDropdownPopulator: UriDropdownPopulator);\r\n    fetchAll(payload: DropdownPopulatorPayload): Promise<GenericEditorOption[]>;\r\n    fetchPage(payload: DropdownPopulatorPagePayload): Promise<DropdownPopulatorFetchPageResponse>;\r\n    getItem(payload: DropdownPopulatorItemPayload): Promise<GenericEditorOption>;\r\n    private preparePayload;\r\n    private getNonNestedComponents;\r\n}\r\n"}}
