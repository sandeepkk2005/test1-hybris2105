{"code":"import { __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2021 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { Component, ElementRef, Input } from '@angular/core';\r\nimport { CrossFrameEventService, ELEMENT_UUID_ATTRIBUTE, EVENT_PERSPECTIVE_CHANGED, EVENT_PERSPECTIVE_REFRESHED, EVENT_SMARTEDIT_COMPONENT_UPDATED, PolyfillService, SeCustomComponent, SystemEventService, SMARTEDIT_DRAG_AND_DROP_EVENTS } from 'smarteditcommons';\r\nimport { SakExecutorService } from './SakExecutorService';\r\nvar smarteditElementComponentSelector = 'smartedit-element';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"SmarteditElementComponent\", {\r\n    selector: smarteditElementComponentSelector,\r\n    template: \" <div id=\\\"projectedContent\\\"><ng-content></ng-content></div> \"\r\n});\r\nvar SmarteditElementComponent = /** @class */ (function () {\r\n    function SmarteditElementComponent(elementRef, sakExecutorService, systemEventService, crossFrameEventService, polyfillService) {\r\n        var _this = this;\r\n        this.elementRef = elementRef;\r\n        this.sakExecutorService = sakExecutorService;\r\n        this.systemEventService = systemEventService;\r\n        this.crossFrameEventService = crossFrameEventService;\r\n        this.polyfillService = polyfillService;\r\n        this.active = false;\r\n        this.componentDecoratorEnabled = true;\r\n        this.removeDecorators = function () {\r\n            // removing previous content of placeHolder\r\n            if (_this.bundle && _this.element.contains(_this.bundle)) {\r\n                _this.element.removeChild(_this.bundle);\r\n            }\r\n            _this.bundle = _this.projectedContent;\r\n            _this.element.appendChild(_this.bundle);\r\n        };\r\n        this.appendDecorators = function () {\r\n            // removing previous content of placeHolder\r\n            if (_this.bundle && _this.element.contains(_this.bundle)) {\r\n                _this.element.removeChild(_this.bundle);\r\n            }\r\n            _this.sakExecutorService\r\n                .wrapDecorators(_this.projectedContent, _this.element)\r\n                .then(function (bundle) {\r\n                _this.bundle = bundle;\r\n                _this.element.appendChild(_this.bundle);\r\n            });\r\n        };\r\n        this.propagateActiveStateToChildren = function () {\r\n            _this.element.querySelectorAll('[active]').forEach(function (element) {\r\n                if (_this.uuid === _this.getUuid(element)) {\r\n                    element.setAttribute('active', _this.active + '');\r\n                }\r\n            });\r\n        };\r\n    }\r\n    SmarteditElementComponent.prototype.ngOnInit = function () {\r\n        var projectedContentWrapper = this.element.querySelector('#projectedContent');\r\n        this.projectedContent = projectedContentWrapper.children[0];\r\n        this.element.removeChild(projectedContentWrapper);\r\n        this.appendDecorators();\r\n    };\r\n    SmarteditElementComponent.prototype.ngAfterViewInit = function () {\r\n        var _this = this;\r\n        this.mousenterListener = function (event) {\r\n            if (!_this.active) {\r\n                _this.active = _this.componentDecoratorEnabled;\r\n                _this.propagateActiveStateToChildren();\r\n            }\r\n        };\r\n        this.mouseleaveListener = function (event) {\r\n            if (_this.active) {\r\n                _this.active = false;\r\n                _this.propagateActiveStateToChildren();\r\n            }\r\n        };\r\n        // Register Event Listeners\r\n        this.element.addEventListener('mouseenter', this.mousenterListener);\r\n        this.element.addEventListener('mouseleave', this.mouseleaveListener);\r\n        this.unregisterPerspectiveChangeEvent = this.crossFrameEventService.subscribe(EVENT_PERSPECTIVE_CHANGED, function (eventId, notPreview) {\r\n            notPreview && _this.appendDecorators();\r\n        });\r\n        this.unregisterPerspectiveRefreshedEvent = this.crossFrameEventService.subscribe(EVENT_PERSPECTIVE_REFRESHED, function (eventId, notPreview) {\r\n            notPreview && _this.appendDecorators();\r\n        });\r\n        this.unregisterComponentUpdatedEvent = this.crossFrameEventService.subscribe(EVENT_SMARTEDIT_COMPONENT_UPDATED, this.onComponentUpdated.bind(this));\r\n        // we can't listen to these events in the controller because they could be sent before the component compilation.\r\n        this.unregisterDnDStart = this.systemEventService.subscribe(SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_START, function (eventId, smarteditComponentClosestToDraggedElement) {\r\n            if (_this.polyfillService.isEligibleForEconomyMode() &&\r\n                smarteditComponentClosestToDraggedElement &&\r\n                _this.uuid ===\r\n                    smarteditComponentClosestToDraggedElement.attr(ELEMENT_UUID_ATTRIBUTE)) {\r\n                _this.componentDecoratorEnabled = false;\r\n                _this.removeDecorators();\r\n            }\r\n        });\r\n        this.unregisterDnDEnd = this.systemEventService.subscribe(SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_END, function () {\r\n            if (_this.polyfillService.isEligibleForEconomyMode()) {\r\n                _this.componentDecoratorEnabled = true;\r\n                _this.appendDecorators();\r\n            }\r\n        });\r\n    };\r\n    SmarteditElementComponent.prototype.ngOnDestroy = function () {\r\n        this.removeDecorators();\r\n        this.unregisterPerspectiveChangeEvent();\r\n        this.unregisterPerspectiveRefreshedEvent();\r\n        this.unregisterComponentUpdatedEvent();\r\n        this.unregisterDnDEnd();\r\n        this.unregisterDnDStart();\r\n        this.element.removeEventListener('mouseenter', this.mousenterListener);\r\n        this.element.removeEventListener('mouseleave', this.mouseleaveListener);\r\n        delete this.bundle;\r\n    };\r\n    SmarteditElementComponent.prototype.onComponentUpdated = function (eventId, componentUpdatedData) {\r\n        var requiresReplayingDecorators = componentUpdatedData && componentUpdatedData.requiresReplayingDecorators;\r\n        var isCurrentComponent = componentUpdatedData &&\r\n            componentUpdatedData.componentId === this.smarteditComponentId &&\r\n            componentUpdatedData.componentType === this.smarteditComponentType;\r\n        if (isCurrentComponent && requiresReplayingDecorators) {\r\n            this.appendDecorators();\r\n        }\r\n    };\r\n    SmarteditElementComponent.prototype.getUuid = function (element) {\r\n        return element.getAttribute(ELEMENT_UUID_ATTRIBUTE);\r\n    };\r\n    Object.defineProperty(SmarteditElementComponent.prototype, \"uuid\", {\r\n        get: function () {\r\n            return this.element.getAttribute(ELEMENT_UUID_ATTRIBUTE);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SmarteditElementComponent.prototype, \"element\", {\r\n        get: function () {\r\n            return this.elementRef.nativeElement;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    __decorate([\r\n        Input('data-smartedit-component-id'),\r\n        __metadata(\"design:type\", String)\r\n    ], SmarteditElementComponent.prototype, \"smarteditComponentId\", void 0);\r\n    __decorate([\r\n        Input('data-smartedit-component-uuid'),\r\n        __metadata(\"design:type\", String)\r\n    ], SmarteditElementComponent.prototype, \"smarteditComponentUuid\", void 0);\r\n    __decorate([\r\n        Input('data-smartedit-component-type'),\r\n        __metadata(\"design:type\", String)\r\n    ], SmarteditElementComponent.prototype, \"smarteditComponentType\", void 0);\r\n    __decorate([\r\n        Input('data-smartedit-container-id'),\r\n        __metadata(\"design:type\", String)\r\n    ], SmarteditElementComponent.prototype, \"smarteditContainerId\", void 0);\r\n    __decorate([\r\n        Input('data-smartedit-container-type'),\r\n        __metadata(\"design:type\", String)\r\n    ], SmarteditElementComponent.prototype, \"smarteditContainerType\", void 0);\r\n    SmarteditElementComponent = __decorate([\r\n        SeCustomComponent(),\r\n        Component({\r\n            selector: smarteditElementComponentSelector,\r\n            template: \" <div id=\\\"projectedContent\\\"><ng-content></ng-content></div> \"\r\n        }),\r\n        __metadata(\"design:paramtypes\", [ElementRef,\r\n            SakExecutorService,\r\n            SystemEventService,\r\n            CrossFrameEventService,\r\n            PolyfillService])\r\n    ], SmarteditElementComponent);\r\n    return SmarteditElementComponent;\r\n}());\r\nexport { SmarteditElementComponent };\r\n//# sourceMappingURL=SmarteditElementComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit/src/services/sakExecutor/SakExecutorService.ts"],"map":"{\"version\":3,\"file\":\"SmarteditElementComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/services/sakExecutor/SmarteditElementComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit/services/sakExecutor/SmarteditElementComponent.d.ts","writeByteOrderMark":false,"text":"import { ElementRef } from '@angular/core';\r\nimport { CrossFrameEventService, PolyfillService, SystemEventService } from 'smarteditcommons';\r\nimport { SakExecutorService } from './SakExecutorService';\r\nexport declare class SmarteditElementComponent {\r\n    private elementRef;\r\n    private sakExecutorService;\r\n    private systemEventService;\r\n    private crossFrameEventService;\r\n    private polyfillService;\r\n    smarteditComponentId: string;\r\n    smarteditComponentUuid: string;\r\n    smarteditComponentType: string;\r\n    smarteditContainerId: string;\r\n    smarteditContainerType: string;\r\n    active: boolean;\r\n    private componentDecoratorEnabled;\r\n    private projectedContent;\r\n    private bundle;\r\n    private unregisterPerspectiveChangeEvent;\r\n    private unregisterPerspectiveRefreshedEvent;\r\n    private unregisterComponentUpdatedEvent;\r\n    private unregisterDnDEnd;\r\n    private unregisterDnDStart;\r\n    private mousenterListener;\r\n    private mouseleaveListener;\r\n    constructor(elementRef: ElementRef, sakExecutorService: SakExecutorService, systemEventService: SystemEventService, crossFrameEventService: CrossFrameEventService, polyfillService: PolyfillService);\r\n    ngOnInit(): void;\r\n    ngAfterViewInit(): void;\r\n    ngOnDestroy(): void;\r\n    private removeDecorators;\r\n    private appendDecorators;\r\n    private onComponentUpdated;\r\n    private propagateActiveStateToChildren;\r\n    private getUuid;\r\n    private get uuid();\r\n    private get element();\r\n}\r\n"}}
