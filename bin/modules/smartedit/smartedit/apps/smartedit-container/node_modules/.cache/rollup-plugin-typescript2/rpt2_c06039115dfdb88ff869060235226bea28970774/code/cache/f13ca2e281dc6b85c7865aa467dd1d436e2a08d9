{"code":"import { __awaiter, __decorate, __generator, __metadata } from \"tslib\";\r\nimport './toolbar.scss';\r\nimport { ChangeDetectorRef, Component, Injector, Input } from '@angular/core';\r\nimport { EVENTS, IIframeClickDetectionService, IToolbarServiceFactory, SeDowngradeComponent, SmarteditRoutingService, SystemEventService, STORE_FRONT_CONTEXT, TOOLBAR_ITEM } from 'smarteditcommons';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"ToolbarComponent\", {\r\n    selector: 'se-toolbar',\r\n    template: \"<div class=\\\"se-toolbar\\\" [ngClass]=\\\"cssClass\\\"><div class=\\\"se-toolbar__left\\\"><div *ngFor=\\\"let item of aliases | seProperty:{section:'left'}; trackBy: trackByFn\\\" class=\\\"se-template-toolbar se-template-toolbar__left {{item.className}}\\\"><se-toolbar-section-item [item]=\\\"item\\\"></se-toolbar-section-item></div></div><div class=\\\"se-toolbar__middle\\\"><div *ngFor=\\\"let item of aliases | seProperty:{section:'middle'}; trackBy: trackByFn\\\" class=\\\"se-template-toolbar se-template-toolbar__middle {{item.className}}\\\"><se-toolbar-section-item [item]=\\\"item\\\"></se-toolbar-section-item></div></div><div class=\\\"se-toolbar__right\\\"><div *ngFor=\\\"let item of aliases | seProperty:{section:'right'}; trackBy: trackByFn\\\" class=\\\"se-template-toolbar se-template-toolbar__right {{item.className}}\\\"><se-toolbar-section-item [item]=\\\"item\\\"></se-toolbar-section-item></div></div></div>\"\r\n});\r\nvar /* @ngInject */ ToolbarComponent = /** @class */ (function () {\r\n    function /* @ngInject */ ToolbarComponent(toolbarServiceFactory, iframeClickDetectionService, systemEventService, injector, cdr, routingService) {\r\n        this.toolbarServiceFactory = toolbarServiceFactory;\r\n        this.iframeClickDetectionService = iframeClickDetectionService;\r\n        this.systemEventService = systemEventService;\r\n        this.injector = injector;\r\n        this.cdr = cdr;\r\n        this.routingService = routingService;\r\n        this.imageRoot = '';\r\n        this.aliases = [];\r\n        this.unregCloseActions = null;\r\n        this.unregCloseAll = null;\r\n        this.unregRecalcPermissions = null;\r\n    }\r\n    /* @ngInject */ ToolbarComponent_1 = /* @ngInject */ ToolbarComponent;\r\n    /* @ngInject */ ToolbarComponent.prototype.ngOnInit = function () {\r\n        this.setup();\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.ngOnDestroy = function () {\r\n        this.unregCloseActions();\r\n        this.unregCloseAll();\r\n        this.unregRecalcPermissions();\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.triggerAction = function (action, $event) {\r\n        $event.preventDefault();\r\n        this.toolbarService.triggerAction(action);\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.getItemVisibility = function (item) {\r\n        return (item.include || item.component) && (item.isOpen || item.keepAliveOnClose);\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.isOnStorefront = function () {\r\n        return this.routingService.absUrl().includes(STORE_FRONT_CONTEXT);\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.createLegacyController = function () {\r\n        var _this = this;\r\n        return {\r\n            alias: '$ctrl',\r\n            value: function () { return _this; }\r\n        };\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.createInjector = function (item) {\r\n        return Injector.create({\r\n            parent: this.injector,\r\n            providers: [\r\n                {\r\n                    provide: TOOLBAR_ITEM,\r\n                    useValue: item\r\n                }\r\n            ]\r\n        });\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.trackByFn = function (_, item) {\r\n        return item.key;\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.closeAllActionItems = function () {\r\n        this.aliases.forEach(function (alias) {\r\n            alias.isOpen = false;\r\n        });\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.populatePermissions = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var promises, _a;\r\n            var _this = this;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        promises = this.aliases.map(function (alias) {\r\n                            return _this.toolbarService._populateIsPermissionGranted(alias);\r\n                        });\r\n                        _a = this;\r\n                        return [4 /*yield*/, Promise.all(promises)];\r\n                    case 1:\r\n                        _a.aliases = _b.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.setup = function () {\r\n        this.buildAliases();\r\n        this.populatePermissions();\r\n        this.registerCallbacks();\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.buildAliases = function () {\r\n        var _this = this;\r\n        this.toolbarService = this.toolbarServiceFactory.getToolbarService(this.toolbarName);\r\n        this.toolbarService.setOnAliasesChange(function (aliases) {\r\n            _this.aliases = aliases;\r\n            if (!_this.cdr.destroyed) {\r\n                _this.cdr.detectChanges();\r\n            }\r\n        });\r\n        this.aliases = this.toolbarService.getAliases();\r\n    };\r\n    /* @ngInject */ ToolbarComponent.prototype.registerCallbacks = function () {\r\n        var _this = this;\r\n        this.unregCloseActions = this.iframeClickDetectionService.registerCallback(/* @ngInject */ ToolbarComponent_1.CLOSE_ALL_ACTION_ITEMS + this.toolbarName, function () { return _this.closeAllActionItems(); });\r\n        this.unregCloseAll = this.systemEventService.subscribe(EVENTS.PAGE_SELECTED, function () {\r\n            return _this.closeAllActionItems();\r\n        });\r\n        this.unregRecalcPermissions = this.systemEventService.subscribe(EVENTS.PERMISSION_CACHE_CLEANED, function () { return _this.populatePermissions(); });\r\n    };\r\n    var /* @ngInject */ ToolbarComponent_1;\r\n    /* @ngInject */ ToolbarComponent.CLOSE_ALL_ACTION_ITEMS = 'closeAllActionItems';\r\n    __decorate([\r\n        Input(),\r\n        __metadata(\"design:type\", String)\r\n    ], /* @ngInject */ ToolbarComponent.prototype, \"cssClass\", void 0);\r\n    __decorate([\r\n        Input(),\r\n        __metadata(\"design:type\", String)\r\n    ], /* @ngInject */ ToolbarComponent.prototype, \"toolbarName\", void 0);\r\n    __decorate([\r\n        Input(),\r\n        __metadata(\"design:type\", Object)\r\n    ], /* @ngInject */ ToolbarComponent.prototype, \"imageRoot\", void 0);\r\n    /* @ngInject */ ToolbarComponent = /* @ngInject */ ToolbarComponent_1 = __decorate([\r\n        SeDowngradeComponent(),\r\n        Component({\r\n            selector: 'se-toolbar',\r\n            template: \"<div class=\\\"se-toolbar\\\" [ngClass]=\\\"cssClass\\\"><div class=\\\"se-toolbar__left\\\"><div *ngFor=\\\"let item of aliases | seProperty:{section:'left'}; trackBy: trackByFn\\\" class=\\\"se-template-toolbar se-template-toolbar__left {{item.className}}\\\"><se-toolbar-section-item [item]=\\\"item\\\"></se-toolbar-section-item></div></div><div class=\\\"se-toolbar__middle\\\"><div *ngFor=\\\"let item of aliases | seProperty:{section:'middle'}; trackBy: trackByFn\\\" class=\\\"se-template-toolbar se-template-toolbar__middle {{item.className}}\\\"><se-toolbar-section-item [item]=\\\"item\\\"></se-toolbar-section-item></div></div><div class=\\\"se-toolbar__right\\\"><div *ngFor=\\\"let item of aliases | seProperty:{section:'right'}; trackBy: trackByFn\\\" class=\\\"se-template-toolbar se-template-toolbar__right {{item.className}}\\\"><se-toolbar-section-item [item]=\\\"item\\\"></se-toolbar-section-item></div></div></div>\"\r\n        }),\r\n        __metadata(\"design:paramtypes\", [IToolbarServiceFactory,\r\n            IIframeClickDetectionService,\r\n            SystemEventService,\r\n            Injector,\r\n            ChangeDetectorRef,\r\n            SmarteditRoutingService])\r\n    ], /* @ngInject */ ToolbarComponent);\r\n    return /* @ngInject */ ToolbarComponent;\r\n}());\r\nexport { /* @ngInject */ ToolbarComponent };\r\n//# sourceMappingURL=ToolbarComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@types/angular@1.7.3/node_modules/@types/angular/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-container/src/services/toolbar/services/ToolbarService.ts"],"map":"{\"version\":3,\"file\":\"ToolbarComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/services/toolbar/components/ToolbarComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-container/services/toolbar/components/ToolbarComponent.d.ts","writeByteOrderMark":false,"text":"import './toolbar.scss';\r\nimport { ChangeDetectorRef, Injector, OnDestroy, OnInit } from '@angular/core';\r\nimport { CompileHtmlNgController, IIframeClickDetectionService, IToolbarServiceFactory, SmarteditRoutingService, SystemEventService, ToolbarItemInternal } from 'smarteditcommons';\r\nimport { ToolbarService } from '../services/ToolbarService';\r\nexport declare class ToolbarComponent implements OnInit, OnDestroy {\r\n    private toolbarServiceFactory;\r\n    private iframeClickDetectionService;\r\n    private systemEventService;\r\n    private injector;\r\n    private cdr;\r\n    private routingService;\r\n    static readonly CLOSE_ALL_ACTION_ITEMS = \"closeAllActionItems\";\r\n    cssClass: string;\r\n    toolbarName: string;\r\n    imageRoot: string;\r\n    aliases: ToolbarItemInternal[];\r\n    private unregCloseActions;\r\n    private unregCloseAll;\r\n    private unregRecalcPermissions;\r\n    private toolbarService;\r\n    constructor(toolbarServiceFactory: IToolbarServiceFactory<ToolbarService>, iframeClickDetectionService: IIframeClickDetectionService, systemEventService: SystemEventService, injector: Injector, cdr: ChangeDetectorRef, routingService: SmarteditRoutingService);\r\n    ngOnInit(): void;\r\n    ngOnDestroy(): void;\r\n    triggerAction(action: ToolbarItemInternal, $event: Event): void;\r\n    getItemVisibility(item: ToolbarItemInternal): boolean;\r\n    isOnStorefront(): boolean;\r\n    createLegacyController(): CompileHtmlNgController;\r\n    createInjector(item: ToolbarItemInternal): Injector;\r\n    trackByFn(_: number, item: ToolbarItemInternal): string;\r\n    private closeAllActionItems;\r\n    private populatePermissions;\r\n    private setup;\r\n    private buildAliases;\r\n    private registerCallbacks;\r\n}\r\n"}}
