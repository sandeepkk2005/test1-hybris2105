{"code":"import { __decorate, __metadata, __param } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\r\nimport { GENERIC_EDITOR_WIDGET_DATA, LINKED_DROPDOWN, SystemEventService } from 'smarteditcommons';\r\nimport { CMS_LINK_TO_RELOAD_STRUCTURE_EVENT_ID } from '../../../constants';\r\nimport { LinkToOption } from './types';\r\nvar SelectOptions = [\r\n    {\r\n        id: LinkToOption.content,\r\n        structureApiMode: 'CONTENT'\r\n    },\r\n    {\r\n        id: LinkToOption.product,\r\n        structureApiMode: 'PRODUCT',\r\n        hasCatalog: true\r\n    },\r\n    {\r\n        id: LinkToOption.category,\r\n        structureApiMode: 'CATEGORY',\r\n        hasCatalog: true\r\n    },\r\n    {\r\n        id: LinkToOption.external,\r\n        structureApiMode: 'EXTERNAL'\r\n    }\r\n];\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"CmsLinkToSelectComponent\", {\r\n    selector: 'se-cms-link-to-select',\r\n    template: \"<se-generic-editor-dropdown [id]=\\\"id\\\" [field]=\\\"field\\\" [qualifier]=\\\"qualifier\\\" [model]=\\\"optionModel\\\"></se-generic-editor-dropdown>\",\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nvar CmsLinkToSelectComponent = /** @class */ (function () {\r\n    function CmsLinkToSelectComponent(cdr, systemEventService, data) {\r\n        this.cdr = cdr;\r\n        this.systemEventService = systemEventService;\r\n        (this.id = data.id, this.field = data.field, this.optionModel = data.model, this.qualifier = data.qualifier);\r\n    }\r\n    CmsLinkToSelectComponent.prototype.ngOnInit = function () {\r\n        var _this = this;\r\n        var linkTo = this.getLinkToValue(this.optionModel);\r\n        if (linkTo !== null) {\r\n            this.optionModel.linkTo = linkTo;\r\n        }\r\n        var onSelectValueChangedEventName = \"\" + this.id + LINKED_DROPDOWN;\r\n        this.unRegSelectValueChanged = this.systemEventService.subscribe(onSelectValueChangedEventName, function (_eventId, data) { return _this.onLinkToSelectValueChanged(data); });\r\n    };\r\n    CmsLinkToSelectComponent.prototype.ngOnDestroy = function () {\r\n        this.unRegSelectValueChanged();\r\n    };\r\n    CmsLinkToSelectComponent.prototype.onLinkToSelectValueChanged = function (_a) {\r\n        var option = _a.optionObject, qualifier = _a.qualifier;\r\n        if (this.qualifier !== qualifier) {\r\n            return;\r\n        }\r\n        if (!option) {\r\n            return;\r\n        }\r\n        var optionValue = option.id;\r\n        var selectedOption = SelectOptions.find(function (_a) {\r\n            var id = _a.id;\r\n            return id === optionValue;\r\n        });\r\n        if (!selectedOption) {\r\n            throw new Error('Selected option is not supported');\r\n        }\r\n        if (optionValue === this.optionModel.currentSelectedOptionValue) {\r\n            return;\r\n        }\r\n        this.optionModel.currentSelectedOptionValue = optionValue;\r\n        this.optionModel.external = optionValue !== LinkToOption.external;\r\n        this.clearModel(selectedOption);\r\n        this.systemEventService.publishAsync(CMS_LINK_TO_RELOAD_STRUCTURE_EVENT_ID, {\r\n            content: this.optionModel,\r\n            structureApiMode: selectedOption.structureApiMode,\r\n            editorId: this.id\r\n        });\r\n        this.cdr.detectChanges();\r\n    };\r\n    CmsLinkToSelectComponent.prototype.getLinkToValue = function (model) {\r\n        if (model.url) {\r\n            return LinkToOption.external;\r\n        }\r\n        else if (model.product) {\r\n            return LinkToOption.product;\r\n        }\r\n        else if (model.contentPage) {\r\n            return LinkToOption.content;\r\n        }\r\n        else if (model.category) {\r\n            return LinkToOption.category;\r\n        }\r\n        return null;\r\n    };\r\n    CmsLinkToSelectComponent.prototype.clearModel = function (_a) {\r\n        var id = _a.id, hasCatalog = _a.hasCatalog;\r\n        if (id !== LinkToOption.category) {\r\n            delete this.optionModel.category;\r\n        }\r\n        if (id !== LinkToOption.product) {\r\n            delete this.optionModel.product;\r\n        }\r\n        if (!hasCatalog) {\r\n            delete this.optionModel.productCatalog;\r\n        }\r\n        if (id !== LinkToOption.content) {\r\n            delete this.optionModel.contentPage;\r\n        }\r\n        if (id !== LinkToOption.external) {\r\n            delete this.optionModel.url;\r\n        }\r\n    };\r\n    CmsLinkToSelectComponent = __decorate([\r\n        Component({\r\n            selector: 'se-cms-link-to-select',\r\n            template: \"<se-generic-editor-dropdown [id]=\\\"id\\\" [field]=\\\"field\\\" [qualifier]=\\\"qualifier\\\" [model]=\\\"optionModel\\\"></se-generic-editor-dropdown>\",\r\n            changeDetection: ChangeDetectionStrategy.OnPush\r\n        }),\r\n        __param(2, Inject(GENERIC_EDITOR_WIDGET_DATA)),\r\n        __metadata(\"design:paramtypes\", [ChangeDetectorRef,\r\n            SystemEventService, Object])\r\n    ], CmsLinkToSelectComponent);\r\n    return CmsLinkToSelectComponent;\r\n}());\r\nexport { CmsLinkToSelectComponent };\r\n//# sourceMappingURL=CmsLinkToSelectComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/constants.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/genericEditor/cmsLinkToSelect/types.ts"],"map":"{\"version\":3,\"file\":\"CmsLinkToSelectComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/components/genericEditor/cmsLinkToSelect/CmsLinkToSelectComponent.ts\"],\"names\":[],\"mappings\":\";AACA,OAAO,EACH,uBAAuB,EACvB,iBAAiB,EACjB,SAAS,EACT,MAAM,EAGT,MAAM,eAAe,CAAC;AACvB,OAAO,EAGH,0BAA0B,EAC1B,eAAe,EACf,kBAAkB,EACrB,MAAM,kBAAkB,CAAC;AAC1B,OAAO,EAAE,qCAAqC,EAAE,MAAM,oBAAoB,CAAC;AAC3E,OAAO,EAAyB,YAAY,EAAgC,MAAM,SAAS,CAAC;AAE5F,IAAM,aAAa,GAAG;IAClB;QACI,EAAE,EAAE,YAAY,CAAC,OAAO;QACxB,gBAAgB,EAAE,SAAS;KAC9B;IACD;QACI,EAAE,EAAE,YAAY,CAAC,OAAO;QACxB,gBAAgB,EAAE,SAAS;QAC3B,UAAU,EAAE,IAAI;KACnB;IACD;QACI,EAAE,EAAE,YAAY,CAAC,QAAQ;QACzB,gBAAgB,EAAE,UAAU;QAC5B,UAAU,EAAE,IAAI;KACnB;IACD;QACI,EAAE,EAAE,YAAY,CAAC,QAAQ;QACzB,gBAAgB,EAAE,UAAU;KAC/B;CACJ,CAAC;kFAGS;IACP,QAAQ,EAAE,uBAAuB;IACjC,QAAQ,EAAE,2IAAmI;IAC7I,eAAe,EAAE,uBAAuB,CAAC,MAAM;CAClD;AACD;IAQI,kCACY,GAAsB,EACtB,kBAAsC,EAE9C,IAAoD;QAH5C,QAAG,GAAH,GAAG,CAAmB;QACtB,uBAAkB,GAAlB,kBAAkB,CAAoB;QAI9C,CACQ,IAAI,CAAC,EAAE,GAIX,IAAI,GAJO,EACJ,IAAI,CAAC,KAAK,GAGjB,IAAI,MAHa,EACV,IAAI,CAAC,WAAW,GAEvB,IAAI,MAFmB,EACZ,IAAI,CAAC,SAAS,GACzB,IAAI,UADqB,CACpB,CAAC;IACd,CAAC;IAED,2CAAQ,GAAR;QAAA,iBAWC;QAVG,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QACrD,IAAI,MAAM,KAAK,IAAI,EAAE;YACjB,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,MAAM,CAAC;SACpC;QAED,IAAM,6BAA6B,GAAG,KAAG,IAAI,CAAC,EAAE,GAAG,eAAiB,CAAC;QACrE,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAC5D,6BAA6B,EAC7B,UAAC,QAAQ,EAAE,IAAI,IAAK,OAAA,KAAI,CAAC,0BAA0B,CAAC,IAAI,CAAC,EAArC,CAAqC,CAC5D,CAAC;IACN,CAAC;IAED,8CAAW,GAAX;QACI,IAAI,CAAC,uBAAuB,EAAE,CAAC;IACnC,CAAC;IAGO,6DAA0B,GAAlC,UAAmC,EAAmD;YAAnC,MAAM,kBAAA,EAAE,SAAS,eAAA;QAEhE,IAAI,IAAI,CAAC,SAAS,KAAK,SAAS,EAAE;YAC9B,OAAO;SACV;QAED,IAAI,CAAC,MAAM,EAAE;YACT,OAAO;SACV;QAED,IAAM,WAAW,GAAG,MAAM,CAAC,EAAE,CAAC;QAC9B,IAAM,cAAc,GAAG,aAAa,CAAC,IAAI,CAAC,UAAC,EAAM;gBAAJ,EAAE,QAAA;YAAO,OAAA,EAAE,KAAK,WAAW;QAAlB,CAAkB,CAAC,CAAC;QAC1E,IAAI,CAAC,cAAc,EAAE;YACjB,MAAM,IAAI,KAAK,CAAC,kCAAkC,CAAC,CAAC;SACvD;QAGD,IAAI,WAAW,KAAK,IAAI,CAAC,WAAW,CAAC,0BAA0B,EAAE;YAC7D,OAAO;SACV;QACD,IAAI,CAAC,WAAW,CAAC,0BAA0B,GAAG,WAAW,CAAC;QAC1D,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,WAAW,KAAK,YAAY,CAAC,QAAQ,CAAC;QAElE,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC;QAEhC,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,qCAAqC,EAAE;YACxE,OAAO,EAAE,IAAI,CAAC,WAAW;YACzB,gBAAgB,EAAE,cAAc,CAAC,gBAAgB;YACjD,QAAQ,EAAE,IAAI,CAAC,EAAE;SACpB,CAAC,CAAC;QAEH,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC7B,CAAC;IAEO,iDAAc,GAAtB,UAAuB,KAA4B;QAC/C,IAAI,KAAK,CAAC,GAAG,EAAE;YACX,OAAO,YAAY,CAAC,QAAQ,CAAC;SAChC;aAAM,IAAI,KAAK,CAAC,OAAO,EAAE;YACtB,OAAO,YAAY,CAAC,OAAO,CAAC;SAC/B;aAAM,IAAI,KAAK,CAAC,WAAW,EAAE;YAC1B,OAAO,YAAY,CAAC,OAAO,CAAC;SAC/B;aAAM,IAAI,KAAK,CAAC,QAAQ,EAAE;YACvB,OAAO,YAAY,CAAC,QAAQ,CAAC;SAChC;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IAGO,6CAAU,GAAlB,UAAmB,EAAgC;YAA9B,EAAE,QAAA,EAAE,UAAU,gBAAA;QAC/B,IAAI,EAAE,KAAK,YAAY,CAAC,QAAQ,EAAE;YAC9B,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC;SACpC;QAED,IAAI,EAAE,KAAK,YAAY,CAAC,OAAO,EAAE;YAC7B,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC;SACnC;QAED,IAAI,CAAC,UAAU,EAAE;YACb,OAAO,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC;SAC1C;QAED,IAAI,EAAE,KAAK,YAAY,CAAC,OAAO,EAAE;YAC7B,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC;SACvC;QAED,IAAI,EAAE,KAAK,YAAY,CAAC,QAAQ,EAAE;YAC9B,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC;SAC/B;IACL,CAAC;IA5GQ,wBAAwB;QALpC,SAAS,CAAC;YACP,QAAQ,EAAE,uBAAuB;YACjC,QAAQ,EAAE,2IAAmI;YAC7I,eAAe,EAAE,uBAAuB,CAAC,MAAM;SAClD,CAAC;QAYO,WAAA,MAAM,CAAC,0BAA0B,CAAC,CAAA;yCAFtB,iBAAiB;YACF,kBAAkB;OAVzC,wBAAwB,CA6GpC;IAAD,+BAAC;CAAA,AA7GD,IA6GC;SA7GY,wBAAwB\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/components/genericEditor/cmsLinkToSelect/CmsLinkToSelectComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnDestroy, OnInit } from '@angular/core';\r\nimport { GenericEditorField, GenericEditorWidgetData, SystemEventService } from 'smarteditcommons';\r\nimport { CmsLinkToSelectOption } from './types';\r\nexport declare class CmsLinkToSelectComponent implements OnInit, OnDestroy {\r\n    private cdr;\r\n    private systemEventService;\r\n    id: string;\r\n    field: GenericEditorField;\r\n    optionModel: CmsLinkToSelectOption;\r\n    qualifier: string;\r\n    private unRegSelectValueChanged;\r\n    constructor(cdr: ChangeDetectorRef, systemEventService: SystemEventService, data: GenericEditorWidgetData<CmsLinkToSelectOption>);\r\n    ngOnInit(): void;\r\n    ngOnDestroy(): void;\r\n    private onLinkToSelectValueChanged;\r\n    private getLinkToValue;\r\n    private clearModel;\r\n}\r\n"}}
