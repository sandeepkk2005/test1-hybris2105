{"code":"import { __decorate, __metadata, __spreadArrays } from \"tslib\";\r\n/*\r\n * Copyright (c) 2021 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { Injectable } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { objectUtils, stringUtils, IContextualMenuService, PriorityService, REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT, SeDowngradeService, SystemEventService } from 'smarteditcommons';\r\n/**\r\n * The ContextualMenuService is used to add contextual menu items for each component.\r\n *\r\n * To add items to the contextual menu, you must call the addItems method of the contextualMenuService and pass a map\r\n * of the component-type array of contextual menu items mapping. The component type names are the keys in the mapping.\r\n * The component name can be the full name of the component type, an ant-like wildcard (such as  *middle*Suffix), or a\r\n * valid regex that includes or excludes a set of component types.\r\n *\r\n */\r\nvar /* @ngInject */ ContextualMenuService = /** @class */ (function () {\r\n    /* @internal */\r\n    function /* @ngInject */ ContextualMenuService(priorityService, systemEventService) {\r\n        this.priorityService = priorityService;\r\n        this.systemEventService = systemEventService;\r\n        this.onContextualMenuItemsAdded = new BehaviorSubject(null);\r\n        this._contextualMenus = {};\r\n    }\r\n    /**\r\n     * The method called to add contextual menu items to component types in the SmartEdit application.\r\n     * The contextual menu items are then retrieved by the contextual menu decorator to wire the set of menu items to the specified component.\r\n     *\r\n     * ### Example:\r\n     *\r\n     *\r\n     *      contextualMenuService.addItems({\r\n     *          '.*Component': [{\r\n     *              key: 'itemKey',\r\n     *              i18nKey: 'CONTEXTUAL_MENU',\r\n     *              condition: function(componentType, componentId) {\r\n     *                  return componentId === 'ComponentType';\r\n     *              },\r\n     *              callback: function(componentType, componentId) {\r\n     *                  alert('callback for ' + componentType + \"_\" + componentId);\r\n     *              },\r\n     *              displayClass: 'democlass',\r\n     *              iconIdle: '.../icons/icon.png',\r\n     *              iconNonIdle: '.../icons/icon.png',\r\n     *              }]\r\n     *          });\r\n     *\r\n     *\r\n     * @param  contextualMenuItemsMap A map of componentType regular expressions to list of IContextualMenuButton contextual menu items\r\n     *\r\n     * The object contains a list that maps component types to arrays of IContextualMenuButton contextual menu items. The mapping is a key-value pair.\r\n     * The key is the name of the component type, for example, Simple Responsive Banner Component, and the value is an array of IContextualMenuButton contextual menu items, like add, edit, localize, etc.\r\n     */\r\n    /* @ngInject */ ContextualMenuService.prototype.addItems = function (contextualMenuItemsMap) {\r\n        var _this = this;\r\n        try {\r\n            if (contextualMenuItemsMap !== undefined) {\r\n                this._featuresList = this._getFeaturesList(this._contextualMenus);\r\n                var componentTypes = Object.keys(contextualMenuItemsMap);\r\n                componentTypes.forEach(function (type) {\r\n                    return _this._initContextualMenuItems(contextualMenuItemsMap, type);\r\n                });\r\n            }\r\n        }\r\n        catch (e) {\r\n            throw new Error('addItems() - Cannot add items. ' + e);\r\n        }\r\n    };\r\n    /**\r\n     * This method removes the menu items identified by the provided key.\r\n     *\r\n     * @param itemKey The key that identifies the menu items to remove.\r\n     */\r\n    /* @ngInject */ ContextualMenuService.prototype.removeItemByKey = function (itemKey) {\r\n        var _this = this;\r\n        Object.keys(this._contextualMenus).forEach(function (contextualMenuKey) {\r\n            var contextualMenuItems = _this._contextualMenus[contextualMenuKey];\r\n            _this._contextualMenus[contextualMenuKey] = contextualMenuItems.filter(function (item) { return item.key !== itemKey; });\r\n            if (_this._contextualMenus[contextualMenuKey].length === 0) {\r\n                // Remove if the contextual menu is empty.\r\n                delete _this._contextualMenus[contextualMenuKey];\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Verifies whether the itemKey has already been added to contextual menu list.\r\n     *\r\n     * @param itemKey The item key to verify.\r\n     *\r\n     * @returns Return true if itemKey exists in the contextual menu list, false otherwise.\r\n     */\r\n    /* @ngInject */ ContextualMenuService.prototype.containsItem = function (itemKey) {\r\n        var _this = this;\r\n        var contextualMenuExists = Object.keys(this._contextualMenus).map(function (contextualMenuKey) {\r\n            var contextualMenuItems = _this._contextualMenus[contextualMenuKey];\r\n            return (contextualMenuItems.findIndex(function (item) { return item.key === itemKey; }) > -1);\r\n        });\r\n        return contextualMenuExists.findIndex(function (menuExists) { return menuExists === true; }) > -1;\r\n    };\r\n    /**\r\n     * Will return an array of contextual menu items for a specific component type.\r\n     * For each key in the contextual menus' object, the method converts each component type into a valid regex using the regExpFactory of the function module and then compares it with the input componentType and, if matched, will add it to an array and returns the array.\r\n     *\r\n     * @param componentType The type code of the selected component\r\n     *\r\n     * @returns An array of contextual menu items assigned to the type.\r\n     *\r\n     */\r\n    /* @ngInject */ ContextualMenuService.prototype.getContextualMenuByType = function (componentType) {\r\n        var _this = this;\r\n        var contextualMenuArray = [];\r\n        if (this._contextualMenus) {\r\n            Object.keys(this._contextualMenus).forEach(function (regexpKey) {\r\n                if (stringUtils.regExpFactory(regexpKey).test(componentType)) {\r\n                    contextualMenuArray = _this._getUniqueItemArray(contextualMenuArray, _this._contextualMenus[regexpKey]);\r\n                }\r\n            });\r\n        }\r\n        return contextualMenuArray;\r\n    };\r\n    /**\r\n     * Returns an object that contains a list of contextual menu items that are displayed in the menu and menu items that are added to the More â€¦ options.\r\n     *\r\n     * The returned object contains two arrays. The first array contains the menu items that are displayed in the menu. The display limit size (iLeftBtns) specifies\r\n     * the maximum number of items that can be displayed in the menu. The other array contains the menu items that are available under the More... options.\r\n     * This method decides which items to send to each array based on their priority. Items with the lowest priority are displayed in the menu. The remaining\r\n     * items are added to the More... menu. Items that do not have a priority are automatically assigned a default priority.\r\n     *\r\n     * @param configuration\r\n     * @returns A promise that resolves to an array of contextual menu items assigned to the component type.\r\n     *\r\n     * The returned object contains the following properties\r\n     * - leftMenuItems : An array of menu items that can be displayed on the component.\r\n     * - moreMenuItems : An array of menu items that are available under the more menu items action.\r\n     *\r\n     */\r\n    /* @ngInject */ ContextualMenuService.prototype.getContextualMenuItems = function (configuration) {\r\n        var _this = this;\r\n        var iLeftBtns = configuration.iLeftBtns;\r\n        delete configuration.iLeftBtns;\r\n        var menuItems = this.getContextualMenuByType(configuration.componentType);\r\n        var promises = menuItems.map(function (item) {\r\n            if (!item.condition) {\r\n                return Promise.resolve(item);\r\n            }\r\n            var isItemEnabled = item.condition(configuration);\r\n            return isItemEnabled instanceof Promise\r\n                ? isItemEnabled.then(function (_isItemEnabled) { return (_isItemEnabled ? item : null); })\r\n                : Promise.resolve(isItemEnabled ? item : null);\r\n        });\r\n        return Promise.all(promises).then(function (items) {\r\n            var leftMenuItems = [];\r\n            var moreMenuItems = [];\r\n            _this.priorityService\r\n                .sort(items.filter(function (menuItem) { return menuItem !== null; }))\r\n                .forEach(function (menuItem) {\r\n                var collection = leftMenuItems.length < iLeftBtns ? leftMenuItems : moreMenuItems;\r\n                collection.push(menuItem);\r\n            });\r\n            return {\r\n                leftMenuItems: leftMenuItems,\r\n                moreMenuItems: moreMenuItems\r\n            };\r\n        });\r\n    };\r\n    /**\r\n     * This method can be used to ask SmartEdit to retrieve again the list of items in the enabled contextual menus.\r\n     */\r\n    /* @ngInject */ ContextualMenuService.prototype.refreshMenuItems = function () {\r\n        this.systemEventService.publishAsync(REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT);\r\n    };\r\n    // Helper Methods\r\n    /* @ngInject */ ContextualMenuService.prototype._getFeaturesList = function (_contextualMenus) {\r\n        // Would be better to use a set for this, but it's not currently supported by all browsers.\r\n        var featuresList = Object.keys(_contextualMenus).reduce(function (acc, key) { return __spreadArrays(acc, _contextualMenus[key].map(function (entry) { return entry.key; })); }, []);\r\n        return featuresList.reduce(function (acc, current) {\r\n            return acc.indexOf(current) < 0 ? __spreadArrays(acc, [current]) : __spreadArrays(acc);\r\n        }, []);\r\n    };\r\n    /* @ngInject */ ContextualMenuService.prototype._validateItem = function (item) {\r\n        if (!item.action) {\r\n            throw new Error('Contextual menu item must provide an action: ' + JSON.stringify(item));\r\n        }\r\n        // FIXME: missing case for callbacks\r\n        if ((!!item.action.callback && !!item.action.template) ||\r\n            (!!item.action.callback && !!item.action.templateUrl) ||\r\n            (!!item.action.template && !!item.action.templateUrl)) {\r\n            throw new Error('Contextual menu item must have exactly ONE of action callback|callbacks|template|templateUrl');\r\n        }\r\n    };\r\n    /* @ngInject */ ContextualMenuService.prototype._getUniqueItemArray = function (array1, array2) {\r\n        var currItem;\r\n        array2.forEach(function (item) {\r\n            currItem = item;\r\n            if (array1.every(function (it) { return currItem.key !== it.key; })) {\r\n                array1.push(currItem);\r\n            }\r\n        });\r\n        return array1;\r\n    };\r\n    /* @ngInject */ ContextualMenuService.prototype._initContextualMenuItems = function (map, componentType) {\r\n        var _this = this;\r\n        var componentTypeContextualMenus = map[componentType].filter(function (item) {\r\n            _this._validateItem(item);\r\n            if (!item.key) {\r\n                throw new Error(\"Item doesn't have key.\");\r\n            }\r\n            if (_this._featuresList.indexOf(item.key) !== -1) {\r\n                throw new Error(\"Item with that key (\" + item.key + \") already exist.\");\r\n            }\r\n            return true;\r\n        });\r\n        this._contextualMenus[componentType] = objectUtils.uniqueArray(this._contextualMenus[componentType] || [], componentTypeContextualMenus);\r\n        this.onContextualMenuItemsAdded.next(componentType);\r\n    };\r\n    /* @ngInject */ ContextualMenuService = __decorate([\r\n        SeDowngradeService(IContextualMenuService),\r\n        Injectable(),\r\n        __metadata(\"design:paramtypes\", [PriorityService,\r\n            SystemEventService])\r\n    ], /* @ngInject */ ContextualMenuService);\r\n    return /* @ngInject */ ContextualMenuService;\r\n}());\r\nexport { /* @ngInject */ ContextualMenuService };\r\n//# sourceMappingURL=ContextualMenuService.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/rxjs@6.5.4/node_modules/rxjs/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit/src/services/ContextualMenu.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"ContextualMenuService.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/services/ContextualMenuService.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit/services/ContextualMenuService.d.ts","writeByteOrderMark":false,"text":"import { BehaviorSubject } from 'rxjs';\r\nimport { ContextualMenu } from 'smartedit/services/ContextualMenu';\r\nimport { IContextualMenuButton, IContextualMenuConfiguration, IContextualMenuService, PriorityService, SystemEventService, TypedMap } from 'smarteditcommons';\r\n/**\r\n * The ContextualMenuService is used to add contextual menu items for each component.\r\n *\r\n * To add items to the contextual menu, you must call the addItems method of the contextualMenuService and pass a map\r\n * of the component-type array of contextual menu items mapping. The component type names are the keys in the mapping.\r\n * The component name can be the full name of the component type, an ant-like wildcard (such as  *middle*Suffix), or a\r\n * valid regex that includes or excludes a set of component types.\r\n *\r\n */\r\nexport declare class ContextualMenuService implements IContextualMenuService {\r\n    private priorityService;\r\n    private systemEventService;\r\n    onContextualMenuItemsAdded: BehaviorSubject<string>;\r\n    private _contextualMenus;\r\n    private _featuresList;\r\n    constructor(priorityService: PriorityService, systemEventService: SystemEventService);\r\n    /**\r\n     * The method called to add contextual menu items to component types in the SmartEdit application.\r\n     * The contextual menu items are then retrieved by the contextual menu decorator to wire the set of menu items to the specified component.\r\n     *\r\n     * ### Example:\r\n     *\r\n     *\r\n     *      contextualMenuService.addItems({\r\n     *          '.*Component': [{\r\n     *              key: 'itemKey',\r\n     *              i18nKey: 'CONTEXTUAL_MENU',\r\n     *              condition: function(componentType, componentId) {\r\n     *                  return componentId === 'ComponentType';\r\n     *              },\r\n     *              callback: function(componentType, componentId) {\r\n     *                  alert('callback for ' + componentType + \"_\" + componentId);\r\n     *              },\r\n     *              displayClass: 'democlass',\r\n     *              iconIdle: '.../icons/icon.png',\r\n     *              iconNonIdle: '.../icons/icon.png',\r\n     *              }]\r\n     *          });\r\n     *\r\n     *\r\n     * @param  contextualMenuItemsMap A map of componentType regular expressions to list of IContextualMenuButton contextual menu items\r\n     *\r\n     * The object contains a list that maps component types to arrays of IContextualMenuButton contextual menu items. The mapping is a key-value pair.\r\n     * The key is the name of the component type, for example, Simple Responsive Banner Component, and the value is an array of IContextualMenuButton contextual menu items, like add, edit, localize, etc.\r\n     */\r\n    addItems(contextualMenuItemsMap: TypedMap<IContextualMenuButton[]>): void;\r\n    /**\r\n     * This method removes the menu items identified by the provided key.\r\n     *\r\n     * @param itemKey The key that identifies the menu items to remove.\r\n     */\r\n    removeItemByKey(itemKey: string): void;\r\n    /**\r\n     * Verifies whether the itemKey has already been added to contextual menu list.\r\n     *\r\n     * @param itemKey The item key to verify.\r\n     *\r\n     * @returns Return true if itemKey exists in the contextual menu list, false otherwise.\r\n     */\r\n    containsItem(itemKey: string): boolean;\r\n    /**\r\n     * Will return an array of contextual menu items for a specific component type.\r\n     * For each key in the contextual menus' object, the method converts each component type into a valid regex using the regExpFactory of the function module and then compares it with the input componentType and, if matched, will add it to an array and returns the array.\r\n     *\r\n     * @param componentType The type code of the selected component\r\n     *\r\n     * @returns An array of contextual menu items assigned to the type.\r\n     *\r\n     */\r\n    getContextualMenuByType(componentType: string): IContextualMenuButton[];\r\n    /**\r\n     * Returns an object that contains a list of contextual menu items that are displayed in the menu and menu items that are added to the More â€¦ options.\r\n     *\r\n     * The returned object contains two arrays. The first array contains the menu items that are displayed in the menu. The display limit size (iLeftBtns) specifies\r\n     * the maximum number of items that can be displayed in the menu. The other array contains the menu items that are available under the More... options.\r\n     * This method decides which items to send to each array based on their priority. Items with the lowest priority are displayed in the menu. The remaining\r\n     * items are added to the More... menu. Items that do not have a priority are automatically assigned a default priority.\r\n     *\r\n     * @param configuration\r\n     * @returns A promise that resolves to an array of contextual menu items assigned to the component type.\r\n     *\r\n     * The returned object contains the following properties\r\n     * - leftMenuItems : An array of menu items that can be displayed on the component.\r\n     * - moreMenuItems : An array of menu items that are available under the more menu items action.\r\n     *\r\n     */\r\n    getContextualMenuItems(configuration: IContextualMenuConfiguration): Promise<ContextualMenu>;\r\n    /**\r\n     * This method can be used to ask SmartEdit to retrieve again the list of items in the enabled contextual menus.\r\n     */\r\n    refreshMenuItems(): void;\r\n    private _getFeaturesList;\r\n    private _validateItem;\r\n    private _getUniqueItemArray;\r\n    private _initContextualMenuItems;\r\n}\r\n"}}
