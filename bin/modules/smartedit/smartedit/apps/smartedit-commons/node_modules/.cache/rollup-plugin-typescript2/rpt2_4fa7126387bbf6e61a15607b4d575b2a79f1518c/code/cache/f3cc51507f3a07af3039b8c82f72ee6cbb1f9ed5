{"code":"import { __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2021 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport * as lo from 'lodash';\r\nimport { SeComponent } from 'smarteditcommons/di';\r\nimport { TestModeService } from 'smarteditcommons/services/TestModeService';\r\nimport { DiscardablePromiseUtils, StringUtils } from 'smarteditcommons/utils';\r\n/**\r\n * **Deprecated, since 2005, use {@link InifniteScrollingComponent}.**\r\n *\r\n * A component that you can use to implement infinite scrolling for an expanding content (typically with a ng-repeat) nested in it.\r\n * It is meant to handle paginated requests from a backend when data is expected to be large.\r\n * Since the expanding content is a <b>transcluded</b> element, we must specify the context to which the items will be attached:\r\n * If context is myContext, each pagination will push its new items to myContext.items.\r\n *\r\n * ### Parameters\r\n * `pageSize` - The maximum size of each page requested from the backend.\r\n *\r\n * `mask` - A string value sent to the server upon fetching a page to further restrict the search, it is sent as query string \"mask\".\r\n * <br>The directive listens for change to mask and will reset the scroll and re-fetch data.\r\n * <br/>It it left to the implementers to decide what it filters on.\r\n *\r\n * `distance` - A number representing how close the bottom of the element must be to the bottom of the container before the expression specified by fetchPage function is triggered. Measured in multiples of the container height; for example, if the container is 1000 pixels tall and distance is set to 2, the infinite scroll expression will be evaluated when the bottom of the element is within 2000 pixels of the bottom of the container. Defaults to 0 (e.g. the expression will be evaluated when the bottom of the element crosses the bottom of the container).\r\n *\r\n * `context` - The container object to which the items of the fetched `Page` will be added\r\n *\r\n * `fetchPage` - Function to fetch the next page when the bottom of the element approaches the bottom of the container.\r\n * fetchPage will be invoked with 3 arguments : <b>mask, pageSize, currentPage</b>. The currentPage is determined by the scrolling and starts with 0. The function must return a page of type `Page`.\r\n *\r\n * `dropDownContainerClass` - An optional CSS class to be added to the container of the dropdown. It would typically be used to override the default height. <b>The resolved CSS must set a height (or max-height) and overflow-y:scroll.</b>\r\n *\r\n * `dropDownClass` - An optional CSS class to be added to the dropdown. <b>Neither height nor overflow should be set on the dropdown, it must be free to fill up the space and reach the container size. Failure to do so will cause the directive to call nextPage as many times as the number of available pages on the server.</b>\r\n */\r\nvar /* @ngInject */ YInfiniteScrollingComponent = /** @class */ (function () {\r\n    function /* @ngInject */ YInfiniteScrollingComponent($timeout, encode, lodash, discardablePromiseUtils, $element, stringUtils, throttle, testModeService) {\r\n        this.$timeout = $timeout;\r\n        this.encode = encode;\r\n        this.lodash = lodash;\r\n        this.discardablePromiseUtils = discardablePromiseUtils;\r\n        this.$element = $element;\r\n        /** @internal */\r\n        this.CONTAINER_CLASS = 'ySEInfiniteScrolling-container';\r\n        /** @internal */\r\n        this.initiated = false;\r\n        this.THROTTLE_MILLISECONDS = 250;\r\n        this.containerId = stringUtils.generateIdentifier();\r\n        // needs to be bound for usage by underlying infinite-scroll\r\n        this.nextPage = this.nextPage.bind(this);\r\n        if (!testModeService.isE2EMode()) {\r\n            this.$onChanges = throttle(this.$onChanges.bind(this), this.THROTTLE_MILLISECONDS);\r\n        }\r\n    }\r\n    /** @internal */\r\n    /* @ngInject */ YInfiniteScrollingComponent.prototype.$onChanges = function () {\r\n        this.context = this.context || this;\r\n        this.$postLink();\r\n    };\r\n    /** @internal */\r\n    /* @ngInject */ YInfiniteScrollingComponent.prototype.nextPage = function () {\r\n        var _this = this;\r\n        if (this.pagingDisabled) {\r\n            return;\r\n        }\r\n        this.pagingDisabled = true;\r\n        this.currentPage++;\r\n        this.mask = this.mask || '';\r\n        this.discardablePromiseUtils.apply(this.containerId, this.fetchPage(this.mask, this.pageSize, this.currentPage), function (page) {\r\n            page.results = page.results || [];\r\n            page.results.forEach(function (element) {\r\n                element.technicalUniqueId = _this.encode(element);\r\n            });\r\n            var uniqueResults = _this.lodash.differenceBy(page.results, _this.context.items, 'technicalUniqueId');\r\n            if (_this.lodash.size(uniqueResults) > 0) {\r\n                Array.prototype.push.apply(_this.context.items, uniqueResults);\r\n            }\r\n            /*\r\n             * pagingDisabled controls the disablement of the native infinite-scroll directive therefore its\r\n             * re-evaluation must happen on the next digest cycle, after the HTML real estate has been modified\r\n             * by the new data set. Doing it on the same digest cycle would cause the non throttled infinite-scroll directive\r\n             * to fetch more pages than required\r\n             */\r\n            _this.$timeout(function () {\r\n                _this.pagingDisabled =\r\n                    page.results.length === 0 ||\r\n                        (page.pagination &&\r\n                            _this.context.items.length === page.pagination.totalCount);\r\n            });\r\n        });\r\n    };\r\n    /** @internal */\r\n    /* @ngInject */ YInfiniteScrollingComponent.prototype.$postLink = function () {\r\n        var wasInitiated = this.initiated;\r\n        this.distance = this.distance || 0;\r\n        this.context.items = [];\r\n        this.currentPage = -1;\r\n        this.pagingDisabled = false;\r\n        if (!this.container && this.$element) {\r\n            this.container = this.$element.find('.' + this.CONTAINER_CLASS).get(0);\r\n            this.initiated = true;\r\n        }\r\n        else {\r\n            this.container.scrollTop = 0;\r\n        }\r\n        if (wasInitiated) {\r\n            // not needed the first time since data-infinite-scroll-immediate-check=\"true\"\r\n            this.nextPage();\r\n        }\r\n    };\r\n    /* @ngInject */ YInfiniteScrollingComponent = __decorate([\r\n        SeComponent({\r\n            templateUrl: 'LegacyInfiniteScrollingTemplate.html',\r\n            inputs: [\r\n                'pageSize',\r\n                'mask:?',\r\n                'fetchPage',\r\n                'distance:?',\r\n                'context:?',\r\n                'dropDownContainerClass: @?',\r\n                'dropDownClass: @?'\r\n            ]\r\n        }),\r\n        __metadata(\"design:paramtypes\", [Function, Function, Function, DiscardablePromiseUtils, Object, StringUtils, Function, TestModeService])\r\n    ], /* @ngInject */ YInfiniteScrollingComponent);\r\n    return /* @ngInject */ YInfiniteScrollingComponent;\r\n}());\r\nexport { /* @ngInject */ YInfiniteScrollingComponent };\r\n//# sourceMappingURL=LegacyInfiniteScrollingComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@types/lodash@4.14.159/node_modules/@types/lodash/ts3.1/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/di/index.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/dtos/index.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/services/TestModeService.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/utils/index.ts"],"map":"{\"version\":3,\"file\":\"LegacyInfiniteScrollingComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/components/infiniteScrolling/LegacyInfiniteScrollingComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/components/infiniteScrolling/LegacyInfiniteScrollingComponent.d.ts","writeByteOrderMark":false,"text":"/// <reference types=\"angular\" />\r\n/// <reference types=\"angular-mocks\" />\r\n/// <reference types=\"jquery\" />\r\n/// <reference types=\"eonasdan-bootstrap-datetimepicker\" />\r\nimport * as lo from 'lodash';\r\nimport { ISeComponent } from 'smarteditcommons/di';\r\nimport { Page } from 'smarteditcommons/dtos';\r\nimport { TestModeService } from 'smarteditcommons/services/TestModeService';\r\nimport { DiscardablePromiseUtils, StringUtils } from 'smarteditcommons/utils';\r\n/** @internal */\r\nexport interface ITechnicalUniqueIdAware {\r\n    technicalUniqueId: string;\r\n}\r\n/**\r\n * **Deprecated, since 2005, use {@link InifniteScrollingComponent}.**\r\n *\r\n * A component that you can use to implement infinite scrolling for an expanding content (typically with a ng-repeat) nested in it.\r\n * It is meant to handle paginated requests from a backend when data is expected to be large.\r\n * Since the expanding content is a <b>transcluded</b> element, we must specify the context to which the items will be attached:\r\n * If context is myContext, each pagination will push its new items to myContext.items.\r\n *\r\n * ### Parameters\r\n * `pageSize` - The maximum size of each page requested from the backend.\r\n *\r\n * `mask` - A string value sent to the server upon fetching a page to further restrict the search, it is sent as query string \"mask\".\r\n * <br>The directive listens for change to mask and will reset the scroll and re-fetch data.\r\n * <br/>It it left to the implementers to decide what it filters on.\r\n *\r\n * `distance` - A number representing how close the bottom of the element must be to the bottom of the container before the expression specified by fetchPage function is triggered. Measured in multiples of the container height; for example, if the container is 1000 pixels tall and distance is set to 2, the infinite scroll expression will be evaluated when the bottom of the element is within 2000 pixels of the bottom of the container. Defaults to 0 (e.g. the expression will be evaluated when the bottom of the element crosses the bottom of the container).\r\n *\r\n * `context` - The container object to which the items of the fetched `Page` will be added\r\n *\r\n * `fetchPage` - Function to fetch the next page when the bottom of the element approaches the bottom of the container.\r\n * fetchPage will be invoked with 3 arguments : <b>mask, pageSize, currentPage</b>. The currentPage is determined by the scrolling and starts with 0. The function must return a page of type `Page`.\r\n *\r\n * `dropDownContainerClass` - An optional CSS class to be added to the container of the dropdown. It would typically be used to override the default height. <b>The resolved CSS must set a height (or max-height) and overflow-y:scroll.</b>\r\n *\r\n * `dropDownClass` - An optional CSS class to be added to the dropdown. <b>Neither height nor overflow should be set on the dropdown, it must be free to fill up the space and reach the container size. Failure to do so will cause the directive to call nextPage as many times as the number of available pages on the server.</b>\r\n */\r\nexport declare class YInfiniteScrollingComponent<T extends ITechnicalUniqueIdAware> implements ISeComponent {\r\n    private $timeout;\r\n    private encode;\r\n    private lodash;\r\n    private discardablePromiseUtils;\r\n    private $element;\r\n    /** @internal */\r\n    CONTAINER_CLASS: string;\r\n    /** @internal */\r\n    items: T[];\r\n    /** @internal */\r\n    initiated: boolean;\r\n    /** @internal */\r\n    currentPage: number;\r\n    /** @internal */\r\n    pagingDisabled: boolean;\r\n    dropDownContainerClass: string;\r\n    dropDownClass: string;\r\n    pageSize: number;\r\n    mask: string;\r\n    fetchPage: (mask: string, pageSize: number, currentPage: number) => angular.IPromise<Page<T>>;\r\n    private distance;\r\n    private context;\r\n    private container;\r\n    private containerId;\r\n    private THROTTLE_MILLISECONDS;\r\n    constructor($timeout: angular.ITimeoutService, encode: (object: any) => string, lodash: lo.LoDashStatic, discardablePromiseUtils: DiscardablePromiseUtils, $element: JQuery<Element>, stringUtils: StringUtils, throttle: (func: (...args: any[]) => any, maxWait: number) => any, testModeService: TestModeService);\r\n    /** @internal */\r\n    $onChanges(): void;\r\n    /** @internal */\r\n    nextPage(): void;\r\n    /** @internal */\r\n    $postLink(): void;\r\n}\r\n"}}
