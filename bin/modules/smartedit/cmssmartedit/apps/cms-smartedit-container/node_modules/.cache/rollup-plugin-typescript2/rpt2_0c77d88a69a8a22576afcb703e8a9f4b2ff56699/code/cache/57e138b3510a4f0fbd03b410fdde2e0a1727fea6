{"code":"import { __awaiter, __decorate, __generator, __metadata, __param } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\r\nimport { IPageService } from 'cmscommons';\r\nimport { ManagePageService } from 'cmssmarteditcontainer/services/pages/ManagePageService';\r\nimport { CrossFrameEventService, EVENTS, EVENT_CONTENT_CATALOG_UPDATE, SeDowngradeComponent, SystemEventService, TOOLBAR_ITEM } from 'smarteditcommons';\r\nimport { PageFacade } from '../../../facades';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"DeletePageToolbarItemComponent\", {\r\n    selector: 'se-delete-page-toolbar-item',\r\n    template: \"<div class=\\\"toolbar-action\\\" *ngIf=\\\"isReady\\\" [attr.data-item-key]=\\\"toolbarItem.key\\\"><button type=\\\"button\\\" class=\\\"btn toolbar-action--button\\\" [disabled]=\\\"isDeletePageDisabled\\\" [ngClass]=\\\"{ 'toolbar-action__disabled' : isDeletePageDisabled }\\\" (click)=\\\"deletePage()\\\"><span class=\\\"icon-delete se-toolbar-menu-ddlb--button__icon\\\"></span><div class=\\\"toolbar-action-button__txt\\\" translate=\\\"se.cms.actionitem.page.trash\\\"></div></button><se-tooltip *ngIf=\\\"isDeletePageDisabled\\\" [appendTo]=\\\"'body'\\\" [isChevronVisible]=\\\"true\\\" [placement]=\\\"'bottom'\\\" [triggers]=\\\"['mouseenter', 'mouseleave']\\\" [additionalClasses]=\\\"['se-tooltip--stretched']\\\"><div se-tooltip-body><span [translate]=\\\"tooltipMessage\\\"></span></div></se-tooltip></div>\",\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nvar /* @ngInject */ DeletePageToolbarItemComponent = /** @class */ (function () {\r\n    function /* @ngInject */ DeletePageToolbarItemComponent(pageService, pageFacade, managePageService, systemEventService, crossFrameEventService, cdr, toolbarItem) {\r\n        this.pageService = pageService;\r\n        this.pageFacade = pageFacade;\r\n        this.managePageService = managePageService;\r\n        this.systemEventService = systemEventService;\r\n        this.crossFrameEventService = crossFrameEventService;\r\n        this.cdr = cdr;\r\n        this.toolbarItem = toolbarItem;\r\n    }\r\n    /* @ngInject */ DeletePageToolbarItemComponent.prototype.ngOnInit = function () {\r\n        var _this = this;\r\n        this.unRegPageChange = this.crossFrameEventService.subscribe(EVENTS.PAGE_CHANGE, function () {\r\n            return _this.updateToolbar();\r\n        });\r\n        return this.updateToolbar();\r\n    };\r\n    /* @ngInject */ DeletePageToolbarItemComponent.prototype.ngOnDestroy = function () {\r\n        this.unRegPageChange();\r\n    };\r\n    Object.defineProperty(/* @ngInject */ DeletePageToolbarItemComponent.prototype, \"isDeletePageDisabled\", {\r\n        get: function () {\r\n            return !this.isDeletePageEnabled;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /* @ngInject */ DeletePageToolbarItemComponent.prototype.deletePage = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var pageInfo;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.pageService.getCurrentPageInfo()];\r\n                    case 1:\r\n                        pageInfo = _a.sent();\r\n                        return [4 /*yield*/, this.managePageService.softDeletePage(pageInfo, this.uriContext)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        this.systemEventService.publishAsync(EVENT_CONTENT_CATALOG_UPDATE);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ DeletePageToolbarItemComponent.prototype.updateToolbar = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var uriContext, _a, _b, _c;\r\n            return __generator(this, function (_d) {\r\n                switch (_d.label) {\r\n                    case 0:\r\n                        this.markAsNotReady();\r\n                        this.cdr.detectChanges();\r\n                        return [4 /*yield*/, this.pageFacade.retrievePageUriContext()];\r\n                    case 1:\r\n                        uriContext = _d.sent();\r\n                        if (!uriContext) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        this.uriContext = uriContext;\r\n                        _a = this;\r\n                        return [4 /*yield*/, this.pageService.getCurrentPageInfo()];\r\n                    case 2:\r\n                        _a.pageInfo = _d.sent();\r\n                        _b = this;\r\n                        return [4 /*yield*/, this.managePageService.isPageTrashable(this.pageInfo, this.uriContext)];\r\n                    case 3:\r\n                        _b.isDeletePageEnabled = _d.sent();\r\n                        _c = this;\r\n                        return [4 /*yield*/, this.resolveTooltipMessage(this.isDeletePageEnabled, this.pageInfo, this.uriContext)];\r\n                    case 4:\r\n                        _c.tooltipMessage = _d.sent();\r\n                        this.markAsReady();\r\n                        this.cdr.detectChanges();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ DeletePageToolbarItemComponent.prototype.markAsNotReady = function () {\r\n        this.isReady = false;\r\n        this.isDeletePageEnabled = false;\r\n        this.tooltipMessage = null;\r\n    };\r\n    /* @ngInject */ DeletePageToolbarItemComponent.prototype.markAsReady = function () {\r\n        this.isReady = true;\r\n    };\r\n    /* @ngInject */ DeletePageToolbarItemComponent.prototype.resolveTooltipMessage = function (isDeleteEnabled, pageInfo, uriContext) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, (isDeleteEnabled\r\n                            ? null\r\n                            : this.managePageService.getDisabledTrashTooltipMessage(pageInfo, uriContext))];\r\n                    case 1: return [2 /*return*/, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /* @ngInject */ DeletePageToolbarItemComponent = __decorate([\r\n        SeDowngradeComponent(),\r\n        Component({\r\n            selector: 'se-delete-page-toolbar-item',\r\n            template: \"<div class=\\\"toolbar-action\\\" *ngIf=\\\"isReady\\\" [attr.data-item-key]=\\\"toolbarItem.key\\\"><button type=\\\"button\\\" class=\\\"btn toolbar-action--button\\\" [disabled]=\\\"isDeletePageDisabled\\\" [ngClass]=\\\"{ 'toolbar-action__disabled' : isDeletePageDisabled }\\\" (click)=\\\"deletePage()\\\"><span class=\\\"icon-delete se-toolbar-menu-ddlb--button__icon\\\"></span><div class=\\\"toolbar-action-button__txt\\\" translate=\\\"se.cms.actionitem.page.trash\\\"></div></button><se-tooltip *ngIf=\\\"isDeletePageDisabled\\\" [appendTo]=\\\"'body'\\\" [isChevronVisible]=\\\"true\\\" [placement]=\\\"'bottom'\\\" [triggers]=\\\"['mouseenter', 'mouseleave']\\\" [additionalClasses]=\\\"['se-tooltip--stretched']\\\"><div se-tooltip-body><span [translate]=\\\"tooltipMessage\\\"></span></div></se-tooltip></div>\",\r\n            changeDetection: ChangeDetectionStrategy.OnPush\r\n        }),\r\n        __param(6, Inject(TOOLBAR_ITEM)),\r\n        __metadata(\"design:paramtypes\", [IPageService,\r\n            PageFacade,\r\n            ManagePageService,\r\n            SystemEventService,\r\n            CrossFrameEventService,\r\n            ChangeDetectorRef, Object])\r\n    ], /* @ngInject */ DeletePageToolbarItemComponent);\r\n    return /* @ngInject */ DeletePageToolbarItemComponent;\r\n}());\r\nexport { /* @ngInject */ DeletePageToolbarItemComponent };\r\n//# sourceMappingURL=DeletePageToolbarItemComponent.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular/core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/pages/ManagePageService.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/facades/index.ts"],"map":"{\"version\":3,\"file\":\"DeletePageToolbarItemComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/components/pages/deletePageMenu/DeletePageToolbarItemComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/components/pages/deletePageMenu/DeletePageToolbarItemComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnDestroy, OnInit } from '@angular/core';\r\nimport { ICMSPage, IPageService } from 'cmscommons';\r\nimport { ManagePageService } from 'cmssmarteditcontainer/services/pages/ManagePageService';\r\nimport { CrossFrameEventService, IUriContext, Nullable, SystemEventService, ToolbarItemInternal } from 'smarteditcommons';\r\nimport { PageFacade } from '../../../facades';\r\nexport declare class DeletePageToolbarItemComponent implements OnInit, OnDestroy {\r\n    private pageService;\r\n    private pageFacade;\r\n    private managePageService;\r\n    private systemEventService;\r\n    private crossFrameEventService;\r\n    private cdr;\r\n    toolbarItem: ToolbarItemInternal;\r\n    isReady: boolean;\r\n    isDeletePageEnabled: boolean;\r\n    tooltipMessage: Nullable<string>;\r\n    uriContext: IUriContext;\r\n    pageInfo: ICMSPage;\r\n    private unRegPageChange;\r\n    constructor(pageService: IPageService, pageFacade: PageFacade, managePageService: ManagePageService, systemEventService: SystemEventService, crossFrameEventService: CrossFrameEventService, cdr: ChangeDetectorRef, toolbarItem: ToolbarItemInternal);\r\n    ngOnInit(): Promise<void>;\r\n    ngOnDestroy(): void;\r\n    get isDeletePageDisabled(): boolean;\r\n    deletePage(): Promise<void>;\r\n    private updateToolbar;\r\n    private markAsNotReady;\r\n    private markAsReady;\r\n    private resolveTooltipMessage;\r\n}\r\n"}}
