{"code":"import { __assign, __awaiter, __decorate, __generator, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2021 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\n/* eslint-disable max-classes-per-file */\r\nimport { CmsitemsRestService } from 'cmscommons';\r\nimport { ICatalogService, SeDowngradeService } from 'smarteditcommons';\r\nvar RestrictionManagementSelectModel = /** @class */ (function () {\r\n    function RestrictionManagementSelectModel(cmsitemsRestService, catalogService, fetchRestrictionTypes, getSupportedRestrictionTypes) {\r\n        this.cmsitemsRestService = cmsitemsRestService;\r\n        this.catalogService = catalogService;\r\n        this.fetchRestrictionTypes = fetchRestrictionTypes;\r\n        this.getSupportedRestrictionTypes = getSupportedRestrictionTypes;\r\n        this.selectedIds = {};\r\n        this.model = {\r\n            restrictionTypes: [],\r\n            selectedRestrictionType: null\r\n        };\r\n        this.restrictions = [];\r\n        this.supportedRestrictionTypes = [];\r\n    }\r\n    RestrictionManagementSelectModel.prototype.initialize = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var restrictionTypesResponse, _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0: return [4 /*yield*/, this.fetchRestrictionTypes()];\r\n                    case 1:\r\n                        restrictionTypesResponse = _b.sent();\r\n                        this.model.restrictionTypes = restrictionTypesResponse.map(function (type, index) { return (__assign(__assign({}, type), { id: index })); });\r\n                        if (!(typeof this.getSupportedRestrictionTypes === 'function')) return [3 /*break*/, 3];\r\n                        _a = this;\r\n                        return [4 /*yield*/, this.getSupportedRestrictionTypes()];\r\n                    case 2:\r\n                        _a.supportedRestrictionTypes = _b.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        this.supportedRestrictionTypes = this.model.restrictionTypes.map(function (type) { return type.code; });\r\n                        _b.label = 4;\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RestrictionManagementSelectModel.prototype.getRestrictionsPaged = function (mask, pageSize, currentPage) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var requestParams, restrictionsResponse, restrictionResult;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        requestParams = {\r\n                            pageSize: pageSize,\r\n                            currentPage: currentPage,\r\n                            typeCode: this.model.selectedRestrictionType.code,\r\n                            mask: mask,\r\n                            itemSearchParams: ''\r\n                        };\r\n                        if (currentPage === 0) {\r\n                            this.restrictions = [];\r\n                        }\r\n                        return [4 /*yield*/, this.cmsitemsRestService.get(requestParams)];\r\n                    case 1:\r\n                        restrictionsResponse = _a.sent();\r\n                        restrictionResult = restrictionsResponse.response.map(function (restriction) { return (__assign(__assign({}, restriction), { id: restriction.uid })); });\r\n                        this.restrictions = this.restrictions.concat(restrictionResult);\r\n                        return [2 /*return*/, {\r\n                                pagination: restrictionsResponse.pagination,\r\n                                results: restrictionResult\r\n                            }];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RestrictionManagementSelectModel.prototype.getRestrictionFromBackend = function () {\r\n        return Promise.resolve({});\r\n    };\r\n    RestrictionManagementSelectModel.prototype.getRestrictionTypes = function () {\r\n        return Promise.resolve(this.model.restrictionTypes);\r\n    };\r\n    RestrictionManagementSelectModel.prototype.restrictionSelected = function () {\r\n        var _this = this;\r\n        if (this.selectedIds.restriction) {\r\n            this.selectedRestriction = this.restrictions.find(function (restriction) { return restriction.id === _this.selectedIds.restriction; });\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    RestrictionManagementSelectModel.prototype.restrictionTypeSelected = function () {\r\n        var _this = this;\r\n        this.selectedIds.restriction = null;\r\n        this.model.selectedRestrictionType =\r\n            (this.model.restrictionTypes || []).find(function (restrictionType) { return restrictionType.id === _this.selectedIds.restrictionType; }) || null;\r\n        if (this.model.selectedRestrictionType) {\r\n            this.selectedRestriction = {\r\n                typeCode: this.model.selectedRestrictionType.code\r\n            };\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    RestrictionManagementSelectModel.prototype.createRestrictionSelected = function (name, uriContext) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var catalogVersionUuid;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.selectedRestriction = {\r\n                            itemtype: this.model.selectedRestrictionType.code,\r\n                            name: name\r\n                        };\r\n                        return [4 /*yield*/, this.catalogService.getCatalogVersionUUid(uriContext)];\r\n                    case 1:\r\n                        catalogVersionUuid = _a.sent();\r\n                        this.selectedRestriction.catalogVersion = catalogVersionUuid;\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RestrictionManagementSelectModel.prototype.getRestrictionTypeCode = function () {\r\n        var _a;\r\n        return (_a = this.model.selectedRestrictionType) === null || _a === void 0 ? void 0 : _a.code;\r\n    };\r\n    RestrictionManagementSelectModel.prototype.getRestriction = function () {\r\n        return this.selectedRestriction;\r\n    };\r\n    RestrictionManagementSelectModel.prototype.isTypeSupported = function () {\r\n        if (this.getRestrictionTypeCode()) {\r\n            return this.supportedRestrictionTypes.includes(this.model.selectedRestrictionType.code);\r\n        }\r\n        return false;\r\n    };\r\n    return RestrictionManagementSelectModel;\r\n}());\r\nexport { RestrictionManagementSelectModel };\r\nvar /* @ngInject */ RestrictionManagementSelectModelFactory = /** @class */ (function () {\r\n    function /* @ngInject */ RestrictionManagementSelectModelFactory(cmsitemsRestService, catalogService) {\r\n        this.cmsitemsRestService = cmsitemsRestService;\r\n        this.catalogService = catalogService;\r\n    }\r\n    /* @ngInject */ RestrictionManagementSelectModelFactory.prototype.createRestrictionManagementSelectModel = function (fetchRestrictionTypes, getSupportedRestrictionTypes) {\r\n        var instance = new RestrictionManagementSelectModel(this.cmsitemsRestService, this.catalogService, fetchRestrictionTypes, getSupportedRestrictionTypes);\r\n        instance.initialize();\r\n        return instance;\r\n    };\r\n    /* @ngInject */ RestrictionManagementSelectModelFactory = __decorate([\r\n        SeDowngradeService(),\r\n        __metadata(\"design:paramtypes\", [CmsitemsRestService,\r\n            ICatalogService])\r\n    ], /* @ngInject */ RestrictionManagementSelectModelFactory);\r\n    return /* @ngInject */ RestrictionManagementSelectModelFactory;\r\n}());\r\nexport { /* @ngInject */ RestrictionManagementSelectModelFactory };\r\n//# sourceMappingURL=RestrictionManagementSelectModelFactory.js.map","references":["/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/dao/RestrictionTypesRestService.ts"],"map":"{\"version\":3,\"file\":\"RestrictionManagementSelectModelFactory.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/components/restrictions/services/RestrictionManagementSelectModelFactory.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/sandeepkalpane/Data/hybris2105/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/components/restrictions/services/RestrictionManagementSelectModelFactory.d.ts","writeByteOrderMark":false,"text":"import { CMSItem, CmsitemsRestService } from 'cmscommons';\r\nimport { ICatalogService, IUriContext, Page } from 'smarteditcommons';\r\nimport { IRestrictionType } from '../../../dao/RestrictionTypesRestService';\r\ninterface SelectedIdsModel {\r\n    restriction?: string;\r\n    restrictionType?: number;\r\n}\r\nexport declare class RestrictionManagementSelectModel {\r\n    private cmsitemsRestService;\r\n    private catalogService;\r\n    private fetchRestrictionTypes;\r\n    private getSupportedRestrictionTypes;\r\n    selectedIds: SelectedIdsModel;\r\n    private model;\r\n    private restrictions;\r\n    private selectedRestriction;\r\n    private supportedRestrictionTypes;\r\n    constructor(cmsitemsRestService: CmsitemsRestService, catalogService: ICatalogService, fetchRestrictionTypes: () => Promise<IRestrictionType[]>, getSupportedRestrictionTypes: () => Promise<string[]>);\r\n    initialize(): Promise<void>;\r\n    getRestrictionsPaged(mask: string, pageSize: number, currentPage: number): Promise<Page<CMSItem>>;\r\n    getRestrictionFromBackend(): Promise<CMSItem>;\r\n    getRestrictionTypes(): Promise<IRestrictionType[]>;\r\n    restrictionSelected(): boolean;\r\n    restrictionTypeSelected(): boolean;\r\n    createRestrictionSelected(name: string, uriContext: IUriContext): Promise<void>;\r\n    getRestrictionTypeCode(): string;\r\n    getRestriction(): Partial<CMSItem>;\r\n    isTypeSupported(): boolean;\r\n}\r\nexport declare class RestrictionManagementSelectModelFactory {\r\n    private cmsitemsRestService;\r\n    private catalogService;\r\n    constructor(cmsitemsRestService: CmsitemsRestService, catalogService: ICatalogService);\r\n    createRestrictionManagementSelectModel(fetchRestrictionTypes: () => Promise<IRestrictionType[]>, getSupportedRestrictionTypes: () => Promise<string[]>): RestrictionManagementSelectModel;\r\n}\r\nexport {};\r\n"}}
